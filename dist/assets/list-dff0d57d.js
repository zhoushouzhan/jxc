import{u as z,a as C,r as _,w as A,o as F,b as y,c as H,d as o,v as q,h as v,i as t,m as k,f as h,e as l,F as O,q as S,t as d,l as f,k as G,g as J,y as V,z as K,E as Q,A as W}from"./index-ddd32adc.js";const X=t("i",{class:"ri-2x ri-database-2-line text-gray-500 ml-2"},null,-1),Y=["innerHTML"],Z={class:"flex items-center justify-between"},tt=t("div",{class:"space-x-2"},null,-1),et={class:"flex space-x-2"},nt={class:"yp-table-datalist text-hui-300"},st={class:"bg-gray-100"},at={class:"px-2 py-2 w-10 font-thin"},ot=t("th",null,"ID",-1),lt=t("th",null,"会员",-1),ct=t("th",null,"单号",-1),dt=t("th",null,"商品数量",-1),it=t("th",null,"商品金额",-1),rt=t("th",null,"操作员",-1),ut=t("th",null,"录入时间",-1),pt=t("th",null,"操作",-1),mt={class:"px-2"},_t={class:"text-right"},ht=["onClick"],gt=["onClick"],bt=["onClick"],yt=["onClick"],kt={class:"px-2"},ft={colspan:"8"},xt={key:0,class:"mt-3"},Vt={__name:"list",props:{page:{default:0}},emits:["jumpCom"],setup(w,{emit:D}){const P=w,r=D,L=z().meta,$=C(null),j=C(!1),a=_({totalRecords:0,pageCount:0,currentPage:P.page}),B=e=>{a.currentPage=e,g()},m=_([]),c=_([]),u=_([]);A(u,(e,s)=>{c.length=0,e.length>0?m.forEach(i=>{c.push(i.id)}):c.length=0});const N=e=>{e.type==1&&r("jumpCom",{to:"in",id:e.id,page:a.currentPage}),e.type==2&&r("jumpCom",{to:"out",id:e.id,page:a.currentPage})},T=e=>{r("jumpCom",{to:"view",id:e.id,page:a.currentPage})},E=e=>{r("jumpCom",{to:"checkorder",id:e,page:a.currentPage})},g=async()=>{let e=await J("kucundan/sellorder",{page:a.currentPage,type:2,enabled:$.value});if(e.code==1){a.currentPage=e.data.current_page,a.pageCount=e.data.last_page,a.totalRecords=e.data.total,m.length=0;for(let s in e.data.data)m[s]=e.data.data[s]}j.value=!0},x=e=>{if(e==0&&(e=c.length?c:0),!e){V({type:"alter-error",text:"请选择项目"});return}K({text:"确认删除吗？"}).then(async()=>{const s=await Q("kucundan/delete",{ids:e});s.code&&(V({type:"alter-success",text:s.msg}),g())}).catch(s=>{})},I=e=>{const s=L.mod.name;return W(s).indexOf(e)>=0};return F(()=>{g()}),(e,s)=>{const i=y("ypcheckbox"),M=y("yppage"),R=y("yplayout"),b=H("tooltip");return o(),q(R,null,{header:v(n=>[X,t("div",{class:"text-xl px-3",innerHTML:n.meta.title},null,8,Y)]),list:v(()=>[t("div",Z,[tt,t("div",et,[t("div",null,[t("button",{class:"btn btn-hong",onClick:s[0]||(s[0]=n=>r("jumpCom",{to:"out"}))},"增加")])])]),t("table",nt,[t("thead",st,[t("tr",null,[t("th",at,[k(h(i,{value:"all",modelValue:u,"onUpdate:modelValue":s[1]||(s[1]=n=>u=n)},null,8,["modelValue"]),[[b,"全选",void 0,{top:!0}]])]),ot,lt,ct,dt,it,rt,ut,pt])]),t("tbody",null,[(o(!0),l(O,null,S(m,(n,U)=>(o(),l("tr",{class:"hover:bg-gray-100 py-1",key:U},[t("td",mt,[h(i,{value:n.id,modelValue:c,"onUpdate:modelValue":s[2]||(s[2]=p=>c=p)},null,8,["value","modelValue"])]),t("td",null,d(n.id),1),t("td",null,d(n.member.truename||"无"),1),t("td",null,d(n.sn),1),t("td",null,d(n.goodsCount),1),t("td",null," ￥"+d(n.sumprice),1),t("td",null,d(n.admin.truename||n.admin.username),1),t("td",null,d(n.create_time),1),t("td",_t,[n.enabled==0?(o(),l("button",{key:0,class:"btn btn-lan mr-2",onClick:p=>N(n)},"编辑",8,ht)):(o(),l("button",{key:1,class:"btn mr-2",onClick:p=>T(n)},"查看",8,gt)),I("enabled")&&n.enabled==0?(o(),l("button",{key:2,class:"btn btn-zi mr-2",onClick:p=>E(n.id)},"核验",8,bt)):f("",!0),n.enabled==0?(o(),l("button",{key:3,class:"btn btn-hong",onClick:p=>x(n.id)},"删除",8,yt)):f("",!0)])]))),128))]),t("tfoot",null,[t("tr",null,[t("td",kt,[k(h(i,{value:"all",modelValue:u,"onUpdate:modelValue":s[3]||(s[3]=n=>u=n)},null,8,["modelValue"]),[[b,"全选",void 0,{right:!0}]])]),t("td",ft,[k((o(),l("button",{class:"btn btn-hong",onClick:s[4]||(s[4]=n=>x(0))},[G("批量删除")])),[[b,"批量删除",void 0,{bottom:!0}]])])])])]),a.pageCount>1?(o(),l("div",xt,[h(M,{onTopage:B,pageData:a},null,8,["pageData"])])):f("",!0)]),_:1})}}};export{Vt as default};
