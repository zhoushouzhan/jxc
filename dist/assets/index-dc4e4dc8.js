import{u as B,s as N,a as g,r as C,p as L,E as k,y as A,o as O,b as I,d as o,e as d,f as v,h as c,i as s,n as S,j as f,k as z,l as y,F as _,q as F,v as x,T as G,G as P,H as R,m as j,I as q,x as J,g as K,A as Q}from"./index-ddd32adc.js";import U from"./categoryitem-61f4bf3a.js";import W from"./children-28301b14.js";import X from"./form-a68fd200.js";const Y=["innerHTML"],Z=s("div",{class:"flex-1"},null,-1),ee={class:"hidden md:block"},te=s("i",{class:"ri-add-line ri-lg pr-1"},null,-1),se={class:"border-t border-l border-r"},ne=s("div",{class:"flex items-center font-bold space-x-3 border-b bg-gray-50"},[s("div",{class:"p-2 w-52"},"栏目名称"),s("div",{class:"p-2 w-36"},"栏目ID"),s("div",{class:"flex-1"}),s("div",{class:"p-2 w-36 text-center"},"操作")],-1),oe={class:"menubox"},me={__name:"index",setup(ae){const i=B().meta,M=i.mod,T=N(X),a=g(!1),u=g(""),m=g(0),p=C([]),r=async()=>{p.length=0;const e=await K("/category/getList");e.code==1&&e.data.map(t=>{p.push(t)})},D=()=>{m.value=0,u.value="增加栏目",a.value=!0},l=C([]),E=e=>{e.children&&e.children.length>0&&b(e.id)},b=e=>{let t=l.indexOf(e);t>=0?l.splice(t,1):l.push(e)},h=e=>{const t=i.mod.name;return Q(t).indexOf(e)>=0};L("menuType",{changeMenu:e=>{b(e)}}),L("category",{editbtn:h("edit"),deletebtn:h("delete"),editItem:e=>{m.value=e,u.value="编辑栏目",a.value=!0},removeItem:async e=>{const t=await k("category/delete",{ids:e});t.code==1&&(A({type:"alter-success",text:t.msg}),r())},update:async e=>{await k("category/save",e)},saveEvent:()=>{r()}});const H={onEnter(e){e.style.height="auto";const t=window.getComputedStyle(e).height;e.style.height="0px",e.offsetHeight,e.style.height=t},onAfterEnter(e){e.style.height=null},onLeave(e){e.style.height=window.getComputedStyle(e).height,e.offsetHeight,e.style.height="0px"},onAfterLeave(e){e.style.height=null}};return O(()=>{r()}),(e,t)=>{const w=I("yplayout"),$=I("ypdialog");return o(),d(_,null,[v(w,null,{header:c(()=>[s("i",{class:S(["ri-2x text-gray-500 ml-2",f(i).icon||"ri-information-line"])},null,2),s("div",{class:"text-xl px-3",innerHTML:f(i).title},null,8,Y),Z,s("div",ee,[h("add")?(o(),d("button",{key:0,class:"yp-button yp-button-orange rounded",type:"button",onClick:D},[te,z(" 增加 ")])):y("",!0)])]),list:c(()=>[s("div",se,[ne,(o(!0),d(_,null,F(p,(n,V)=>(o(),d(_,{key:V},[v(U,{item:n,onChangeMenu:ie=>E(n)},null,8,["item","onChangeMenu"]),n.children&&n.children.length>0?(o(),x(G,P(R({key:0},H)),{default:c(()=>[j(s("div",oe,[v(W,{listItem:n.children,openList:l,deep:1},null,8,["listItem","openList"])],512),[[q,l.indexOf(n.id)>=0]])]),_:2},1040)):y("",!0)],64))),128))])]),_:1}),a.value?(o(),x($,{key:0,width:"1200",title:u.value,mask:1,onClose:t[1]||(t[1]=n=>a.value=!1)},{default:c(()=>[(o(),x(J(T.value),{id:m.value,mod:f(M),onClose:t[0]||(t[0]=n=>a.value=!1),onGetList:r},null,40,["id","mod"]))]),_:1},8,["title"])):y("",!0)],64)}}};export{me as default};
