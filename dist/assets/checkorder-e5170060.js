import{a as V,r as g,o as z,b as C,d as l,v as E,h as U,i as t,e as a,F as b,q as x,n as L,t as s,f as p,k as q,l as j,g as w,z as I,E as M,y as S}from"./index-0f467f6d.js";const T=t("i",{class:"ri-2x text-gray-500 ml-2 ri-checkbox-multiple-fill"},null,-1),A=t("div",{class:"text-xl px-3"},"审批中心",-1),G=t("div",{class:"flex-1 flex flex-row-reverse space-x-reverse space-x-2"},null,-1),H={class:"flex space-x-1"},J={class:"overflow-y-auto h-[900px]"},K={class:"yp-table"},P=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"序号"),t("th",{class:"text-center"},"图片"),t("th",null,"名称"),t("th",{class:"w-24"},"成本"),t("th",{class:"w-28"},"售价"),t("th",{class:"w-20"},"数量"),t("th",null,"备注")])],-1),Q=["onClick"],R={class:"text-center"},W=["src","onClick"],X={class:"text-red-600 font-bold"},Y={class:"flex-1"},Z={class:"overflow-y-auto max-h-[440px]"},tt={class:"yp-table"},et=t("thead",null,[t("tr",null,[t("th",{class:"text-center w-20"},"序号"),t("th",null,"名称"),t("th",{class:"w-24"},"编码"),t("th",{class:"w-24"},"标签"),t("th",{class:"w-24"},"成本"),t("th",{class:"w-24"},"零售价"),t("th",{class:"w-28"},"日期")])],-1),st={key:0},ot={class:"hover:bg-gray-100"},lt={class:"text-center"},at={class:"whitespace-nowrap"},nt={class:"whitespace-nowrap"},ct={key:1},dt=t("tr",null,[t("td",{colspan:"3"},[t("div",{class:"text-center py-2 text-gray-400"},"暂无数据")])],-1),rt=[dt],it={class:"overflow-y-auto max-h-[440px]"},ut={class:"yp-table"},_t=t("thead",null,[t("tr",null,[t("th",{class:"text-center w-20"},"图片"),t("th",null,"名称"),t("th",{class:"w-24"},"编码"),t("th",{class:"w-24"},"标签"),t("th",{class:"w-24"},"成本"),t("th",{class:"w-24"},"零售价"),t("th",{class:"w-28"},"日期")])],-1),ht={key:0},pt={class:"hover:bg-gray-100"},yt=["src","onClick"],gt={class:"whitespace-nowrap"},bt={class:"whitespace-nowrap"},xt={key:1},wt=t("tr",null,[t("td",{colspan:"3"},[t("div",{class:"text-center py-2 text-gray-400"},"暂无数据")])],-1),mt=[wt],vt={class:"flex py-2 space-x-2 mt-3"},ft=t("i",{class:"ri-save-line ri-lg pr-1"},null,-1),Vt={__name:"checkorder",props:{id:{default:0}},emits:["jumpCom"],setup(F,{emit:B}){const m=F,v=B,f=V(!1),y=V(0),c=g({godown_id:0,type:1,bill:[]}),_=g([]),i=g([]),k=o=>{window.open(o)},D=()=>{v("jumpCom",{to:"list"})},N=async o=>{const d=await w("kucundan/read",{id:o});d.code==1&&(c.id=o,c.enabled=1,c.godown_id=d.data.godown_id,c.type=d.data.type,c.bill=d.data.bill)},O=async o=>{if(y.value==o.goods_id)return;y.value=o.goods_id;let d=o.goods_id;const r=await w("goodsitem/near",{goods_id:d});r.code==1&&(_.length=0,Object.keys(r.data).map(e=>{_[e]=r.data[e]}));const u=await w("goodsitem/label",{goods_id:d});u.code==1&&(i.length=0,Object.keys(u.data).map(e=>{i[e]=u.data[e]})),console.log(i)},$=async()=>{I({text:"确定入库吗？"}).then(async()=>{const o=await M("kucundan/save",c);o.code==1&&(S({type:"alter-success",text:o.msg}),v("jumpCom",{to:"list"}))}).catch(()=>{console.log("cancel")})};return z(async()=>{m.id&&await N(m.id),f.value=!0}),(o,d)=>{const r=C("ypinput"),u=C("yplayout");return f.value?(l(),E(u,{key:0},{header:U(()=>[T,A,G,t("button",{class:"yp-button yp-button-sm yp-button-orange rounded-sm",onClick:D},"返回")]),list:U(()=>[t("div",H,[t("div",J,[t("table",K,[P,t("tbody",null,[(l(!0),a(b,null,x(c.bill,(e,h)=>(l(),a("tr",{class:L(["hover:bg-gray-100",{"bg-gray-200":y.value==e.goods_id}]),onClick:n=>O(e)},[t("td",R,s(h+1),1),t("td",null,[t("img",{src:e.thumbFile,class:"w-20 h-20 object-cover",onClick:n=>k(e.thumbFile)},null,8,W)]),t("td",null,[t("div",null,s(e.title),1),t("div",X,s(e.code),1)]),t("td",null,[p(r,{modelValue:e.inprice,"onUpdate:modelValue":n=>e.inprice=n,placeholder:"请输入价格"},null,8,["modelValue","onUpdate:modelValue"])]),t("td",null,[p(r,{modelValue:e.storeprice,"onUpdate:modelValue":n=>e.storeprice=n,placeholder:"销售价格"},null,8,["modelValue","onUpdate:modelValue"])]),t("td",null,[p(r,{modelValue:e.numbers,"onUpdate:modelValue":n=>e.numbers=n,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),t("td",null,[p(r,{modelValue:e.intro,"onUpdate:modelValue":n=>e.intro=n,placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])])],10,Q))),256))])])]),t("div",Y,[t("div",Z,[t("table",tt,[et,_.length?(l(),a("tbody",st,[(l(!0),a(b,null,x(_,(e,h)=>(l(),a("tr",ot,[t("td",lt,s(h+1),1),t("td",at,s(e.title),1),t("td",null,s(e.code),1),t("td",null,s(e.goods.label),1),t("td",null,s(e.inprice),1),t("td",null,s(e.goods.storeprice),1),t("td",nt,s(e.create_time.substring(0,e.create_time.indexOf(" "))),1)]))),256))])):(l(),a("tbody",ct,rt))])]),t("div",it,[t("table",ut,[_t,i.length?(l(),a("tbody",ht,[(l(!0),a(b,null,x(i,(e,h)=>(l(),a("tr",pt,[t("td",null,[t("img",{src:e.goods.thumbFile,class:"max-h-10",onClick:n=>k(e.goods.thumbFile)},null,8,yt)]),t("td",gt,s(e.title),1),t("td",null,s(e.goods.code),1),t("td",null,s(e.goods.label),1),t("td",null,s(e.inprice),1),t("td",null,s(e.goods.storeprice),1),t("td",bt,s(e.create_time.substring(0,e.create_time.indexOf(" "))),1)]))),256))])):(l(),a("tbody",xt,mt))])])])]),t("div",vt,[c.bill.length?(l(),a("button",{key:0,class:"yp-button rounded",type:"button",onClick:$},[ft,q(" 提交 ")])):j("",!0)])]),_:1})):j("",!0)}}};export{Vt as default};
