import{a as b,r as m,w as K,g as u,o as Z,b as f,c as $,d as n,v as q,h as x,i as e,e as i,F as k,q as L,t as _,l as r,f as v,M as z,m as H,k as J,E as O,y as T}from"./index-ddd32adc.js";const A=e("i",{class:"ri-2x text-gray-500 ml-2 ri-indent-increase"},null,-1),G=e("div",{class:"text-xl px-3"},"入库单",-1),P=e("div",{class:"flex-1 flex flex-row-reverse space-x-reverse space-x-2"},null,-1),Q={class:"bg-white text-sm"},R={key:0},W=e("div",{class:"text-lg text-center"}," 选择入库仓库 ",-1),X={class:"flex items-center justify-center space-x-5 py-5"},Y=["onClick"],ee={key:1},te={key:2},se={class:"yp-table"},oe=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"序号"),e("th",{class:"w-40"},"图片"),e("th",null,"名称/条码"),e("th",null,"数量"),e("th",null,"备注"),e("th",{class:"text-center"},"操作")])],-1),ae={class:"text-center"},le={class:"w-40"},ne=["src"],ie={class:"text-red-600 font-bold"},de=["onClick"],ce=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 h-5 fill-gray-600 hover:fill-red-500"},[e("path",{fill:"none",d:"M0 0h24v24H0z"}),e("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"})],-1),re=[ce],ue={class:"flex justify-center py-2 space-x-2 mt-3"},_e=e("i",{class:"ri-save-line ri-lg pr-1"},null,-1),he={__name:"in",props:{id:{default:0},t:{default:0}},emits:["jumpCom"],setup(C,{emit:V}){const p=C,F=V,d=b(""),y=m([]),w=b(!1),o=m({godown_id:0,enabled:0,type:1,bill:[]}),j=m(JSON.parse(sessionStorage.getItem("ingodownList"))||[]),D=()=>{F("jumpCom",{to:"list"})};K(()=>o.godown_id,async t=>{await U(t)});const B=async()=>{if(d.value=="")return;const t=await u("goods/details",{code:d.value});if(t.code==1){let s={goods_id:t.data.id,title:t.data.title,godown_id:o.godown_id,category_id:t.data.category.id,thumbFile:t.data.thumbFile,storeprice:t.data.storeprice,intro:"",status:0,inprice:0,numbers:0,code:t.data.code};o.bill.unshift(s),d.value=""}},M=t=>{o.bill.splice(t,1)},N=async()=>{const t=await u("/godown/index");if(t.code==1)for(let s in t.data.data)y.push(t.data.data[s])},U=async t=>{if(p.id)return;const s=await u("goods/getall",{ids:j});if(s.code==1)for(let a=0;a<s.data.length;a++){let h={goods_id:s.data[a].id,title:s.data[a].title,godown_id:t,category_id:s.data[a].category.id,thumbFile:s.data[a].thumbFile,storeprice:s.data[a].storeprice,intro:"",status:0,inprice:0,numbers:1,code:s.data[a].code};o.bill.push(h)}},S=async()=>{const t=await O("kucundan/save",o);t.code==1&&(o.bill.splice(0),T({type:"alter-success",text:t.msg}),sessionStorage.removeItem("ingodownList"))},E=async t=>{const s=await u("kucundan/read",{id:t});s.code==1&&(o.id=t,o.godown_id=s.data.godown_id,o.type=s.data.type,o.bill=s.data.bill)};return Z(async()=>{p.id?await E(p.id):await N(),w.value=!0}),(t,s)=>{const a=f("ypinput"),h=f("yplayout"),I=$("viewer");return w.value?(n(),q(h,{key:0},{header:x(()=>[A,G,P,e("button",{class:"btn btn-chen",onClick:D},"返回")]),list:x(()=>[e("div",Q,[o.godown_id==0?(n(),i("div",R,[W,e("div",X,[(n(!0),i(k,null,L(y,(l,g)=>(n(),i("div",{class:"px-3 py-1.5 cursor-pointer bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:c=>o.godown_id=l.id},_(l.title),9,Y))),256))])])):r("",!0),o.godown_id?(n(),i("div",ee,[v(a,{modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=l=>d.value=l),disabled:"",placeholder:"录入条码",onKeyup:z(B,["enter"])},null,8,["modelValue"])])):r("",!0),o.bill.length?(n(),i("div",te,[e("table",se,[oe,e("tbody",null,[(n(!0),i(k,null,L(o.bill,(l,g)=>(n(),i("tr",null,[e("td",ae,_(g+1),1),e("td",le,[H(e("img",{src:l.thumbFile,class:"w-28 h-28 object-cover"},null,8,ne),[[I]])]),e("td",null,[e("div",null,_(l.title),1),e("div",ie,_(l.code),1)]),e("td",null,[v(a,{modelValue:l.numbers,"onUpdate:modelValue":c=>l.numbers=c,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[v(a,{modelValue:l.intro,"onUpdate:modelValue":c=>l.intro=c,placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[e("div",{class:"flex items-center justify-center",onClick:c=>M(g)},re,8,de)])]))),256))])])])):r("",!0),e("div",ue,[o.bill.length?(n(),i("button",{key:0,class:"yp-button rounded",type:"button",onClick:S},[_e,J(" 申请入库 ")])):r("",!0)])])]),_:1})):r("",!0)}}};export{he as default};
