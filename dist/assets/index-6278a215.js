import{a as E,r as u,w as N,g as T,o as z,b,d as l,e as i,v as f,h as x,i as t,n as S,F as y,q as w,k as Z,t as h,l as $,x as q,s as H,z as G,E as m,y as g}from"./index-ddd32adc.js";import R from"./add-4ec465ef.js";import U from"./edit-212f7adb.js";const j={class:"flex items-center"},A=["innerHTML"],J=t("div",{class:"text-gray-400"},"用于菜单，联动，等",-1),K=t("div",{class:"flex-1"},null,-1),O={class:"overflow-auto"},P={class:"flex items-center space-x-2 p-2"},Q=t("div",null,"路径：",-1),W={class:"flex"},X=["onClick"],Y=t("span",{class:"px-2 text-gray-300"},">",-1),tt=t("div",{class:"flex-1"},null,-1),et={class:"yp-table-datalist text-hui-300"},st=t("thead",{class:"bg-gray-100 font-thin"},[t("tr",null,[t("th",{class:"p-2"},"ID"),t("th",null,"名称"),t("th",null,"操作")])],-1),nt={class:"hover:bg-gray-100"},ot=["onClick"],lt={class:"flex space-x-2"},at=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 fill-[#FFD96F]"},[t("path",{d:"M4 5V19H20V7H11.5858L9.58579 5H4ZM12.4142 5H21C21.5523 5 22 5.44772 22 6V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V4C2 3.44772 2.44772 3 3 3H10.4142L12.4142 5Z"})],-1),it=["onClick"],ct={class:"flex space-x-2"},dt={class:"flex space-x-2"},rt=["onClick"],pt=["onClick"],_t=["onClick"],xt={__name:"index",setup(ut){const C=E(!1),o=u({open:!1,title:"未命名",mask:1,componentId:"",preitem:[]}),r=u({pid:0}),p=s=>{s.havesid&&s.id!=r.pid&&(L(s),r.pid=s.id)};N(()=>r.pid,s=>{c()});const a=u([]),L=s=>{console.log(s);let e=-1;for(let _ in a)a[_].id==s.id&&(e=parseInt(_));e<0?a.push(s):(console.log(a,e+1),a.splice(e+1))},v=u([]),c=async()=>{const s=await T("/classify/index",r);s.code&&(v.length=0,s.data.forEach(e=>{v.push(e)}))},k=s=>{o.title="增加分类",o.preitem=s,o.componentId=H(R),o.open=!0},V=s=>{o.title="编辑分类",o.preitem=s,o.componentId=H(U),o.open=!0},D=s=>{G({text:"确认删除吗？"}).then(async()=>{const e=await m("/classify/delete",{ids:s});e.code==1&&(g({type:"alter-success",text:e.msg}),c())})},I=async s=>{const e=await m("/classify/save",s);e.code==1&&(g({type:"alter-success",text:e.msg}),c())},B=async s=>{const e=await m("/classify/update",s);e.code==1&&(g({type:"alter-success",text:e.msg}),c())};return z(()=>{c(),C.value=!0}),(s,e)=>{const _=b("yplayout"),F=b("ypdialog");return l(),i(y,null,[C.value?(l(),f(_,{key:0},{header:x(n=>[t("div",j,[t("i",{class:S(["ri-2x text-gray-500 ml-2",n.meta.icon||"ri-information-line"])},null,2),t("div",{class:"text-xl px-3",innerHTML:n.meta.title},null,8,A),J]),K]),list:x(()=>[t("div",O,[t("div",P,[Q,t("div",W,[t("div",{class:"text-gray-500 hover:text-blue-500 hover:cursor-pointer",onClick:e[0]||(e[0]=n=>(p({id:0,havesid:1}),a.length=0))},"顶级"),(l(!0),i(y,null,w(a,(n,M)=>(l(),i("div",{class:"text-gray-500 hover:text-blue-500 hover:cursor-pointer",onClick:d=>p(n)},[Y,Z(h(n.title),1)],8,X))),256))]),tt,t("div",null,[t("button",{class:"btn btn-lan",type:"button",onClick:e[1]||(e[1]=n=>k())}," 增加 ")])]),t("table",et,[st,t("tbody",null,[(l(!0),i(y,null,w(v,(n,M)=>(l(),i("tr",nt,[t("td",null,h(n.id),1),n.havesid?(l(),i("td",{key:0,onClick:d=>p(n)},[t("div",lt,[at,t("div",null,h(n.title),1)])],8,ot)):(l(),i("td",{key:1,onClick:d=>p(n)},[t("div",ct,[t("div",null,h(n.title),1)])],8,it)),t("td",null,[t("div",dt,[t("button",{class:"btn btn-small",onClick:d=>V(n)},"编辑",8,rt),t("button",{class:"btn btn-chen btn-small",onClick:d=>k(n)},"增加子级",8,pt),t("button",{class:"btn btn-hong btn-small",onClick:d=>D(n.id)},"删除",8,_t)])])]))),256))])])])]),_:1})):$("",!0),o.open?(l(),f(F,{key:1,width:"1200",title:o.title,mask:1,onClose:e[3]||(e[3]=n=>o.open=!1)},{default:x(()=>[(l(),f(q(o.componentId),{preitem:o.preitem,onClose:e[2]||(e[2]=n=>o.open=!1),onGetList:c,onSave:I,onUpdate:B},null,40,["preitem"]))]),_:1},8,["title"])):$("",!0)],64)}}};export{xt as default};
