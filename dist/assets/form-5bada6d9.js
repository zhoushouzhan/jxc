import{a as L,r as f,w as U,M as r,o as j,g as C,b as m,d as i,e as d,i as e,f as n,l as v,F as B,q as E,k as h,E as O,y as F}from"./index-ffc5c309.js";const M={key:0,class:"bg-white select-none p-2 space-y-3 text-sm"},q={class:"flex items-center"},A=e("div",{class:"w-24 text-right pr-5"},"名称",-1),z={class:"flex-1"},G={class:"flex items-center"},H=e("div",{class:"w-24 text-right pr-5"},"表名",-1),I={class:"flex-1 flex items-center"},J={key:0,class:"flex items-center"},K=e("div",{class:"w-24 text-right pr-5"},"类型",-1),P={class:"flex-1"},Q={class:"flex items-center"},R=e("div",{class:"w-24 text-right pr-5"},"排序",-1),S={class:"flex-1"},W={class:"flex items-center"},X=e("div",{class:"w-24 text-right pr-5"},"分栏",-1),Y={class:"flex-1"},Z={key:1,class:"flex items-center"},$=e("div",{class:"w-24 text-right pr-5"},"功能",-1),ee={class:"flex-1 flex items-center flex-wrap space-x-4"},te={class:"grid grid-cols-8 gap-3"},se=e("i",{class:"ri-save-line ri-lg pr-1"},null,-1),oe=e("i",{class:"ri-format-clear ri-lg pr-1"},null,-1),ae={__name:"form",props:{modName:null},emits:["getDataList","close"],setup(V,{emit:b}){const y=L(!1),g=V,w=b,s=f({alias:"",name:"",icon:"",type:0,rule_id:"0",sort:"0",colgroup:"",actions:[]}),c=f([]),p=f([{value:0,title:"请选择"}]),k=async()=>{const a=await O("/mod/save",s);a.code&&(F({type:"alter-success",text:a.msg}),w("getDataList"),setTimeout(()=>{x()},1e3))},x=()=>{for(let a in s)s[a]=""};return U(()=>s.type,a=>{c.length=0,a&&Object.keys(r.getters.modType).map(t=>{if(t==a){let o=r.getters.modType[t].actions,u=r.getters.actions;o.length&&o.forEach(_=>{c.push(u[_])})}})}),j(async()=>{let a=r.getters.modType;if(Object.keys(a).map(t=>{p.push({value:t,title:a[t].name})}),g.modName){const t=await C("/mod/getmod",{name:g.modName});s.id=t.data.id,Object.keys(s).map(o=>{o=="colgroup"?s[o]=t.data[o].join(`
`):s[o]=t.data[o]})}y.value=!0}),(a,t)=>{const o=m("ypinput"),u=m("ypselect"),_=m("yptextarea"),N=m("ypcheckbox");return y.value?(i(),d("div",M,[e("div",q,[A,e("div",z,[n(o,{modelValue:s.alias,"onUpdate:modelValue":t[0]||(t[0]=l=>s.alias=l),placeholder:"如:用户"},null,8,["modelValue"])])]),e("div",G,[H,e("div",I,[e("div",null,[n(o,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=l=>s.name=l),placeholder:"如:user"},null,8,["modelValue"])])])]),p.length?(i(),d("div",J,[K,e("div",P,[n(u,{itemList:p,modelValue:s.type,"onUpdate:modelValue":t[2]||(t[2]=l=>s.type=l)},null,8,["itemList","modelValue"])])])):v("",!0),e("div",Q,[R,e("div",S,[n(o,{modelValue:s.sort,"onUpdate:modelValue":t[3]||(t[3]=l=>s.sort=l),placeholder:"如:系统管理"},null,8,["modelValue"])])]),e("div",W,[X,e("div",Y,[n(_,{placeholder:"一行一个",modelValue:s.colgroup,"onUpdate:modelValue":t[4]||(t[4]=l=>s.colgroup=l)},null,8,["modelValue"])])]),c.length?(i(),d("div",Z,[$,e("div",ee,[e("div",te,[(i(!0),d(B,null,E(c,(l,T)=>(i(),d("div",{key:T},[n(N,{value:l.name,title:l.title,modelValue:s.actions,"onUpdate:modelValue":t[5]||(t[5]=D=>s.actions=D)},null,8,["value","title","modelValue"])]))),128))])])])):v("",!0),e("div",{class:"flex justify-center py-3 space-x-2"},[e("button",{class:"yp-button yp-button-orange rounded",type:"button",onClick:k},[se,h(" 提交 ")]),e("button",{class:"yp-button yp-button-gray rounded",type:"button",onClick:x},[oe,h(" 重置 ")])])])):v("",!0)}}};export{ae as default};
