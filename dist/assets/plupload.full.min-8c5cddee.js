import{W as re,X as se}from"./index-169137c2.js";var oe={exports:{}},ie={exports:{}},ne;function ae(){return ne||(ne=1,function(K){(function($,J){var W=function(){var P={};return J.apply(P,arguments),P.moxie};K.exports?K.exports=W():$.moxie=W()})(re||window,function(){(function($,J){var W={};function P(m,c){for(var a,u=[],e=0;e<m.length;++e){if(a=W[m[e]]||Q(m[e]),!a)throw"module definition dependecy not found: "+m[e];u.push(a)}c.apply(null,u)}function z(m,c,a){if(typeof m!="string")throw"invalid module definition, module id must be defined and be a string";if(c===J)throw"invalid module definition, dependencies must be specified";if(a===J)throw"invalid module definition, definition function must be specified";P(c,function(){W[m]=a.apply(null,arguments)})}function Z(m){return!!W[m]}function Q(m){for(var c=$,a=m.split(/[.\/]/),u=0;u<a.length;++u){if(!c[a[u]])return;c=c[a[u]]}return c}function Y(m){for(var c=0;c<m.length;c++){for(var a=$,u=m[c],e=u.split(/[.\/]/),l=0;l<e.length-1;++l)a[e[l]]===J&&(a[e[l]]={}),a=a[e[l]];a[e[e.length-1]]=W[u]}}z("moxie/core/utils/Basic",[],function(){function m(v){var R;return v===R?"undefined":v===null?"null":v.nodeType?"node":{}.toString.call(v).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function c(){return r(!1,!1,arguments)}function a(){return r(!0,!1,arguments)}function u(){return r(!1,!0,arguments)}function e(){return r(!0,!0,arguments)}function l(v){switch(m(v)){case"array":return r(!1,!0,[[],v]);case"object":return r(!1,!0,[{},v]);default:return v}}function i(v){switch(m(v)){case"array":return Array.prototype.slice.call(v);case"object":return c({},v)}return v}function r(v,R,_){var A,S=_[0];return d(_,function(O,F){F>0&&d(O,function(I,T){var C=f(m(I),["array","object"])!==-1;if(I===A||v&&S[T]===A)return!0;C&&R&&(I=i(I)),m(S[T])===m(I)&&C?r(v,R,[S[T],I]):S[T]=I})}),S}function t(v,R){for(var _ in R)({}).hasOwnProperty.call(R,_)&&(v[_]=R[_]);function A(){this.constructor=v;{var S=function(O){var F=O.toString().match(/^function\s([^\(\s]+)/);return F?F[1]:!1};this.ctorName=S(v)}}return A.prototype=R.prototype,v.prototype=new A,v.parent=R.prototype,v}function d(v,R){var _,A,S,O;if(v){try{_=v.length}catch{_=O}if(_===O||typeof _!="number"){for(A in v)if(v.hasOwnProperty(A)&&R(v[A],A)===!1)return}else for(S=0;S<_;S++)if(R(v[S],S)===!1)return}}function h(v){var R;if(!v||m(v)!=="object")return!0;for(R in v)return!1;return!0}function n(v,R){var _=0,A=v.length;m(R)!=="function"&&(R=function(){}),(!v||!v.length)&&R();function S(O){m(v[O])==="function"&&v[O](function(F){++O<A&&!F?S(O):R(F)})}S(_)}function o(v,R){var _=0,A=v.length,S=new Array(A);d(v,function(O,F){O(function(I){if(I)return R(I);var T=[].slice.call(arguments);T.shift(),S[F]=T,_++,_===A&&(S.unshift(null),R.apply(this,S))})})}function f(v,R){if(R){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(R,v);for(var _=0,A=R.length;_<A;_++)if(R[_]===v)return _}return-1}function s(v,R){var _=[];m(v)!=="array"&&(v=[v]),m(R)!=="array"&&(R=[R]);for(var A in v)f(v[A],R)===-1&&_.push(v[A]);return _.length?_:!1}function p(v,R){var _=[];return d(v,function(A){f(A,R)!==-1&&_.push(A)}),_.length?_:null}function g(v){var R,_=[];for(R=0;R<v.length;R++)_[R]=v[R];return _}var w=function(){var v=0;return function(R){var _=new Date().getTime().toString(32),A;for(A=0;A<5;A++)_+=Math.floor(Math.random()*65535).toString(32);return(R||"o_")+_+(v++).toString(32)}}();function b(v){return v&&(String.prototype.trim?String.prototype.trim.call(v):v.toString().replace(/^\s*/,"").replace(/\s*$/,""))}function y(v){if(typeof v!="string")return v;var R={t:1099511627776,g:1073741824,m:1048576,k:1024},_;return v=/^([0-9\.]+)([tmgk]?)$/.exec(v.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),_=v[2],v=+v[1],R.hasOwnProperty(_)&&(v*=R[_]),Math.floor(v)}function x(v){var R=[].slice.call(arguments,1);return v.replace(/%([a-z])/g,function(_,A){var S=R.shift();switch(A){case"s":return S+"";case"d":return parseInt(S,10);case"f":return parseFloat(S);case"c":return"";default:return S}})}function E(v,R){var _=this;setTimeout(function(){v.call(_)},R||1)}return{guid:w,typeOf:m,extend:c,extendIf:a,extendImmutable:u,extendImmutableIf:e,clone:l,inherit:t,each:d,isEmptyObj:h,inSeries:n,inParallel:o,inArray:f,arrayDiff:s,arrayIntersect:p,toArray:g,trim:b,sprintf:x,parseSizeStr:y,delay:E}}),z("moxie/core/utils/Encode",[],function(){var m=function(e){return unescape(encodeURIComponent(e))},c=function(e){return decodeURIComponent(escape(e))},a=function(e,l){if(typeof window.atob=="function")return l?c(window.atob(e)):window.atob(e);var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,t,d,h,n,o,f,s,p=0,g=0,w="",b=[];if(!e)return e;e+="";do h=i.indexOf(e.charAt(p++)),n=i.indexOf(e.charAt(p++)),o=i.indexOf(e.charAt(p++)),f=i.indexOf(e.charAt(p++)),s=h<<18|n<<12|o<<6|f,r=s>>16&255,t=s>>8&255,d=s&255,o==64?b[g++]=String.fromCharCode(r):f==64?b[g++]=String.fromCharCode(r,t):b[g++]=String.fromCharCode(r,t,d);while(p<e.length);return w=b.join(""),l?c(w):w},u=function(e,l){if(l&&(e=m(e)),typeof window.btoa=="function")return window.btoa(e);var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,t,d,h,n,o,f,s,p=0,g=0,w="",b=[];if(!e)return e;do r=e.charCodeAt(p++),t=e.charCodeAt(p++),d=e.charCodeAt(p++),s=r<<16|t<<8|d,h=s>>18&63,n=s>>12&63,o=s>>6&63,f=s&63,b[g++]=i.charAt(h)+i.charAt(n)+i.charAt(o)+i.charAt(f);while(p<e.length);w=b.join("");var y=e.length%3;return(y?w.slice(0,y-3):w)+"===".slice(y||3)};return{utf8_encode:m,utf8_decode:c,atob:a,btoa:u}}),z("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(m){var c=function(i){var r="",t="?",d="function",h="undefined",n="object",o="name",f="version",s={has:function(y,x){return x.toLowerCase().indexOf(y.toLowerCase())!==-1},lowerize:function(y){return y.toLowerCase()}},p={rgx:function(){for(var y,x=0,E,v,R,_,A,S,O=arguments;x<O.length;x+=2){var F=O[x],I=O[x+1];if(typeof y===h){y={};for(R in I)_=I[R],typeof _===n?y[_[0]]=i:y[_]=i}for(E=v=0;E<F.length;E++)if(A=F[E].exec(this.getUA()),A){for(R=0;R<I.length;R++)S=A[++v],_=I[R],typeof _===n&&_.length>0?_.length==2?typeof _[1]==d?y[_[0]]=_[1].call(this,S):y[_[0]]=_[1]:_.length==3?typeof _[1]===d&&!(_[1].exec&&_[1].test)?y[_[0]]=S?_[1].call(this,S,_[2]):i:y[_[0]]=S?S.replace(_[1],_[2]):i:_.length==4&&(y[_[0]]=S?_[3].call(this,S.replace(_[1],_[2])):i):y[_]=S||i;break}if(A)break}return y},str:function(y,x){for(var E in x)if(typeof x[E]===n&&x[E].length>0){for(var v=0;v<x[E].length;v++)if(s.has(x[E][v],y))return E===t?i:E}else if(s.has(x[E],y))return E===t?i:E;return y}},g={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"}}}},w={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[o,f],[/\s(opr)\/([\w\.]+)/i],[[o,"Opera"],f],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[o,f],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[o,"IE"],f],[/(edge)\/((\d+)?[\w\.]+)/i],[o,f],[/(yabrowser)\/([\w\.]+)/i],[[o,"Yandex"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],f],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[o,f],[/(dolfin)\/([\w\.]+)/i],[[o,"Dolphin"],f],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[o,"Chrome"],f],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[f,[o,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[f,[o,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[f,[o,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[f,[o,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[f,o],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[o,[f,p.str,g.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[o,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[o,"Netscape"],f],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[o,f]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[o,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[o,f],[/rv\:([\w\.]+).*(gecko)/i],[f,o]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[o,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[o,[f,p.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[o,"Windows"],[f,p.str,g.os.windows.version]],[/\((bb)(10);/i],[[o,"BlackBerry"],f],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[o,f],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[o,"Symbian"],f],[/\((series40);/i],[o],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[o,"Firefox OS"],f],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[o,f],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[o,"Chromium OS"],f],[/(sunos)\s?([\w\.]+\d)*/i],[[o,"Solaris"],f],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[o,f],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[o,"iOS"],[f,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[o,"Mac OS"],[f,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[o,f]]},b=function(y){var x=y||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:r);this.getBrowser=function(){return p.rgx.apply(this,w.browser)},this.getEngine=function(){return p.rgx.apply(this,w.engine)},this.getOS=function(){return p.rgx.apply(this,w.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return x},this.setUA=function(E){return x=E,this},this.setUA(x)};return b}();function a(i,r,t){var d=0,h=0,n=0,o={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},f=function(p){return p=(""+p).replace(/[_\-+]/g,"."),p=p.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),p.length?p.split("."):[-8]},s=function(p){return p?isNaN(p)?o[p]||-7:parseInt(p,10):0};for(i=f(i),r=f(r),h=Math.max(i.length,r.length),d=0;d<h;d++)if(i[d]!=r[d]){if(i[d]=s(i[d]),r[d]=s(r[d]),i[d]<r[d]){n=-1;break}else if(i[d]>r[d]){n=1;break}}if(!t)return n;switch(t){case">":case"gt":return n>0;case">=":case"ge":return n>=0;case"<=":case"le":return n<=0;case"==":case"=":case"eq":return n===0;case"<>":case"!=":case"ne":return n!==0;case"":case"<":case"lt":return n<0;default:return null}}var u=function(){var i={access_global_ns:function(){return!!window.moxie},define_property:function(){return!1}(),create_canvas:function(){var r=document.createElement("canvas"),t=!!(r.getContext&&r.getContext("2d"));return i.create_canvas=t,t},return_response_type:function(r){try{if(m.inArray(r,["","text","document"])!==-1)return!0;if(window.XMLHttpRequest){var t=new XMLHttpRequest;if(t.open("get","/"),"responseType"in t)return t.responseType=r,t.responseType===r}}catch{}return!1},use_blob_uri:function(){var r=window.URL;return i.use_blob_uri=r&&"createObjectURL"in r&&"revokeObjectURL"in r&&(l.browser!=="IE"||l.verComp(l.version,"11.0.46",">=")),i.use_blob_uri},use_data_uri:function(){var r=new Image;return r.onload=function(){i.use_data_uri=r.width===1&&r.height===1},setTimeout(function(){r.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return i.use_data_uri&&(l.browser!=="IE"||l.version>=9)},use_data_uri_of:function(r){return i.use_data_uri&&r<33e3||i.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var r=document.createElement("input");return r.setAttribute("type","file"),i.use_fileinput=!r.disabled},use_webgl:function(){var r=document.createElement("canvas"),t=null,d;try{t=r.getContext("webgl")||r.getContext("experimental-webgl")}catch{}return t||(t=null),d=!!t,i.use_webgl=d,r=J,d}};return function(r){var t=[].slice.call(arguments);return t.shift(),m.typeOf(i[r])==="function"?i[r].apply(this,t):!!i[r]}}(),e=new c().getResult(),l={can:u,uaParser:c,browser:e.browser.name,version:e.browser.version,os:e.os.name,osVersion:e.os.version,verComp:a,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return l.OS=l.os,l.debug={runtime:!0,events:!1},l.log=function(){function i(d){r.appendChild(document.createTextNode(d+`
`))}if(window&&window.console&&window.console.log&&window.console.log.apply)window.console.log.apply(window.console,arguments);else if(document){var r=document.getElementById("moxie-console");r||(r=document.createElement("pre"),r.id="moxie-console",document.body.appendChild(r));var t=arguments[0];if(m.typeOf(t)==="string")t=m.sprintf.apply(this,arguments);else if(m.inArray(m.typeOf(t),["object","array"])!==-1){i(t);return}r.appendChild(document.createTextNode(t+`
`))}},l}),z("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(m){function c(a,u){var e;for(e in a)if(a[e]===u)return e;return null}return{RuntimeError:function(){var a={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};function u(e,l){this.code=e,this.name=c(a,e),this.message=this.name+(l||": RuntimeError "+this.code)}return m.extend(u,a),u.prototype=Error.prototype,u}(),OperationNotAllowedException:function(){function a(u){this.code=u,this.name="OperationNotAllowedException"}return m.extend(a,{NOT_ALLOWED_ERR:1}),a.prototype=Error.prototype,a}(),ImageError:function(){var a={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};function u(e){this.code=e,this.name=c(a,e),this.message=this.name+": ImageError "+this.code}return m.extend(u,a),u.prototype=Error.prototype,u}(),FileException:function(){var a={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};function u(e){this.code=e,this.name=c(a,e),this.message=this.name+": FileException "+this.code}return m.extend(u,a),u.prototype=Error.prototype,u}(),DOMException:function(){var a={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};function u(e){this.code=e,this.name=c(a,e),this.message=this.name+": DOMException "+this.code}return m.extend(u,a),u.prototype=Error.prototype,u}(),EventException:function(){function a(u){this.code=u,this.name="EventException"}return m.extend(a,{UNSPECIFIED_EVENT_TYPE_ERR:0}),a.prototype=Error.prototype,a}()}}),z("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(m){var c=function(t){return typeof t!="string"?t:document.getElementById(t)},a=function(t,d){if(!t.className)return!1;var h=new RegExp("(^|\\s+)"+d+"(\\s+|$)");return h.test(t.className)},u=function(t,d){a(t,d)||(t.className=t.className?t.className.replace(/\s+$/,"")+" "+d:d)},e=function(t,d){if(t.className){var h=new RegExp("(^|\\s+)"+d+"(\\s+|$)");t.className=t.className.replace(h,function(n,o,f){return o===" "&&f===" "?" ":""})}},l=function(t,d){if(t.currentStyle)return t.currentStyle[d];if(window.getComputedStyle)return window.getComputedStyle(t,null)[d]},i=function(t,d){var h=0,n=0,o,f=document,s,p;t=t,d=d||f.body;function g(w){var b,y,x=0,E=0;return w&&(y=w.getBoundingClientRect(),b=f.compatMode==="CSS1Compat"?f.documentElement:f.body,x=y.left+b.scrollLeft,E=y.top+b.scrollTop),{x,y:E}}if(t&&t.getBoundingClientRect&&m.browser==="IE"&&(!f.documentMode||f.documentMode<8))return s=g(t),p=g(d),{x:s.x-p.x,y:s.y-p.y};for(o=t;o&&o!=d&&o.nodeType;)h+=o.offsetLeft||0,n+=o.offsetTop||0,o=o.offsetParent;for(o=t.parentNode;o&&o!=d&&o.nodeType;)h-=o.scrollLeft||0,n-=o.scrollTop||0,o=o.parentNode;return{x:h,y:n}},r=function(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:c,hasClass:a,addClass:u,removeClass:e,getStyle:l,getPos:i,getSize:r}}),z("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(m,c,a){var u={};function e(){this.uid=a.guid()}return a.extend(e.prototype,{init:function(){this.uid||(this.uid=a.guid("uid_"))},addEventListener:function(l,i,r,t){var d=this,h;if(this.hasOwnProperty("uid")||(this.uid=a.guid("uid_")),l=a.trim(l),/\s/.test(l)){a.each(l.split(/\s+/),function(n){d.addEventListener(n,i,r,t)});return}l=l.toLowerCase(),r=parseInt(r,10)||0,h=u[this.uid]&&u[this.uid][l]||[],h.push({fn:i,priority:r,scope:t||this}),u[this.uid]||(u[this.uid]={}),u[this.uid][l]=h},hasEventListener:function(l){var i;return l?(l=l.toLowerCase(),i=u[this.uid]&&u[this.uid][l]):i=u[this.uid],i||!1},removeEventListener:function(l,i){var r=this,t,d;if(l=l.toLowerCase(),/\s/.test(l)){a.each(l.split(/\s+/),function(h){r.removeEventListener(h,i)});return}if(t=u[this.uid]&&u[this.uid][l],t){if(i){for(d=t.length-1;d>=0;d--)if(t[d].fn===i){t.splice(d,1);break}}else t=[];t.length||(delete u[this.uid][l],a.isEmptyObj(u[this.uid])&&delete u[this.uid])}},removeAllEventListeners:function(){u[this.uid]&&delete u[this.uid]},dispatchEvent:function(l){var i,r,t,d,h={},n=!0,o;if(a.typeOf(l)!=="string")if(d=l,a.typeOf(d.type)==="string")l=d.type,d.total!==o&&d.loaded!==o&&(h.total=d.total,h.loaded=d.loaded),h.async=d.async||!1;else throw new c.EventException(c.EventException.UNSPECIFIED_EVENT_TYPE_ERR);if(l.indexOf("::")!==-1?function(s){i=s[0],l=s[1]}(l.split("::")):i=this.uid,l=l.toLowerCase(),r=u[i]&&u[i][l],r){r.sort(function(s,p){return p.priority-s.priority}),t=[].slice.call(arguments),t.shift(),h.type=l,t.unshift(h),m.debug.events&&m.log("%cEvent '%s' fired on %s","color: #999;",h.type,(this.ctorName?this.ctorName+"::":"")+i);var f=[];a.each(r,function(s){t[0].target=s.scope,h.async?f.push(function(p){setTimeout(function(){p(s.fn.apply(s.scope,t)===!1)},1)}):f.push(function(p){p(s.fn.apply(s.scope,t)===!1)})}),f.length&&a.inSeries(f,function(s){n=!s})}return n},bindOnce:function(l,i,r,t){var d=this;d.bind.call(this,l,function h(){return d.unbind(l,h),i.apply(this,arguments)},r,t)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(l){var i=this;this.bind(l.join(" "),function(r){var t="on"+r.type.toLowerCase();a.typeOf(this[t])==="function"&&this[t].apply(this,arguments)}),a.each(l,function(r){r="on"+r.toLowerCase(r),a.typeOf(i[r])==="undefined"&&(i[r]=null)})}}),e.instance=new e,e}),z("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(m,c,a,u){var e={},l={};function i(r,t,d,h,n){var o=this,f,s=c.guid(t+"_"),p=n||"browser";r=r||{},l[s]=this,d=c.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},d),r.preferred_caps&&(p=i.getMode(h,r.preferred_caps,p)),m.debug.runtime&&m.log("	default mode: %s",p),f=function(){var g={};return{exec:function(w,b,y,x){if(f[b]&&(g[w]||(g[w]={context:this,instance:new f[b]}),g[w].instance[y]))return g[w].instance[y].apply(this,x)},removeInstance:function(w){delete g[w]},removeAllInstances:function(){var w=this;c.each(g,function(b,y){c.typeOf(b.instance.destroy)==="function"&&b.instance.destroy.call(b.context),w.removeInstance(y)})}}}(),c.extend(this,{initialized:!1,uid:s,type:t,mode:i.getMode(h,r.required_caps,p),shimid:s+"_container",clients:0,options:r,can:function(g,w){var b=arguments[2]||d;if(c.typeOf(g)==="string"&&c.typeOf(w)==="undefined"&&(g=i.parseCaps(g)),c.typeOf(g)==="object"){for(var y in g)if(!this.can(y,g[y],b))return!1;return!0}return c.typeOf(b[g])==="function"?b[g].call(this,w):w===b[g]},getShimContainer:function(){var g,w=a.get(this.shimid);return w||(g=a.get(this.options.container)||document.body,w=document.createElement("div"),w.id=this.shimid,w.className="moxie-shim moxie-shim-"+this.type,c.extend(w.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),g.appendChild(w),g=null),w},getShim:function(){return f},shimExec:function(g,w){var b=[].slice.call(arguments,2);return o.getShim().exec.call(this,this.uid,g,w,b)},exec:function(g,w){var b=[].slice.call(arguments,2);return o[g]&&o[g][w]?o[g][w].apply(this,b):o.shimExec.apply(this,arguments)},destroy:function(){if(o){var g=a.get(this.shimid);g&&g.parentNode.removeChild(g),f&&f.removeAllInstances(),this.unbindAll(),delete l[this.uid],this.uid=null,s=o=f=g=null}}}),this.mode&&r.required_caps&&!this.can(r.required_caps)&&(this.mode=!1)}return i.order="html5,flash,silverlight,html4",i.getRuntime=function(r){return l[r]?l[r]:!1},i.addConstructor=function(r,t){t.prototype=u.instance,e[r]=t},i.getConstructor=function(r){return e[r]||null},i.getInfo=function(r){var t=i.getRuntime(r);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},i.parseCaps=function(r){var t={};return c.typeOf(r)!=="string"?r||{}:(c.each(r.split(","),function(d){t[d]=!0}),t)},i.can=function(r,t){var d,h=i.getConstructor(r),n;return h?(d=new h({required_caps:t}),n=d.mode,d.destroy(),!!n):!1},i.thatCan=function(r,t){var d=(t||i.order).split(/\s*,\s*/);for(var h in d)if(i.can(d[h],r))return d[h];return null},i.getMode=function(r,t,d){var h=null;if(c.typeOf(d)==="undefined"&&(d="browser"),t&&!c.isEmptyObj(r)){if(c.each(t,function(n,o){if(r.hasOwnProperty(o)){var f=r[o](n);if(typeof f=="string"&&(f=[f]),!h)h=f;else if(!(h=c.arrayIntersect(h,f)))return m.debug.runtime&&m.log("		%s: %s (conflicting mode requested: %s)",o,n,f),h=!1}m.debug.runtime&&m.log("		%s: %s (compatible modes: %s)",o,n,h)}),h)return c.inArray(d,h)!==-1?d:h[0];if(h===!1)return!1}return d},i.getGlobalEventTarget=function(){if(/^moxie\./.test(m.global_event_dispatcher)&&!m.can("access_global_ns")){var r=c.guid("moxie_event_target_");window[r]=function(t,d){u.instance.dispatchEvent(t,d)},m.global_event_dispatcher=r}return m.global_event_dispatcher},i.capTrue=function(){return!0},i.capFalse=function(){return!1},i.capTest=function(r){return function(){return!!r}},i}),z("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(m,c,a,u){return function(){var l;a.extend(this,{connectRuntime:function(i){var r=this,t;function d(h){var n,o;if(!h.length){r.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)),l=null;return}if(n=h.shift().toLowerCase(),o=u.getConstructor(n),!o){m.debug.runtime&&m.log("Constructor for '%s' runtime is not available.",n),d(h);return}if(m.debug.runtime&&(m.log("Trying runtime: %s",n),m.log(i)),l=new o(i),l.bind("Init",function(){l.initialized=!0,m.debug.runtime&&m.log("Runtime '%s' initialized",l.type),setTimeout(function(){l.clients++,r.ruid=l.uid,r.trigger("RuntimeInit",l)},1)}),l.bind("Error",function(){m.debug.runtime&&m.log("Runtime '%s' failed to initialize",l.type),l.destroy(),d(h)}),l.bind("Exception",function(f,s){var p=s.name+"(#"+s.code+")"+(s.message?", from: "+s.message:"");m.debug.runtime&&m.log("Runtime '%s' has thrown an exception: %s",this.type,p),r.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.EXCEPTION_ERR,p))}),m.debug.runtime&&m.log("	selected mode: %s",l.mode),!l.mode){l.trigger("Error");return}l.init()}if(a.typeOf(i)==="string"?t=i:a.typeOf(i.ruid)==="string"&&(t=i.ruid),t){if(l=u.getRuntime(t),l)return r.ruid=t,l.clients++,l;throw new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)}d((i.runtime_order||u.order).split(/\s*,\s*/))},disconnectRuntime:function(){l&&--l.clients<=0&&l.destroy(),l=null},getRuntime:function(){return l&&l.uid?l:l=null},exec:function(){return l?l.exec.apply(this,arguments):null},can:function(i){return l?l.can(i):!1}})}}),z("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(m,c,a){var u={};function e(l,i){function r(t,d,h){var n,o=u[this.uid];return m.typeOf(o)!=="string"||!o.length?null:(n=new e(null,{type:h,size:d-t}),n.detach(o.substr(t,n.size)),n)}a.call(this),l&&this.connectRuntime(l),i?m.typeOf(i)==="string"&&(i={data:i}):i={},m.extend(this,{uid:i.uid||m.guid("uid_"),ruid:l,size:i.size||0,type:i.type||"",slice:function(t,d,h){return this.isDetached()?r.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,d,h)},getSource:function(){return u[this.uid]?u[this.uid]:null},detach:function(t){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),t=t||"",t.substr(0,5)=="data:"){var d=t.indexOf(";base64,");this.type=t.substring(5,d),t=c.atob(t.substring(d+8))}this.size=t.length,u[this.uid]=t},isDetached:function(){return!this.ruid&&m.typeOf(u[this.uid])==="string"},destroy:function(){this.detach(),delete u[this.uid]}}),i.data?this.detach(i.data):u[this.uid]=i}return e}),z("moxie/core/I18n",["moxie/core/utils/Basic"],function(m){var c={};return{addI18n:function(a){return m.extend(c,a)},translate:function(a){return c[a]||a},_:function(a){return this.translate(a)},sprintf:function(a){var u=[].slice.call(arguments,1);return a.replace(/%[a-z]/g,function(){var e=u.shift();return m.typeOf(e)!=="undefined"?e:""})}}}),z("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(m,c){var a="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",u={},e={},l=function(n){var o=n.split(/,/),f,s,p;for(f=0;f<o.length;f+=2){for(p=o[f+1].split(/ /),s=0;s<p.length;s++)u[p[s]]=o[f];e[o[f]]=p}},i=function(n,o){var f,s,p,g,w=[];for(s=0;s<n.length;s++)for(f=n[s].extensions.toLowerCase().split(/\s*,\s*/),p=0;p<f.length;p++){if(f[p]==="*")return[];if(g=w[f[p]],o&&/^\w+$/.test(f[p]))w.push("."+f[p]);else if(g&&m.inArray(g,w)===-1)w.push(g);else if(!g)return[]}return w},r=function(n){var o=[];return m.each(n,function(f){if(f=f.toLowerCase(),f==="*")return o=[],!1;var s=f.match(/^(\w+)\/(\*|\w+)$/);s&&(s[2]==="*"?m.each(e,function(p,g){new RegExp("^"+s[1]+"/").test(g)&&[].push.apply(o,e[g])}):e[f]&&[].push.apply(o,e[f]))}),o},t=function(n){var o=[],f=[];return m.typeOf(n)==="string"&&(n=m.trim(n).split(/\s*,\s*/)),f=r(n),o.push({title:c.translate("Files"),extensions:f.length?f.join(","):"*"}),o},d=function(n){var o=n&&n.match(/\.([^.]+)$/);return o?o[1].toLowerCase():""},h=function(n){return u[d(n)]||""};return l(a),{mimes:u,extensions:e,addMimeType:l,extList2mimes:i,mimes2exts:r,mimes2extList:t,getFileExtension:d,getFileMime:h}}),z("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(m,c,a,u,e,l,i,r,t){var d=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];function h(n){c.log("Instantiating FileInput...");var o,f,s;if(m.inArray(m.typeOf(n),["string","node"])!==-1&&(n={browse_button:n}),f=u.get(n.browse_button),!f)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);s={accept:[{title:i.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:f.parentNode||document.body},n=m.extend({},s,n),typeof n.required_caps=="string"&&(n.required_caps=r.parseCaps(n.required_caps)),typeof n.accept=="string"&&(n.accept=a.mimes2extList(n.accept)),o=u.get(n.container),o||(o=document.body),u.getStyle(o,"position")==="static"&&(o.style.position="relative"),o=f=null,t.call(this),m.extend(this,{uid:m.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){var p=this;p.bind("RuntimeInit",function(g,w){p.ruid=w.uid,p.shimid=w.shimid,p.bind("Ready",function(){p.trigger("Refresh")},999),p.bind("Refresh",function(){var b,y,x,E,v;x=u.get(n.browse_button),E=u.get(w.shimid),x&&(b=u.getPos(x,u.get(n.container)),y=u.getSize(x),v=parseInt(u.getStyle(x,"z-index"),10)||0,E&&m.extend(E.style,{top:b.y+"px",left:b.x+"px",width:y.w+"px",height:y.h+"px",zIndex:v+1})),E=x=null}),w.exec.call(p,"FileInput","init",n)}),p.connectRuntime(m.extend({},n,{required_caps:{select_file:!0}}))},getOption:function(p){return n[p]},setOption:function(p,g){if(n.hasOwnProperty(p)){var w=n[p];switch(p){case"accept":typeof g=="string"&&(g=a.mimes2extList(g));break;case"container":case"required_caps":throw new e.FileException(e.FileException.NO_MODIFICATION_ALLOWED_ERR)}n[p]=g,this.exec("FileInput","setOption",p,g),this.trigger("OptionChanged",p,g,w)}},disable:function(p){var g=this.getRuntime();g&&this.exec("FileInput","disable",m.typeOf(p)==="undefined"?!0:p)},refresh:function(){this.trigger("Refresh")},destroy:function(){var p=this.getRuntime();p&&(p.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),m.typeOf(this.files)==="array"&&m.each(this.files,function(g){g.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(d)}return h.prototype=l.instance,h}),z("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(m,c,a){function u(e,l){l||(l={}),a.apply(this,arguments),this.type||(this.type=c.getFileMime(l.name));var i;if(l.name)i=l.name.replace(/\\/g,"/"),i=i.substr(i.lastIndexOf("/")+1);else if(this.type){var r=this.type.split("/")[0];i=m.guid((r!==""?r:"file")+"_"),c.extensions[this.type]&&(i+="."+c.extensions[this.type][0])}m.extend(this,{name:i||m.guid("file_"),relativePath:"",lastModifiedDate:l.lastModifiedDate||new Date().toLocaleString()})}return u.prototype=a.prototype,u}),z("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(m,c,a,u,e,l,i,r,t){var d=["ready","dragenter","dragleave","drop","error"];function h(n){e.log("Instantiating FileDrop...");var o=this,f;typeof n=="string"&&(n={drop_zone:n}),f={accept:[{title:m.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n=typeof n=="object"?u.extend({},f,n):f,n.container=c.get(n.drop_zone)||document.body,c.getStyle(n.container,"position")==="static"&&(n.container.style.position="relative"),typeof n.accept=="string"&&(n.accept=t.mimes2extList(n.accept)),i.call(o),u.extend(o,{uid:u.guid("uid_"),ruid:null,files:null,init:function(){o.bind("RuntimeInit",function(s,p){o.ruid=p.uid,p.exec.call(o,"FileDrop","init",n),o.dispatchEvent("ready")}),o.connectRuntime(n)},destroy:function(){var s=this.getRuntime();s&&(s.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(d)}return h.prototype=r.instance,h}),z("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(m,c,a,u,e,l){var i=["loadstart","progress","load","abort","error","loadend"];function r(){l.call(this),m.extend(this,{uid:m.guid("uid_"),readyState:r.EMPTY,result:null,error:null,readAsBinaryString:function(d){t.call(this,"readAsBinaryString",d)},readAsDataURL:function(d){t.call(this,"readAsDataURL",d)},readAsText:function(d){t.call(this,"readAsText",d)},abort:function(){this.result=null,m.inArray(this.readyState,[r.EMPTY,r.DONE])===-1&&(this.readyState===r.LOADING&&(this.readyState=r.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(i),this.bind("Error",function(d,h){this.readyState=r.DONE,this.error=h},999),this.bind("Load",function(d){this.readyState=r.DONE},999);function t(d,h){if(this.trigger("loadstart"),this.readyState===r.LOADING){this.trigger("error",new a.DOMException(a.DOMException.INVALID_STATE_ERR)),this.trigger("loadend");return}if(!(h instanceof e)){this.trigger("error",new a.DOMException(a.DOMException.NOT_FOUND_ERR)),this.trigger("loadend");return}if(this.result=null,this.readyState=r.LOADING,h.isDetached()){var n=h.getSource();switch(d){case"readAsText":case"readAsBinaryString":this.result=n;break;case"readAsDataURL":this.result="data:"+h.type+";base64,"+c.btoa(n);break}this.readyState=r.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(h.ruid),this.exec("FileReader","read",d,h)}}return r.EMPTY=0,r.LOADING=1,r.DONE=2,r.prototype=u.instance,r}),z("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(m){var c=function(e,l){var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=i.length,t={http:80,https:443},d={},h=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,n=h.exec(e||""),o,f=/^\/\/\w/.test(e);switch(m.typeOf(l)){case"undefined":l=c(document.location.href,!1);break;case"string":l=c(l,!1);break}for(;r--;)n[r]&&(d[i[r]]=n[r]);if(o=!f&&!d.scheme,(f||o)&&(d.scheme=l.scheme),o){d.host=l.host,d.port=l.port;var s="";/^[^\/]/.test(d.path)&&(s=l.path,/\/[^\/]*\.[^\/]*$/.test(s)?s=s.replace(/\/[^\/]+$/,"/"):s=s.replace(/\/?$/,"/")),d.path=s+(d.path||"")}return d.port||(d.port=t[d.scheme]||80),d.port=parseInt(d.port,10),d.path||(d.path="/"),delete d.source,d},a=function(e){var l={http:80,https:443},i=typeof e=="object"?e:c(e);return i.scheme+"://"+i.host+(i.port!==l[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},u=function(e){function l(i){return[i.scheme,i.host,i.port].join("/")}return typeof e=="string"&&(e=c(e)),l(c())===l(e)};return{parseUrl:c,resolveUrl:a,hasSameOrigin:u}}),z("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(m,c,a){function u(){this.uid=m.guid("uid_"),c.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return u.prototype=a.instance,u}),z("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(m,c,a){return function(){c.call(this),m.extend(this,{uid:m.guid("uid_"),readAsBinaryString:function(e){return u.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return u.call(this,"readAsDataURL",e)},readAsText:function(e){return u.call(this,"readAsText",e)}});function u(e,l){if(l.isDetached()){var i=l.getSource();switch(e){case"readAsBinaryString":return i;case"readAsDataURL":return"data:"+l.type+";base64,"+a.btoa(i);case"readAsText":for(var r="",t=0,d=i.length;t<d;t++)r+=String.fromCharCode(i[t]);return r}}else{var h=this.connectRuntime(l.ruid).exec.call(this,"FileReaderSync","read",e,l);return this.disconnectRuntime(),h}}}}),z("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(m,c,a){function u(){var e,l=[];c.extend(this,{append:function(i,r){var t=this,d=c.typeOf(r);r instanceof a?e={name:i,value:r}:d==="array"?(i+="[]",c.each(r,function(h){t.append(i,h)})):d==="object"?c.each(r,function(h,n){t.append(i+"["+n+"]",h)}):d==="null"||d==="undefined"||d==="number"&&isNaN(r)?t.append(i,"false"):l.push({name:i,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(i){c.each(l,function(r){i(r.value,r.name)}),e&&i(e.value,e.name)},destroy:function(){e=null,l=[]}})}return u}),z("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(m,c,a,u,e,l,i,r,t,d,h,n){var o={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};function f(){this.uid=m.guid("uid_")}f.prototype=a.instance;var s=["loadstart","progress","abort","error","load","timeout","loadend"];function p(){var g=this,w={timeout:0,readyState:p.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},b=!0,y,x,E={},v,R,_=null,A=null,S=!1,O=!1,F=!1,I=!1,T=!1,C=!1,N={},H,q="",B;m.extend(this,w,{uid:m.guid("uid_"),upload:new f,open:function(D,M,G,X,V){var k;if(!D||!M)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(D)||u.utf8_encode(D)!==D)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(~m.inArray(D.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(x=D.toUpperCase()),~m.inArray(x,["CONNECT","TRACE","TRACK"]))throw new c.DOMException(c.DOMException.SECURITY_ERR);if(M=u.utf8_encode(M),k=e.parseUrl(M),C=e.hasSameOrigin(k),y=e.resolveUrl(M),(X||V)&&!C)throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);if(v=X||k.user,R=V||k.pass,b=G||!0,b===!1&&(L("timeout")||L("withCredentials")||L("responseType")!==""))throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);S=!b,O=!1,E={},j.call(this),L("readyState",p.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(D,M){var G=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(L("readyState")!==p.OPENED||O)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(D)||u.utf8_encode(D)!==D)throw new c.DOMException(c.DOMException.SYNTAX_ERR);return D=m.trim(D).toLowerCase(),~m.inArray(D,G)||/^(proxy\-|sec\-)/.test(D)?!1:(E[D]?E[D]+=", "+M:E[D]=M,!0)},hasRequestHeader:function(D){return D&&E[D.toLowerCase()]||!1},getAllResponseHeaders:function(){return q||""},getResponseHeader:function(D){return D=D.toLowerCase(),T||~m.inArray(D,["set-cookie","set-cookie2"])?null:q&&q!==""&&(B||(B={},m.each(q.split(/\r\n/),function(M){var G=M.split(/:\s+/);G.length===2&&(G[0]=m.trim(G[0]),B[G[0].toLowerCase()]={header:G[0],value:m.trim(G[1])})})),B.hasOwnProperty(D))?B[D].header+": "+B[D].value:null},overrideMimeType:function(D){var M;if(~m.inArray(L("readyState"),[p.LOADING,p.DONE]))throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(D=m.trim(D.toLowerCase()),/;/.test(D)&&(M=D.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(D=M[1],M[2]&&M[2]),!n.mimes[D])throw new c.DOMException(c.DOMException.SYNTAX_ERR)},send:function(D,M){if(m.typeOf(M)==="string"?N={ruid:M}:M?N=M:N={},this.readyState!==p.OPENED||O)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(D instanceof r)N.ruid=D.ruid,A=D.type||"application/octet-stream";else if(D instanceof d){if(D.hasBlob()){var G=D.getBlob();N.ruid=G.ruid,A=G.type||"application/octet-stream"}}else typeof D=="string"&&(_="UTF-8",A="text/plain;charset=UTF-8",D=u.utf8_encode(D));this.withCredentials||(this.withCredentials=N.required_caps&&N.required_caps.send_browser_cookies&&!C),F=!S&&this.upload.hasEventListener(),T=!1,I=!D,S||(O=!0),U.call(this,D)},abort:function(){if(T=!0,S=!1,~m.inArray(L("readyState"),[p.UNSENT,p.OPENED,p.DONE]))L("readyState",p.UNSENT);else{if(L("readyState",p.DONE),O=!1,H)H.getRuntime().exec.call(H,"XMLHttpRequest","abort",I);else throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);I=!0}},destroy:function(){H&&(m.typeOf(H.destroy)==="function"&&H.destroy(),H=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(s.concat(["readystatechange"])),this.upload.handleEventProps(s);function L(D,M){if(w.hasOwnProperty(D)){if(arguments.length===1)return h.can("define_property")?w[D]:g[D];h.can("define_property")?w[D]=M:g[D]=M}}function U(D){var M=this;new Date().getTime(),H=new i;function G(){H&&(H.destroy(),H=null),M.dispatchEvent("loadend"),M=null}function X(V){H.bind("LoadStart",function(k){L("readyState",p.LOADING),M.dispatchEvent("readystatechange"),M.dispatchEvent(k),F&&M.upload.dispatchEvent(k)}),H.bind("Progress",function(k){L("readyState")!==p.LOADING&&(L("readyState",p.LOADING),M.dispatchEvent("readystatechange")),M.dispatchEvent(k)}),H.bind("UploadProgress",function(k){F&&M.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:k.total,loaded:k.loaded})}),H.bind("Load",function(k){L("readyState",p.DONE),L("status",Number(V.exec.call(H,"XMLHttpRequest","getStatus")||0)),L("statusText",o[L("status")]||""),L("response",V.exec.call(H,"XMLHttpRequest","getResponse",L("responseType"))),~m.inArray(L("responseType"),["text",""])?L("responseText",L("response")):L("responseType")==="document"&&L("responseXML",L("response")),q=V.exec.call(H,"XMLHttpRequest","getAllResponseHeaders"),M.dispatchEvent("readystatechange"),L("status")>0?(F&&M.upload.dispatchEvent(k),M.dispatchEvent(k)):(T=!0,M.dispatchEvent("error")),G()}),H.bind("Abort",function(k){M.dispatchEvent(k),G()}),H.bind("Error",function(k){T=!0,L("readyState",p.DONE),M.dispatchEvent("readystatechange"),I=!0,M.dispatchEvent(k),G()}),V.exec.call(H,"XMLHttpRequest","send",{url:y,method:x,async:b,user:v,password:R,headers:E,mimeType:A,encoding:_,responseType:M.responseType,withCredentials:M.withCredentials,options:N},D)}typeof N.required_caps=="string"&&(N.required_caps=l.parseCaps(N.required_caps)),N.required_caps=m.extend({},N.required_caps,{return_response_type:M.responseType}),D instanceof d&&(N.required_caps.send_multipart=!0),m.isEmptyObj(E)||(N.required_caps.send_custom_headers=!0),C||(N.required_caps.do_cors=!0),N.ruid?X(H.connectRuntime(N)):(H.bind("RuntimeInit",function(V,k){X(k)}),H.bind("RuntimeError",function(V,k){M.dispatchEvent("RuntimeError",k)}),H.connectRuntime(N))}function j(){L("responseText",""),L("responseXML",null),L("response",null),L("status",0),L("statusText","")}}return p.UNSENT=0,p.OPENED=1,p.HEADERS_RECEIVED=2,p.LOADING=3,p.DONE=4,p.prototype=a.instance,p}),z("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(m,c,a,u){function e(){var l,i,r,t,d,h;a.call(this),m.extend(this,{uid:m.guid("uid_"),state:e.IDLE,result:null,transport:function(s,p,g){var w=this;if(g=m.extend({chunk_size:204798},g),(l=g.chunk_size%3)&&(g.chunk_size+=3-l),h=g.chunk_size,n.call(this),r=s,t=s.length,m.typeOf(g)==="string"||g.ruid)o.call(w,p,this.connectRuntime(g));else{var b=function(y,x){w.unbind("RuntimeInit",b),o.call(w,p,x)};this.bind("RuntimeInit",b),this.connectRuntime(g)}},abort:function(){var s=this;s.state=e.IDLE,i&&(i.exec.call(s,"Transporter","clear"),s.trigger("TransportingAborted")),n.call(s)},destroy:function(){this.unbindAll(),i=null,this.disconnectRuntime(),n.call(this)}});function n(){t=d=0,r=this.result=null}function o(s,p){var g=this;i=p,g.bind("TransportingProgress",function(w){d=w.loaded,d<t&&m.inArray(g.state,[e.IDLE,e.DONE])===-1&&f.call(g)},999),g.bind("TransportingComplete",function(){d=t,g.state=e.DONE,r=null,g.result=i.exec.call(g,"Transporter","getAsBlob",s||"")},999),g.state=e.BUSY,g.trigger("TransportingStarted"),f.call(g)}function f(){var s=this,p,g=t-d;h>g&&(h=g),p=c.btoa(r.substr(d,h)),i.exec.call(s,"Transporter","receive",p,t)}}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=u.instance,e}),z("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(m,c,a,u,e,l,i,r,t,d,h,n,o){var f=["progress","load","error","resize","embedded"];function s(){i.call(this),m.extend(this,{uid:m.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){g.apply(this,arguments)},resize:function(x){var E=this,v,R,_={x:0,y:0,width:E.width,height:E.height},A=m.extendIf({width:E.width,height:E.height,type:E.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},x);try{if(!E.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);if(E.width>s.MAX_RESIZE_WIDTH||E.height>s.MAX_RESIZE_HEIGHT)throw new a.ImageError(a.ImageError.MAX_RESOLUTION_ERR);if(v=E.meta&&E.meta.tiff&&E.meta.tiff.Orientation||1,m.inArray(v,[5,6,7,8])!==-1){var S=A.width;A.width=A.height,A.height=S}if(A.crop){switch(R=Math.max(A.width/E.width,A.height/E.height),x.fit?(_.width=Math.min(Math.ceil(A.width/R),E.width),_.height=Math.min(Math.ceil(A.height/R),E.height),R=A.width/_.width):(_.width=Math.min(A.width,E.width),_.height=Math.min(A.height,E.height),R=1),typeof A.crop=="boolean"&&(A.crop="cc"),A.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":_.x=E.width-_.width,_.y=E.height-_.height;break;case"cb":case"center-bottom":_.x=Math.floor((E.width-_.width)/2),_.y=E.height-_.height;break;case"lb":case"left-bottom":_.x=0,_.y=E.height-_.height;break;case"lt":case"left-top":_.x=0,_.y=0;break;case"ct":case"center-top":_.x=Math.floor((E.width-_.width)/2),_.y=0;break;case"rt":case"right-top":_.x=E.width-_.width,_.y=0;break;case"rc":case"right-center":case"right-middle":_.x=E.width-_.width,_.y=Math.floor((E.height-_.height)/2);break;case"lc":case"left-center":case"left-middle":_.x=0,_.y=Math.floor((E.height-_.height)/2);break;case"cc":case"center-center":case"center-middle":default:_.x=Math.floor((E.width-_.width)/2),_.y=Math.floor((E.height-_.height)/2)}_.x=Math.max(_.x,0),_.y=Math.max(_.y,0)}else R=Math.min(A.width/E.width,A.height/E.height),R>1&&!A.fit&&(R=1);this.exec("Image","resize",_,R,A)}catch(O){E.trigger("error",O.code)}},downsize:function(x){var E={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"},v;typeof x=="object"?v=m.extend(E,x):v=m.extend(E,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]}),this.resize(v)},crop:function(x,E,v){this.downsize(x,E,!0,v)},getAsCanvas:function(){if(!t.can("create_canvas"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function(x,E){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",x||"image/jpeg",E||90)},getAsDataURL:function(x,E){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",x||"image/jpeg",E||90)},getAsBinaryString:function(x,E){var v=this.getAsDataURL(x,E);return o.atob(v.substring(v.indexOf("base64,")+7))},embed:function(x,E){var v=this,R,_=m.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},E);function A(O,F){var I=this;if(t.can("create_canvas")){var T=I.getAsCanvas();if(T){x.appendChild(T),T=null,I.destroy(),v.trigger("embedded");return}}var C=I.getAsDataURL(O,F);if(!C)throw new a.ImageError(a.ImageError.WRONG_FORMAT);if(t.can("use_data_uri_of",C.length))x.innerHTML='<img src="'+C+'" width="'+I.width+'" height="'+I.height+'" alt="" />',I.destroy(),v.trigger("embedded");else{var N=new r;N.bind("TransportingComplete",function(){R=v.connectRuntime(this.result.ruid),v.bind("Embedded",function(){m.extend(R.getShimContainer().style,{top:"0px",left:"0px",width:I.width+"px",height:I.height+"px"}),R=null},999),R.exec.call(v,"ImageView","display",this.result.uid,width,height),I.destroy()}),N.transport(o.atob(C.substring(C.indexOf("base64,")+7)),O,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:x})}}try{if(!(x=c.get(x)))throw new a.DOMException(a.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);this.width>s.MAX_RESIZE_WIDTH||this.height>s.MAX_RESIZE_HEIGHT;var S=new s;return S.bind("Resize",function(){A.call(this,_.type,_.quality)}),S.bind("Load",function(){this.downsize(_)}),this.meta.thumb&&this.meta.thumb.width>=_.width&&this.meta.thumb.height>=_.height?S.load(this.meta.thumb.data):S.clone(this,!1),S}catch(O){this.trigger("error",O.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy(),this.unbindAll()}}),this.handleEventProps(f),this.bind("Load Resize",function(){return p.call(this)},999);function p(x){try{return x||(x=this.exec("Image","getInfo")),this.size=x.size,this.width=x.width,this.height=x.height,this.type=x.type,this.meta=x.meta,this.name===""&&(this.name=x.name),!0}catch(E){return this.trigger("error",E.code),!1}}function g(x){var E=m.typeOf(x);try{if(x instanceof s){if(!x.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);w.apply(this,arguments)}else if(x instanceof h){if(!~m.inArray(x.type,["image/jpeg","image/png"]))throw new a.ImageError(a.ImageError.WRONG_FORMAT);b.apply(this,arguments)}else if(m.inArray(E,["blob","file"])!==-1)g.call(this,new n(null,x),arguments[1]);else if(E==="string")x.substr(0,5)==="data:"?g.call(this,new h(null,{data:x}),arguments[1]):y.apply(this,arguments);else if(E==="node"&&x.nodeName.toLowerCase()==="img")g.call(this,x.src,arguments[1]);else throw new a.DOMException(a.DOMException.TYPE_MISMATCH_ERR)}catch(v){this.trigger("error",v.code)}}function w(x,E){var v=this.connectRuntime(x.ruid);this.ruid=v.uid,v.exec.call(this,"Image","loadFromImage",x,m.typeOf(E)==="undefined"?!0:E)}function b(x,E){var v=this;v.name=x.name||"";function R(_){v.ruid=_.uid,_.exec.call(v,"Image","loadFromBlob",x)}x.isDetached()?(this.bind("RuntimeInit",function(_,A){R(A)}),E&&typeof E.required_caps=="string"&&(E.required_caps=l.parseCaps(E.required_caps)),this.connectRuntime(m.extend({required_caps:{access_image_binary:!0,resize_image:!0}},E))):R(this.connectRuntime(x.ruid))}function y(x,E){var v=this,R;R=new e,R.open("get",x),R.responseType="blob",R.onprogress=function(_){v.trigger(_)},R.onload=function(){b.call(v,R.response,!0)},R.onerror=function(_){v.trigger(_)},R.onloadend=function(){R.destroy()},R.bind("RuntimeError",function(_,A){v.trigger("RuntimeError",A)}),R.send(null,E)}}return s.MAX_RESIZE_WIDTH=8192,s.MAX_RESIZE_HEIGHT=8192,s.prototype=d.instance,s}),z("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(m,c,a,u){var e="html5",l={};function i(r){var t=this,d=a.capTest,h=a.capTrue,n=m.extend({access_binary:d(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return t.can("access_binary")&&!!l.Image},display_media:d((u.can("create_canvas")||u.can("use_data_uri_over32kb"))&&Z("moxie/image/Image")),do_cors:d(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:d(function(){var o=document.createElement("div");return("draggable"in o||"ondragstart"in o&&"ondrop"in o)&&(u.browser!=="IE"||u.verComp(u.version,9,">"))}()),filter_by_extension:d(function(){return!(u.browser==="Chrome"&&u.verComp(u.version,28,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<")||u.browser==="Safari"&&u.verComp(u.version,7,"<")||u.browser==="Firefox"&&u.verComp(u.version,37,"<"))}()),return_response_headers:h,return_response_type:function(o){return o==="json"&&window.JSON?!0:u.can("return_response_type",o)},return_status_code:h,report_upload_progress:d(window.XMLHttpRequest&&new XMLHttpRequest().upload),resize_image:function(){return t.can("access_binary")&&u.can("create_canvas")},select_file:function(){return u.can("use_fileinput")&&window.File},select_folder:function(){return t.can("select_file")&&(u.browser==="Chrome"&&u.verComp(u.version,21,">=")||u.browser==="Firefox"&&u.verComp(u.version,42,">="))},select_multiple:function(){return t.can("select_file")&&!(u.browser==="Safari"&&u.os==="Windows")&&!(u.os==="iOS"&&u.verComp(u.osVersion,"7.0.0",">")&&u.verComp(u.osVersion,"8.0.0","<"))},send_binary_string:d(window.XMLHttpRequest&&(new XMLHttpRequest().sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:d(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&new XMLHttpRequest().upload&&window.FormData)||t.can("send_binary_string")},slice_blob:d(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return t.can("slice_blob")&&t.can("send_multipart")},summon_file_dialog:function(){return t.can("select_file")&&!(u.browser==="Firefox"&&u.verComp(u.version,4,"<")||u.browser==="Opera"&&u.verComp(u.version,12,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<"))},upload_filesize:h,use_http_method:h},arguments[2]);a.call(this,r,arguments[1]||e,n),m.extend(this,{init:function(){this.trigger("Init")},destroy:function(o){return function(){o.call(t),o=t=null}}(this.destroy)}),m.extend(this.getShim(),l)}return a.addConstructor(e,i),l}),z("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(m,c){function a(){function u(e,l,i){var r;if(window.File.prototype.slice)try{return e.slice(),e.slice(l,i)}catch{return e.slice(l,i-l)}else return(r=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?r.call(e,l,i):null}this.slice=function(){return new c(this.getRuntime().uid,u.apply(this,arguments))},this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return m.Blob=a}),z("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(m){var c={},a="moxie_"+m.guid();function u(){this.returnValue=!1}function e(){this.cancelBubble=!0}var l=function(t,d,h,n){var o,f;d=d.toLowerCase(),t.addEventListener?(o=h,t.addEventListener(d,o,!1)):t.attachEvent&&(o=function(){var s=window.event;s.target||(s.target=s.srcElement),s.preventDefault=u,s.stopPropagation=e,h(s)},t.attachEvent("on"+d,o)),t[a]||(t[a]=m.guid()),c.hasOwnProperty(t[a])||(c[t[a]]={}),f=c[t[a]],f.hasOwnProperty(d)||(f[d]=[]),f[d].push({func:o,orig:h,key:n})},i=function(t,d,h){var n,o;if(d=d.toLowerCase(),t[a]&&c[t[a]]&&c[t[a]][d])n=c[t[a]][d];else return;for(var f=n.length-1;f>=0&&!((n[f].orig===h||n[f].key===h)&&(t.removeEventListener?t.removeEventListener(d,n[f].func,!1):t.detachEvent&&t.detachEvent("on"+d,n[f].func),n[f].orig=null,n[f].func=null,n.splice(f,1),h!==o));f--);if(n.length||delete c[t[a]][d],m.isEmptyObj(c[t[a]])){delete c[t[a]];try{delete t[a]}catch{t[a]=o}}},r=function(t,d){!t||!t[a]||m.each(c[t[a]],function(h,n){i(t,n,d)})};return{addEvent:l,removeEvent:i,removeAllEvents:r}}),z("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i){function r(){var t,d;a.extend(this,{init:function(h){var n=this,o=n.getRuntime(),f,s,p,g,w,b;t=h,p=l.extList2mimes(t.accept,o.can("filter_by_extension")),s=o.getShimContainer(),s.innerHTML='<input id="'+o.uid+'" type="file" style="font-size:999px;opacity:0;"'+(t.multiple&&o.can("select_multiple")?"multiple":"")+(t.directory&&o.can("select_folder")?"webkitdirectory directory":"")+(p?' accept="'+p.join(",")+'"':"")+" />",f=u.get(o.uid),a.extend(f.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),g=u.get(t.browse_button),d=u.getStyle(g,"z-index")||"auto",o.can("summon_file_dialog")&&(u.getStyle(g,"position")==="static"&&(g.style.position="relative"),e.addEvent(g,"click",function(y){var x=u.get(o.uid);x&&!x.disabled&&x.click(),y.preventDefault()},n.uid),n.bind("Refresh",function(){w=parseInt(d,10)||1,u.get(t.browse_button).style.zIndex=w,this.getRuntime().getShimContainer().style.zIndex=w-1})),b=o.can("summon_file_dialog")?g:s,e.addEvent(b,"mouseover",function(){n.trigger("mouseenter")},n.uid),e.addEvent(b,"mouseout",function(){n.trigger("mouseleave")},n.uid),e.addEvent(b,"mousedown",function(){n.trigger("mousedown")},n.uid),e.addEvent(u.get(t.container),"mouseup",function(){n.trigger("mouseup")},n.uid),(o.can("summon_file_dialog")?f:g).setAttribute("tabindex",-1),f.onchange=function y(){if(n.files=[],a.each(this.files,function(E){var v="";if(t.directory&&E.name==".")return!0;E.webkitRelativePath&&(v="/"+E.webkitRelativePath.replace(/^\//,"")),E=new c(o.uid,E),E.relativePath=v,n.files.push(E)}),i.browser!=="IE"&&i.browser!=="IEMobile")this.value="";else{var x=this.cloneNode(!0);this.parentNode.replaceChild(x,this),x.onchange=y}n.files.length&&n.trigger("change")},n.trigger({type:"ready",async:!0}),s=null},setOption:function(h,n){var o=this.getRuntime(),f=u.get(o.uid);switch(h){case"accept":if(n){var s=n.mimes||l.extList2mimes(n,o.can("filter_by_extension"));f.setAttribute("accept",s.join(","))}else f.removeAttribute("accept");break;case"directory":n&&o.can("select_folder")?(f.setAttribute("directory",""),f.setAttribute("webkitdirectory","")):(f.removeAttribute("directory"),f.removeAttribute("webkitdirectory"));break;case"multiple":n&&o.can("select_multiple")?f.setAttribute("multiple",""):f.removeAttribute("multiple")}},disable:function(h){var n=this.getRuntime(),o;(o=u.get(n.uid))&&(o.disabled=!!h)},destroy:function(){var h=this.getRuntime(),n=h.getShim(),o=h.getShimContainer(),f=t&&u.get(t.container),s=t&&u.get(t.browse_button);f&&e.removeAllEvents(f,this.uid),s&&(e.removeAllEvents(s,this.uid),s.style.zIndex=d),o&&(e.removeAllEvents(o,this.uid),o.innerHTML=""),n.removeInstance(this.uid),t=o=f=s=n=null}})}return m.FileInput=r}),z("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(m,c,a,u,e,l){function i(){var r=[],t=[],d,h;a.extend(this,{init:function(y){var x=this,E;d=y,h=x.ruid,t=f(d.accept),E=d.container,e.addEvent(E,"dragover",function(v){n(v)&&(v.preventDefault(),v.dataTransfer.dropEffect="copy")},x.uid),e.addEvent(E,"drop",function(v){n(v)&&(v.preventDefault(),r=[],v.dataTransfer.items&&v.dataTransfer.items[0].webkitGetAsEntry?p(v.dataTransfer.items,function(){x.files=r,x.trigger("drop")}):(a.each(v.dataTransfer.files,function(R){o(R)}),x.files=r,x.trigger("drop")))},x.uid),e.addEvent(E,"dragenter",function(v){x.trigger("dragenter")},x.uid),e.addEvent(E,"dragleave",function(v){x.trigger("dragleave")},x.uid)},destroy:function(){e.removeAllEvents(d&&u.get(d.container),this.uid),h=r=t=d=null,this.getRuntime().getShim().removeInstance(this.uid)}});function n(y){if(!y.dataTransfer||!y.dataTransfer.types)return!1;var x=a.toArray(y.dataTransfer.types||[]);return a.inArray("Files",x)!==-1||a.inArray("public.file-url",x)!==-1||a.inArray("application/x-moz-file",x)!==-1}function o(y,x){if(s(y)){var E=new c(h,y);E.relativePath=x||"",r.push(E)}}function f(y){for(var x=[],E=0;E<y.length;E++)[].push.apply(x,y[E].extensions.split(/\s*,\s*/));return a.inArray("*",x)===-1?x:[]}function s(y){if(!t.length)return!0;var x=l.getFileExtension(y.name);return!x||a.inArray(x,t)!==-1}function p(y,x){var E=[];a.each(y,function(v){var R=v.webkitGetAsEntry();R&&(R.isFile?o(v.getAsFile(),R.fullPath):E.push(R))}),E.length?g(E,x):x()}function g(y,x){var E=[];a.each(y,function(v){E.push(function(R){w(v,R)})}),a.inSeries(E,function(){x()})}function w(y,x){y.isFile?y.file(function(E){o(E,y.fullPath),x()},function(){x()}):y.isDirectory?b(y,x):x()}function b(y,x){var E=[],v=y.createReader();function R(_){v.readEntries(function(A){A.length?([].push.apply(E,A),R(_)):_()},_)}R(function(){g(E,x)})}}return m.FileDrop=i}),z("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(m,c,a){function u(){var e,l=!1;a.extend(this,{read:function(r,t){var d=this;d.result="",e=new window.FileReader,e.addEventListener("progress",function(h){d.trigger(h)}),e.addEventListener("load",function(h){d.result=l?i(e.result):e.result,d.trigger(h)}),e.addEventListener("error",function(h){d.trigger(h,e.error)}),e.addEventListener("loadend",function(h){e=null,d.trigger(h)}),a.typeOf(e[r])==="function"?(l=!1,e[r](t.getSource())):r==="readAsBinaryString"&&(l=!0,e.readAsDataURL(t.getSource()))},abort:function(){e&&e.abort()},destroy:function(){e=null,this.getRuntime().getShim().removeInstance(this.uid)}});function i(r){return c.atob(r.substring(r.indexOf("base64,")+7))}}return m.FileReader=u}),z("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(m,c,a,u,e,l,i,r,t){function d(){var h=this,n,o;c.extend(this,{send:function(w,b){var y=this,x=t.browser==="Mozilla"&&t.verComp(t.version,4,">=")&&t.verComp(t.version,7,"<"),E=t.browser==="Android Browser",v=!1;if(o=w.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),n=s(),n.open(w.method,w.url,w.async,w.user,w.password),b instanceof l)b.isDetached()&&(v=!0),b=b.getSource();else if(b instanceof i){if(b.hasBlob()){if(b.getBlob().isDetached())b=g.call(y,b),v=!0;else if((x||E)&&c.typeOf(b.getBlob().getSource())==="blob"&&window.FileReader){f.call(y,w,b);return}}if(b instanceof i){var R=new window.FormData;b.each(function(_,A){_ instanceof l?R.append(A,_.getSource()):R.append(A,_)}),b=R}}n.upload?(w.withCredentials&&(n.withCredentials=!0),n.addEventListener("load",function(_){y.trigger(_)}),n.addEventListener("error",function(_){y.trigger(_)}),n.addEventListener("progress",function(_){y.trigger(_)}),n.upload.addEventListener("progress",function(_){y.trigger({type:"UploadProgress",loaded:_.loaded,total:_.total})})):n.onreadystatechange=function(){switch(n.readyState){case 1:break;case 2:break;case 3:var A,S;try{u.hasSameOrigin(w.url)&&(A=n.getResponseHeader("Content-Length")||0),n.responseText&&(S=n.responseText.length)}catch{A=S=0}y.trigger({type:"progress",lengthComputable:!!A,total:parseInt(A,10),loaded:S});break;case 4:n.onreadystatechange=function(){};try{if(n.status>=200&&n.status<400){y.trigger("load");break}}catch{}y.trigger("error");break}},c.isEmptyObj(w.headers)||c.each(w.headers,function(_,A){n.setRequestHeader(A,_)}),w.responseType!==""&&"responseType"in n&&(w.responseType==="json"&&!t.can("return_response_type","json")?n.responseType="text":n.responseType=w.responseType),v?n.sendAsBinary?n.sendAsBinary(b):function(){for(var _=new Uint8Array(b.length),A=0;A<b.length;A++)_[A]=b.charCodeAt(A)&255;n.send(_.buffer)}():n.send(b),y.trigger("loadstart")},getStatus:function(){try{if(n)return n.status}catch{}return 0},getResponse:function(w){var b=this.getRuntime();try{switch(w){case"blob":var y=new e(b.uid,n.response),x=n.getResponseHeader("Content-Disposition");if(x){var E=x.match(/filename=([\'\"'])([^\1]+)\1/);E&&(o=E[2])}return y.name=o,y.type||(y.type=a.getFileMime(o)),y;case"json":return t.can("return_response_type","json")?n.response:n.status===200&&window.JSON?JSON.parse(n.responseText):null;case"document":return p(n);default:return n.responseText!==""?n.responseText:null}}catch{return null}},getAllResponseHeaders:function(){try{return n.getAllResponseHeaders()}catch{}return""},abort:function(){n&&n.abort()},destroy:function(){h=o=null,this.getRuntime().getShim().removeInstance(this.uid)}});function f(w,b){var y=this,x,E;x=b.getBlob().getSource(),E=new window.FileReader,E.onload=function(){b.append(b.getBlobName(),new l(null,{type:x.type,data:E.result})),h.send.call(y,w,b)},E.readAsBinaryString(x)}function s(){return window.XMLHttpRequest&&!(t.browser==="IE"&&t.verComp(t.version,8,"<"))?new window.XMLHttpRequest:function(){for(var w=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<w.length;b++)try{return new ActiveXObject(w[b])}catch{}}()}function p(w){var b=w.responseXML,y=w.responseText;return t.browser==="IE"&&y&&b&&!b.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(w.getResponseHeader("Content-Type"))&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(y)),b&&(t.browser==="IE"&&b.parseError!==0||!b.documentElement||b.documentElement.tagName==="parsererror")?null:b}function g(w){var b="----moxieboundary"+new Date().getTime(),y="--",x=`\r
`,E="",v=this.getRuntime();if(!v.can("send_binary_string"))throw new r.RuntimeError(r.RuntimeError.NOT_SUPPORTED_ERR);return n.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),w.each(function(R,_){R instanceof l?E+=y+b+x+'Content-Disposition: form-data; name="'+_+'"; filename="'+unescape(encodeURIComponent(R.name||"blob"))+'"'+x+"Content-Type: "+(R.type||"application/octet-stream")+x+x+R.getSource()+x:E+=y+b+x+'Content-Disposition: form-data; name="'+_+'"'+x+x+unescape(encodeURIComponent(R))+x}),E+=y+b+y+x,E}}return m.XMLHttpRequest=d}),z("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(m){function c(e){e instanceof ArrayBuffer?a.apply(this,arguments):u.apply(this,arguments)}m.extend(c.prototype,{littleEndian:!1,read:function(e,l){var i,r,t;if(e+l>this.length())throw new Error("You are trying to read outside the source boundaries.");for(r=this.littleEndian?0:-8*(l-1),t=0,i=0;t<l;t++)i|=this.readByteAt(e+t)<<Math.abs(r+t*8);return i},write:function(e,l,i){var r,t;if(e>this.length())throw new Error("You are trying to write outside the source boundaries.");for(r=this.littleEndian?0:-8*(i-1),t=0;t<i;t++)this.writeByteAt(e+t,l>>Math.abs(r+t*8)&255)},BYTE:function(e){return this.read(e,1)},SHORT:function(e){return this.read(e,2)},LONG:function(e){return this.read(e,4)},SLONG:function(e){var l=this.read(e,4);return l>2147483647?l-4294967296:l},CHAR:function(e){return String.fromCharCode(this.read(e,1))},STRING:function(e,l){return this.asArray("CHAR",e,l).join("")},asArray:function(e,l,i){for(var r=[],t=0;t<i;t++)r[t]=this[e](l+t);return r}});function a(e){var l=new DataView(e);m.extend(this,{readByteAt:function(i){return l.getUint8(i)},writeByteAt:function(i,r){l.setUint8(i,r)},SEGMENT:function(i,r,t){switch(arguments.length){case 2:return e.slice(i,i+r);case 1:return e.slice(i);case 3:if(t===null&&(t=new ArrayBuffer),t instanceof ArrayBuffer){var d=new Uint8Array(this.length()-r+t.byteLength);i>0&&d.set(new Uint8Array(e.slice(0,i)),0),d.set(new Uint8Array(t),i),d.set(new Uint8Array(e.slice(i+r)),i+t.byteLength),this.clear(),e=d.buffer,l=new DataView(e);break}default:return e}},length:function(){return e?e.byteLength:0},clear:function(){l=e=null}})}function u(e){m.extend(this,{readByteAt:function(i){return e.charCodeAt(i)},writeByteAt:function(i,r){l(String.fromCharCode(r),i,1)},SEGMENT:function(i,r,t){switch(arguments.length){case 1:return e.substr(i);case 2:return e.substr(i,r);case 3:l(t!==null?t:"",i,r);break;default:return e}},length:function(){return e?e.length:0},clear:function(){e=null}});function l(i,r,t){t=arguments.length===3?t:e.length-r-1,e=e.substr(0,r)+i+e.substr(t+r)}}return c}),z("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(m,c){return function a(u){var e=[],l,i,r,t=0;if(l=new m(u),l.SHORT(0)!==65496)throw l.clear(),new c.ImageError(c.ImageError.WRONG_FORMAT);for(i=2;i<=l.length();){if(r=l.SHORT(i),r>=65488&&r<=65495){i+=2;continue}if(r===65498||r===65497)break;t=l.SHORT(i+2)+2,r>=65505&&r<=65519&&e.push({hex:r,name:"APP"+(r&15),start:i,length:t,segment:l.SEGMENT(i,t)}),i+=t}return l.clear(),{headers:e,restore:function(d){var h,n,o;for(o=new m(d),i=o.SHORT(2)==65504?4+o.SHORT(4):2,n=0,h=e.length;n<h;n++)o.SEGMENT(i,0,e[n].segment),i+=e[n].length;return d=o.SEGMENT(),o.clear(),d},strip:function(d){var h,n,o,f;for(o=new a(d),n=o.headers,o.purge(),h=new m(d),f=n.length;f--;)h.SEGMENT(n[f].start,n[f].length,"");return d=h.SEGMENT(),h.clear(),d},get:function(d){for(var h=[],n=0,o=e.length;n<o;n++)e[n].name===d.toUpperCase()&&h.push(e[n].segment);return h},set:function(d,h){var n=[],o,f,s;for(typeof h=="string"?n.push(h):n=h,o=f=0,s=e.length;o<s&&(e[o].name===d.toUpperCase()&&(e[o].segment=n[f],e[o].length=n[f].length,f++),!(f>=n.length));o++);},purge:function(){this.headers=e=[]}}}}),z("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(m,c,a){function u(e){var l,i,r,t,d,h;if(c.call(this,e),i={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},r={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},t={tiffHeader:10},d=t.tiffHeader,l={clear:this.clear},m.extend(this,{read:function(){try{return u.prototype.read.apply(this,arguments)}catch{throw new a.ImageError(a.ImageError.INVALID_META_ERR)}},write:function(){try{return u.prototype.write.apply(this,arguments)}catch{throw new a.ImageError(a.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(s){return this.LONG(s)/this.LONG(s+4)},SRATIONAL:function(s){return this.SLONG(s)/this.SLONG(s+4)},ASCII:function(s){return this.CHAR(s)},TIFF:function(){return h||null},EXIF:function(){var s=null;if(t.exifIFD){try{s=o.call(this,t.exifIFD,i.exif)}catch{return null}if(s.ExifVersion&&m.typeOf(s.ExifVersion)==="array"){for(var p=0,g="";p<s.ExifVersion.length;p++)g+=String.fromCharCode(s.ExifVersion[p]);s.ExifVersion=g}}return s},GPS:function(){var s=null;if(t.gpsIFD){try{s=o.call(this,t.gpsIFD,i.gps)}catch{return null}s.GPSVersionID&&m.typeOf(s.GPSVersionID)==="array"&&(s.GPSVersionID=s.GPSVersionID.join("."))}return s},thumb:function(){if(t.IFD1)try{var s=o.call(this,t.IFD1,i.thumb);if("JPEGInterchangeFormat"in s)return this.SEGMENT(t.tiffHeader+s.JPEGInterchangeFormat,s.JPEGInterchangeFormatLength)}catch{}return null},setExif:function(s,p){return s!=="PixelXDimension"&&s!=="PixelYDimension"?!1:f.call(this,"exif",s,p)},clear:function(){l.clear(),e=i=r=h=t=l=null}}),this.SHORT(0)!==65505||this.STRING(4,5).toUpperCase()!=="EXIF\0")throw new a.ImageError(a.ImageError.INVALID_META_ERR);if(this.littleEndian=this.SHORT(d)==18761,this.SHORT(d+=2)!==42)throw new a.ImageError(a.ImageError.INVALID_META_ERR);t.IFD0=t.tiffHeader+this.LONG(d+=2),h=o.call(this,t.IFD0,i.tiff),"ExifIFDPointer"in h&&(t.exifIFD=t.tiffHeader+h.ExifIFDPointer,delete h.ExifIFDPointer),"GPSInfoIFDPointer"in h&&(t.gpsIFD=t.tiffHeader+h.GPSInfoIFDPointer,delete h.GPSInfoIFDPointer),m.isEmptyObj(h)&&(h=null);var n=this.LONG(t.IFD0+this.SHORT(t.IFD0)*12+2);n&&(t.IFD1=t.tiffHeader+n);function o(s,p){var g=this,w,b,y,x,E,v,R,_,A=[],S={},O={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},F={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(w=g.SHORT(s),b=0;b<w;b++)if(A=[],R=s+2+b*12,y=p[g.SHORT(R)],y!==J){if(x=O[g.SHORT(R+=2)],E=g.LONG(R+=2),v=F[x],!v)throw new a.ImageError(a.ImageError.INVALID_META_ERR);if(R+=4,v*E>4&&(R=g.LONG(R)+t.tiffHeader),R+v*E>=this.length())throw new a.ImageError(a.ImageError.INVALID_META_ERR);if(x==="ASCII"){S[y]=m.trim(g.STRING(R,E).replace(/\0$/,""));continue}else A=g.asArray(x,R,E),_=E==1?A[0]:A,r.hasOwnProperty(y)&&typeof _!="object"?S[y]=r[y][_]:S[y]=_}return S}function f(s,p,g){var w,b,y,x=0;if(typeof p=="string"){var E=i[s.toLowerCase()];for(var v in E)if(E[v]===p){p=v;break}}w=t[s.toLowerCase()+"IFD"],b=this.SHORT(w);for(var R=0;R<b;R++)if(y=w+12*R+2,this.SHORT(y)==p){x=y+8;break}if(!x)return!1;try{this.write(x,g,4)}catch{return!1}return!0}}return u.prototype=c.prototype,u}),z("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(m,c,a,u,e){function l(i){var r,t,d,h;if(r=new u(i),r.SHORT(0)!==65496)throw new c.ImageError(c.ImageError.WRONG_FORMAT);t=new a(i);try{d=new e(t.get("app1")[0])}catch{}h=n.call(this),m.extend(this,{type:"image/jpeg",size:r.length(),width:h&&h.width||0,height:h&&h.height||0,setExif:function(s,p){if(!d)return!1;m.typeOf(s)==="object"?m.each(s,function(g,w){d.setExif(w,g)}):d.setExif(s,p),t.set("app1",d.SEGMENT())},writeHeaders:function(){return arguments.length?t.restore(arguments[0]):t.restore(i)},stripHeaders:function(s){return t.strip(s)},purge:function(){f.call(this)}}),d&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS(),thumb:o()});function n(s){var p=0,g,w;for(s||(s=r);p<=s.length();){if(g=s.SHORT(p+=2),g>=65472&&g<=65475)return p+=5,{height:s.SHORT(p),width:s.SHORT(p+=2)};w=s.SHORT(p+=2),p+=w-2}return null}function o(){var s=d.thumb(),p,g;return s&&(p=new u(s),g=n(p),p.clear(),g)?(g.data=s,g):null}function f(){!d||!t||!r||(d.clear(),t.purge(),r.clear(),h=t=d=r=null)}}return l}),z("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(m,c,a){function u(e){var l,i;l=new a(e),function(){var h=0,n=0,o=[35152,20039,3338,6666];for(n=0;n<o.length;n++,h+=2)if(o[n]!=l.SHORT(h))throw new m.ImageError(m.ImageError.WRONG_FORMAT)}();function r(){var h,n;return h=d.call(this,8),h.type=="IHDR"?(n=h.start,{width:l.LONG(n),height:l.LONG(n+=4)}):null}function t(){l&&(l.clear(),e=i=l=null)}i=r.call(this),c.extend(this,{type:"image/png",size:l.length(),width:i.width,height:i.height,purge:function(){t.call(this)}}),t.call(this);function d(h){var n,o,f,s;return n=l.LONG(h),o=l.STRING(h+=4,4),f=h+=4,s=l.LONG(h+n),{length:n,type:o,start:f,CRC:s}}}return u}),z("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(m,c,a,u){return function(e){var l=[a,u],i;i=function(){for(var r=0;r<l.length;r++)try{return new l[r](e)}catch{}throw new c.ImageError(c.ImageError.WRONG_FORMAT)}(),m.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(r){return r},stripHeaders:function(r){return r},purge:function(){e=null}}),m.extend(this,i),this.purge=function(){i.purge(),i=null}}}),z("moxie/runtime/html5/image/ResizerCanvas",[],function(){function m(a,u,e){var l=a.width>a.height?"width":"height",i=Math.round(a[l]*u),r=!1;e!=="nearest"&&(u<.5||u>2)&&(u=u<.5?.5:2,r=!0);var t=c(a,u);return r?m(t,i/t[l],e):t}function c(a,u){var e=a.width,l=a.height,i=Math.round(e*u),r=Math.round(l*u),t=document.createElement("canvas");return t.width=i,t.height=r,t.getContext("2d").drawImage(a,0,0,e,l,0,0,i,r),a=null,t}return{scale:m}}),z("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i,r,t,d){function h(){var n=this,o,f,s,p,g,w=!1,b=!0;c.extend(this,{loadFromBlob:function(O){var F=this.getRuntime(),I=arguments.length>1?arguments[1]:!0;if(!F.can("access_binary"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);if(g=O,O.isDetached()){p=O.getSource(),R.call(this,p);return}else _.call(this,O.getSource(),function(T){I&&(p=E(T)),R.call(this,T)})},loadFromImage:function(O,F){this.meta=O.meta,g=new l(null,{name:O.name,size:O.size,type:O.type}),R.call(this,F?p=O.getAsBinaryString():O.getAsDataURL())},getInfo:function(){var O=this.getRuntime(),F;return!f&&p&&O.can("access_image_binary")&&(f=new i(p)),F={width:y().width||0,height:y().height||0,type:g.type||t.getFileMime(g.name),size:p&&p.length||g.size||0,name:g.name||"",meta:null},b&&(F.meta=f&&f.meta||this.meta||{},F.meta&&F.meta.thumb&&!(F.meta.thumb.data instanceof e)&&(F.meta.thumb.data=new e(null,{type:"image/jpeg",data:F.meta.thumb.data}))),F},resize:function(O,F,I){var T=document.createElement("canvas");if(T.width=O.width,T.height=O.height,T.getContext("2d").drawImage(y(),O.x,O.y,O.width,O.height,0,0,T.width,T.height),s=r.scale(T,F),b=I.preserveHeaders,!b){var C=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;s=A(s,C)}this.width=s.width,this.height=s.height,w=!0,this.trigger("Resize")},getAsCanvas:function(){return s||(s=x()),s.id=this.uid+"_canvas",s},getAsBlob:function(O,F){return O!==this.type?(w=!0,new l(null,{name:g.name||"",type:O,data:n.getAsDataURL(O,F)})):new l(null,{name:g.name||"",type:O,data:n.getAsBinaryString(O,F)})},getAsDataURL:function(O){var F=arguments[1]||90;if(!w)return o.src;if(x(),O!=="image/jpeg")return s.toDataURL("image/png");try{return s.toDataURL("image/jpeg",F/100)}catch{return s.toDataURL("image/jpeg")}},getAsBinaryString:function(O,F){if(!w)return p||(p=E(n.getAsDataURL(O,F))),p;if(O!=="image/jpeg")p=E(n.getAsDataURL(O,F));else{var I;F||(F=90),x();try{I=s.toDataURL("image/jpeg",F/100)}catch{I=s.toDataURL("image/jpeg")}p=E(I),f&&(p=f.stripHeaders(p),b&&(f.meta&&f.meta.exif&&f.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),p=f.writeHeaders(p)),f.purge(),f=null)}return w=!1,p},destroy:function(){n=null,S.call(this),this.getRuntime().getShim().removeInstance(this.uid)}});function y(){if(!s&&!o)throw new a.ImageError(a.DOMException.INVALID_STATE_ERR);return s||o}function x(){var O=y();return O.nodeName.toLowerCase()=="canvas"?O:(s=document.createElement("canvas"),s.width=O.width,s.height=O.height,s.getContext("2d").drawImage(O,0,0),s)}function E(O){return u.atob(O.substring(O.indexOf("base64,")+7))}function v(O,F){return"data:"+(F||"")+";base64,"+u.btoa(O)}function R(O){var F=this;o=new Image,o.onerror=function(){S.call(this),F.trigger("error",a.ImageError.WRONG_FORMAT)},o.onload=function(){F.trigger("load")},o.src=O.substr(0,5)=="data:"?O:v(O,g.type)}function _(O,F){var I=this,T;if(window.FileReader)T=new FileReader,T.onload=function(){F.call(I,this.result)},T.onerror=function(){I.trigger("error",a.ImageError.WRONG_FORMAT)},T.readAsDataURL(O);else return F.call(this,O.getAsDataURL())}function A(O,F){var I=Math.PI/180,T=document.createElement("canvas"),C=T.getContext("2d"),N=O.width,H=O.height;switch(c.inArray(F,[5,6,7,8])>-1?(T.width=H,T.height=N):(T.width=N,T.height=H),F){case 2:C.translate(N,0),C.scale(-1,1);break;case 3:C.translate(N,H),C.rotate(180*I);break;case 4:C.translate(0,H),C.scale(1,-1);break;case 5:C.rotate(90*I),C.scale(1,-1);break;case 6:C.rotate(90*I),C.translate(0,-H);break;case 7:C.rotate(90*I),C.translate(N,-H),C.scale(-1,1);break;case 8:C.rotate(-90*I),C.translate(-N,0);break}return C.drawImage(O,0,0,N,H),T}function S(){f&&(f.purge(),f=null),p=o=s=g=null,w=!1}}return m.Image=h}),z("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(m,c,a,u,e){var l="flash",i={};function r(){var n;try{n=navigator.plugins["Shockwave Flash"],n=n.description}catch{try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch{n="0.0"}}return n=n.match(/\d+/g),parseFloat(n[0]+"."+n[1])}function t(n){var o=a.get(n);o&&o.nodeName=="OBJECT"&&(c.browser==="IE"?(o.style.display="none",function f(){o.readyState==4?d(n):setTimeout(f,10)}()):o.parentNode.removeChild(o))}function d(n){var o=a.get(n);if(o){for(var f in o)typeof o[f]=="function"&&(o[f]=null);o.parentNode.removeChild(o)}}function h(n){var o=this,f;n=m.extend({swf_url:c.swf_url},n),e.call(this,n,l,{access_binary:function(s){return s&&o.mode==="browser"},access_image_binary:function(s){return s&&o.mode==="browser"},display_media:e.capTest(Z("moxie/image/Image")),do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return o.mode==="client"},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(s){return s==="json"&&window.JSON?!0:!m.arrayDiff(s,["","text","document"])||o.mode==="browser"},return_status_code:function(s){return o.mode==="browser"||!m.arrayDiff(s,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:function(s){return s&&o.mode==="browser"},send_browser_cookies:function(s){return s&&o.mode==="browser"},send_custom_headers:function(s){return s&&o.mode==="browser"},send_multipart:e.capTrue,slice_blob:function(s){return s&&o.mode==="browser"},stream_upload:function(s){return s&&o.mode==="browser"},summon_file_dialog:!1,upload_filesize:function(s){return m.parseSizeStr(s)<=2097152||o.mode==="client"},use_http_method:function(s){return!m.arrayDiff(s,["GET","POST"])}},{access_binary:function(s){return s?"browser":"client"},access_image_binary:function(s){return s?"browser":"client"},report_upload_progress:function(s){return s?"browser":"client"},return_response_type:function(s){return m.arrayDiff(s,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(s){return m.arrayDiff(s,[200,404])?"browser":["client","browser"]},send_binary_string:function(s){return s?"browser":"client"},send_browser_cookies:function(s){return s?"browser":"client"},send_custom_headers:function(s){return s?"browser":"client"},slice_blob:function(s){return s?"browser":"client"},stream_upload:function(s){return s?"client":"browser"},upload_filesize:function(s){return m.parseSizeStr(s)>=2097152?"client":"browser"}},"client"),r()<11.3&&(c.debug.runtime&&c.log("	Flash didn't meet minimal version requirement (11.3)."),this.mode=!1),m.extend(this,{getShim:function(){return a.get(this.uid)},shimExec:function(s,p){var g=[].slice.call(arguments,2);return o.getShim().exec(this.uid,s,p,g)},init:function(){var s,p,g;g=this.getShimContainer(),m.extend(g.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),s='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+n.swf_url+'" ',c.browser==="IE"&&(s+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),s+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.getGlobalEventTarget()+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',c.browser==="IE"?(p=document.createElement("div"),g.appendChild(p),p.outerHTML=s,p=g=null):g.innerHTML=s,f=setTimeout(function(){o&&!o.initialized&&(o.trigger("Error",new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR)),c.debug.runtime&&c.log("	Flash failed to initialize within a specified period of time (typically 5s)."))},5e3)},destroy:function(s){return function(){t(o.uid),s.call(o),clearTimeout(f),n=f=s=o=null}}(this.destroy)},i)}return e.addConstructor(l,h),i}),z("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(m,c){var a={slice:function(u,e,l,i){var r=this.getRuntime();return e<0?e=Math.max(u.size+e,0):e>0&&(e=Math.min(e,u.size)),l<0?l=Math.max(u.size+l,0):l>0&&(l=Math.min(l,u.size)),u=r.shimExec.call(this,"Blob","slice",e,l,i||""),u&&(u=new c(r.uid,u)),u}};return m.Blob=a}),z("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(m,c,a,u){var e={init:function(l){var i=this,r=this.getRuntime(),t=a.get(l.browse_button);t&&(t.setAttribute("tabindex",-1),t=null),this.bind("Change",function(){var d=r.shimExec.call(i,"FileInput","getFiles");i.files=[],u.each(d,function(h){i.files.push(new c(r.uid,h))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{accept:l.accept,multiple:l.multiple}),this.trigger("ready")}};return m.FileInput=e}),z("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(m,c){function a(e,l){switch(l){case"readAsText":return c.atob(e,"utf8");case"readAsBinaryString":return c.atob(e);case"readAsDataURL":return e}return null}var u={read:function(e,l){var i=this;return i.result="",e==="readAsDataURL"&&(i.result="data:"+(l.type||"")+";base64,"),i.bind("Progress",function(r,t){t&&(i.result+=a(t,e))},999),i.getRuntime().shimExec.call(this,"FileReader","readAsBase64",l.uid)}};return m.FileReader=u}),z("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(m,c){function a(e,l){switch(l){case"readAsText":return c.atob(e,"utf8");case"readAsBinaryString":return c.atob(e);case"readAsDataURL":return e}return null}var u={read:function(e,l){var i,r=this.getRuntime();return i=r.shimExec.call(this,"FileReaderSync","readAsBase64",l.uid),i?(e==="readAsDataURL"&&(i="data:"+(l.type||"")+";base64,"+i),a(i,e,l.type)):null}};return m.FileReaderSync=u}),z("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(m,c){var a={getAsBlob:function(u){var e=this.getRuntime(),l=e.shimExec.call(this,"Transporter","getAsBlob",u);return l?new c(e.uid,l):null}};return m.Transporter=a}),z("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(m,c,a,u,e,l,i,r,t){var d={send:function(h,n){var o=this,f=o.getRuntime();function s(){h.transport=f.mode,f.shimExec.call(o,"XMLHttpRequest","send",h,n)}function p(y,x){f.shimExec.call(o,"XMLHttpRequest","appendBlob",y,x.uid),n=null,s()}function g(y,x){var E=new r;E.bind("TransportingComplete",function(){x(this.result)}),E.transport(y.getSource(),y.type,{ruid:f.uid})}if(c.isEmptyObj(h.headers)||c.each(h.headers,function(y,x){f.shimExec.call(o,"XMLHttpRequest","setRequestHeader",x,y.toString())}),n instanceof i){var w;if(n.each(function(y,x){y instanceof a?w=x:f.shimExec.call(o,"XMLHttpRequest","append",x,y)}),!n.hasBlob())n=null,s();else{var b=n.getBlob();b.isDetached()?g(b,function(y){b.destroy(),p(w,y)}):p(w,b)}}else n instanceof a?n.isDetached()?g(n,function(y){n.destroy(),n=y.uid,s()}):(n=n.uid,s()):s()},getResponse:function(h){var n,o,f=this.getRuntime();if(o=f.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob"),o){if(o=new u(f.uid,o),h==="blob")return o;try{if(n=new e,~c.inArray(h,["","text"]))return n.readAsText(o);if(h==="json"&&window.JSON)return JSON.parse(n.readAsText(o))}finally{o.destroy()}}return null},abort:function(h){var n=this.getRuntime();n.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return m.XMLHttpRequest=d}),z("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(m,c,a,u,e){var l={loadFromBlob:function(i){var r=this,t=r.getRuntime();function d(n){t.shimExec.call(r,"Image","loadFromBlob",n.uid),r=t=null}if(i.isDetached()){var h=new a;h.bind("TransportingComplete",function(){d(h.result.getSource())}),h.transport(i.getSource(),i.type,{ruid:t.uid})}else d(i.getSource())},loadFromImage:function(i){var r=this.getRuntime();return r.shimExec.call(this,"Image","loadFromImage",i.uid)},getInfo:function(){var i=this.getRuntime(),r=i.shimExec.call(this,"Image","getInfo");return r.meta&&r.meta.thumb&&r.meta.thumb.data&&!(i.meta.thumb.data instanceof u)&&(r.meta.thumb.data=new u(i.uid,r.meta.thumb.data)),r},getAsBlob:function(i,r){var t=this.getRuntime(),d=t.shimExec.call(this,"Image","getAsBlob",i,r);return d?new u(t.uid,d):null},getAsDataURL:function(){var i=this.getRuntime(),r=i.Image.getAsBlob.apply(this,arguments),t;return r?(t=new e,t.readAsDataURL(r)):null}};return m.Image=l}),z("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(m,c,a,u,e){var l="silverlight",i={};function r(d){var h=!1,n=null,o,f,s,p,g,w=0;try{try{n=new ActiveXObject("AgControl.AgControl"),n.IsVersionSupported(d)&&(h=!0),n=null}catch{var b=navigator.plugins["Silverlight Plug-In"];if(b){for(o=b.description,o==="1.0.30226.2"&&(o="2.0.30226.2"),f=o.split(".");f.length>3;)f.pop();for(;f.length<4;)f.push(0);for(s=d.split(".");s.length>4;)s.pop();do p=parseInt(s[w],10),g=parseInt(f[w],10),w++;while(w<s.length&&p===g);p<=g&&!isNaN(p)&&(h=!0)}}}catch{h=!1}return h}function t(d){var h=this,n;d=m.extend({xap_url:c.xap_url},d),e.call(this,d,l,{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTest(Z("moxie/image/Image")),do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(o){return o&&h.mode==="client"},return_response_type:function(o){return o!=="json"?!0:!!window.JSON},return_status_code:function(o){return h.mode==="client"||!m.arrayDiff(o,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(o){return o&&h.mode==="browser"},send_custom_headers:function(o){return o&&h.mode==="client"},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(o){return h.mode==="client"||!m.arrayDiff(o,["GET","POST"])}},{return_response_headers:function(o){return o?"client":"browser"},return_status_code:function(o){return m.arrayDiff(o,[200,404])?"client":["client","browser"]},send_browser_cookies:function(o){return o?"browser":"client"},send_custom_headers:function(o){return o?"client":"browser"},use_http_method:function(o){return m.arrayDiff(o,["GET","POST"])?"client":["client","browser"]}}),(!r("2.0.31005.0")||c.browser==="Opera")&&(c.debug.runtime&&c.log("	Silverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely)."),this.mode=!1),m.extend(this,{getShim:function(){return a.get(this.uid).content.Moxie},shimExec:function(o,f){var s=[].slice.call(arguments,2);return h.getShim().exec(this.uid,o,f,s)},init:function(){var o;o=this.getShimContainer(),o.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+d.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.getGlobalEventTarget()+'"/></object>',n=setTimeout(function(){h&&!h.initialized&&(h.trigger("Error",new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR)),c.debug.runtime&&c.log("Silverlight failed to initialize within a specified period of time (5-10s)."))},c.OS!=="Windows"?1e4:5e3)},destroy:function(o){return function(){o.call(h),clearTimeout(n),d=n=o=h=null}}(this.destroy)},i)}return e.addConstructor(l,t),i}),z("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(m,c,a){return m.Blob=c.extend({},a)}),z("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(m,c,a,u){function e(i){for(var r="",t=0;t<i.length;t++)r+=(r!==""?"|":"")+i[t].title+" | *."+i[t].extensions.replace(/,/g,";*.");return r}var l={init:function(i){var r=this,t=this.getRuntime(),d=a.get(i.browse_button);d&&(d.setAttribute("tabindex",-1),d=null),this.bind("Change",function(){var h=t.shimExec.call(r,"FileInput","getFiles");r.files=[],u.each(h,function(n){r.files.push(new c(t.uid,n))})},999),t.shimExec.call(this,"FileInput","init",e(i.accept),i.multiple),this.trigger("ready")},setOption:function(i,r){i=="accept"&&(r=e(r)),this.getRuntime().shimExec.call(this,"FileInput","setOption",i,r)}};return m.FileInput=l}),z("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(m,c,a){var u={init:function(){var e=this,l=e.getRuntime(),i;return i=l.getShimContainer(),a.addEvent(i,"dragover",function(r){r.preventDefault(),r.stopPropagation(),r.dataTransfer.dropEffect="copy"},e.uid),a.addEvent(i,"dragenter",function(r){r.preventDefault();var t=c.get(l.uid).dragEnter(r);t&&r.stopPropagation()},e.uid),a.addEvent(i,"drop",function(r){r.preventDefault();var t=c.get(l.uid).dragDrop(r);t&&r.stopPropagation()},e.uid),l.shimExec.call(this,"FileDrop","init")}};return m.FileDrop=u}),z("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(m,c,a){return m.FileReader=c.extend({},a)}),z("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(m,c,a){return m.FileReaderSync=c.extend({},a)}),z("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(m,c,a){return m.Transporter=c.extend({},a)}),z("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(m,c,a,u,e){return m.XMLHttpRequest=c.extend({},a)}),z("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(m,c,a,u){return m.Image=c.extend({},u,{getInfo:function(){var e=this.getRuntime(),l=["tiff","exif","gps","thumb"],i={meta:{}},r=e.shimExec.call(this,"Image","getInfo");return r.meta&&(c.each(l,function(t){var d=r.meta[t],h,n,o,f;if(d&&d.keys)for(i.meta[t]={},n=0,o=d.keys.length;n<o;n++)h=d.keys[n],f=d[h],f&&(/^(\d|[1-9]\d+)$/.test(f)?f=parseInt(f,10):/^\d*\.\d+$/.test(f)&&(f=parseFloat(f)),i.meta[t][h]=f)}),i.meta&&i.meta.thumb&&i.meta.thumb.data&&!(e.meta.thumb.data instanceof a)&&(i.meta.thumb.data=new a(e.uid,i.meta.thumb.data))),i.width=parseInt(r.width,10),i.height=parseInt(r.height,10),i.size=parseInt(r.size,10),i.type=r.type,i.name=r.name,i},resize:function(e,l,i){this.getRuntime().shimExec.call(this,"Image","resize",e.x,e.y,e.width,e.height,l,i.preserveHeaders,i.resample)}})}),z("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(m,c,a,u){var e="html4",l={};function i(r){var t=this,d=a.capTest,h=a.capTrue;a.call(this,r,e,{access_binary:d(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:d((u.can("create_canvas")||u.can("use_data_uri_over32kb"))&&Z("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:d(function(){return!(u.browser==="Chrome"&&u.verComp(u.version,28,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<")||u.browser==="Safari"&&u.verComp(u.version,7,"<")||u.browser==="Firefox"&&u.verComp(u.version,37,"<"))}()),resize_image:function(){return l.Image&&t.can("access_binary")&&u.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(n){return n==="json"&&window.JSON?!0:!!~m.inArray(n,["text","document",""])},return_status_code:function(n){return!m.arrayDiff(n,[200,404])},select_file:function(){return u.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return t.can("select_file")},summon_file_dialog:function(){return t.can("select_file")&&!(u.browser==="Firefox"&&u.verComp(u.version,4,"<")||u.browser==="Opera"&&u.verComp(u.version,12,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<"))},upload_filesize:h,use_http_method:function(n){return!m.arrayDiff(n,["GET","POST"])}}),m.extend(this,{init:function(){this.trigger("Init")},destroy:function(n){return function(){n.call(t),n=t=null}}(this.destroy)}),m.extend(this.getShim(),l)}return a.addConstructor(e,i),l}),z("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i){function r(){var t,d=[],h,n;function o(){var f=this,s=f.getRuntime(),p,g,w,b,y,x;x=a.guid("uid_"),p=s.getShimContainer(),t&&(w=u.get(t+"_form"),w&&(a.extend(w.style,{top:"100%"}),w.firstChild.setAttribute("tabindex",-1))),b=document.createElement("form"),b.setAttribute("id",x+"_form"),b.setAttribute("method","post"),b.setAttribute("enctype","multipart/form-data"),b.setAttribute("encoding","multipart/form-data"),a.extend(b.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),y=document.createElement("input"),y.setAttribute("id",x),y.setAttribute("type","file"),y.setAttribute("accept",d.join(",")),s.can("summon_file_dialog")&&y.setAttribute("tabindex",-1),a.extend(y.style,{fontSize:"999px",opacity:0}),b.appendChild(y),p.appendChild(b),a.extend(y.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),i.browser==="IE"&&i.verComp(i.version,10,"<")&&a.extend(y.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),y.onchange=function(){var E;this.value&&(this.files?E=this.files[0]:E={name:this.value},E=new c(s.uid,E),this.onchange=function(){},o.call(f),f.files=[E],y.setAttribute("id",E.uid),b.setAttribute("id",E.uid+"_form"),f.trigger("change"),y=b=null)},s.can("summon_file_dialog")&&(g=u.get(h.browse_button),e.removeEvent(g,"click",f.uid),e.addEvent(g,"click",function(E){y&&!y.disabled&&y.click(),E.preventDefault()},f.uid)),t=x,p=w=g=null}a.extend(this,{init:function(f){var s=this,p=s.getRuntime(),g;h=f,d=l.extList2mimes(f.accept,p.can("filter_by_extension")),g=p.getShimContainer(),function(){var w,b,y;w=u.get(f.browse_button),n=u.getStyle(w,"z-index")||"auto",p.can("summon_file_dialog")?(u.getStyle(w,"position")==="static"&&(w.style.position="relative"),s.bind("Refresh",function(){b=parseInt(n,10)||1,u.get(h.browse_button).style.zIndex=b,this.getRuntime().getShimContainer().style.zIndex=b-1})):w.setAttribute("tabindex",-1),y=p.can("summon_file_dialog")?w:g,e.addEvent(y,"mouseover",function(){s.trigger("mouseenter")},s.uid),e.addEvent(y,"mouseout",function(){s.trigger("mouseleave")},s.uid),e.addEvent(y,"mousedown",function(){s.trigger("mousedown")},s.uid),e.addEvent(u.get(f.container),"mouseup",function(){s.trigger("mouseup")},s.uid),w=null}(),o.call(this),g=null,s.trigger({type:"ready",async:!0})},setOption:function(f,s){var p=this.getRuntime(),g;f=="accept"&&(d=s.mimes||l.extList2mimes(s,p.can("filter_by_extension"))),g=u.get(t),g&&g.setAttribute("accept",d.join(","))},disable:function(f){var s;(s=u.get(t))&&(s.disabled=!!f)},destroy:function(){var f=this.getRuntime(),s=f.getShim(),p=f.getShimContainer(),g=h&&u.get(h.container),w=h&&u.get(h.browse_button);g&&e.removeAllEvents(g,this.uid),w&&(e.removeAllEvents(w,this.uid),w.style.zIndex=n),p&&(e.removeAllEvents(p,this.uid),p.innerHTML=""),s.removeInstance(this.uid),t=d=h=p=g=w=s=null}})}return m.FileInput=r}),z("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(m,c){return m.FileReader=c}),z("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(m,c,a,u,e,l,i,r){function t(){var d,h,n;function o(f){var s=this,p,g,w,b,y=!1;if(n){if(p=n.id.replace(/_iframe$/,""),g=a.get(p+"_form"),g){for(w=g.getElementsByTagName("input"),b=w.length;b--;)switch(w[b].getAttribute("type")){case"hidden":w[b].parentNode.removeChild(w[b]);break;case"file":y=!0;break}w=[],y||g.parentNode.removeChild(g),g=null}setTimeout(function(){l.removeEvent(n,"load",s.uid),n.parentNode&&n.parentNode.removeChild(n);var x=s.getRuntime().getShimContainer();x.children.length||x.parentNode.removeChild(x),x=n=null,f()},1)}}c.extend(this,{send:function(f,s){var p=this,g=p.getRuntime(),w,b,y,x;d=h=null;function E(){var v=g.getShimContainer()||document.body,R=document.createElement("div");R.innerHTML='<iframe id="'+w+'_iframe" name="'+w+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',n=R.firstChild,v.appendChild(n),l.addEvent(n,"load",function(){var _;try{_=n.contentWindow.document||n.contentDocument||window.frames[n.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(_.title)?d=_.title.replace(/^(\d+).*$/,"$1"):(d=200,h=c.trim(_.body.innerHTML),p.trigger({type:"progress",loaded:h.length,total:h.length}),x&&p.trigger({type:"uploadprogress",loaded:x.size||1025,total:x.size||1025}))}catch{if(u.hasSameOrigin(f.url))d=404;else{o.call(p,function(){p.trigger("error")});return}}o.call(p,function(){p.trigger("load")})},p.uid)}if(s instanceof r&&s.hasBlob()){if(x=s.getBlob(),w=x.uid,y=a.get(w),b=a.get(w+"_form"),!b)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else w=c.guid("uid_"),b=document.createElement("form"),b.setAttribute("id",w+"_form"),b.setAttribute("method",f.method),b.setAttribute("enctype","multipart/form-data"),b.setAttribute("encoding","multipart/form-data"),g.getShimContainer().appendChild(b);b.setAttribute("target",w+"_iframe"),s instanceof r&&s.each(function(v,R){if(v instanceof i)y&&y.setAttribute("name",R);else{var _=document.createElement("input");c.extend(_,{type:"hidden",name:R,value:v}),y?b.insertBefore(_,y):b.appendChild(_)}}),b.setAttribute("action",f.url),E(),b.submit(),p.trigger("loadstart")},getStatus:function(){return d},getResponse:function(f){if(f==="json"&&c.typeOf(h)==="string"&&window.JSON)try{return JSON.parse(h.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch{return null}return h},abort:function(){var f=this;n&&n.contentWindow&&(n.contentWindow.stop?n.contentWindow.stop():n.contentWindow.document.execCommand?n.contentWindow.document.execCommand("Stop"):n.src="about:blank"),o.call(this,function(){f.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}return m.XMLHttpRequest=t}),z("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(m,c){return m.Image=c}),Y(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])})(this)})}(ie)),ie.exports}(function(K){(function($,J){var W=function(){var P={};return J.apply(P,arguments),P.moxie};K.exports?K.exports=W():$.moxie=W()})(re||window,function(){(function($,J){function W(m,c){for(var a,u=[],e=0;e<m.length;++e){if(a=Y[m[e]]||Z(m[e]),!a)throw"module definition dependecy not found: "+m[e];u.push(a)}c.apply(null,u)}function P(m,c,a){if(typeof m!="string")throw"invalid module definition, module id must be defined and be a string";if(c===J)throw"invalid module definition, dependencies must be specified";if(a===J)throw"invalid module definition, definition function must be specified";W(c,function(){Y[m]=a.apply(null,arguments)})}function z(m){return!!Y[m]}function Z(m){for(var c=$,a=m.split(/[.\/]/),u=0;u<a.length;++u){if(!c[a[u]])return;c=c[a[u]]}return c}function Q(m){for(var c=0;c<m.length;c++){for(var a=$,u=m[c],e=u.split(/[.\/]/),l=0;l<e.length-1;++l)a[e[l]]===J&&(a[e[l]]={}),a=a[e[l]];a[e[e.length-1]]=Y[u]}}var Y={};P("moxie/core/utils/Basic",[],function(){function m(v){var R;return v===R?"undefined":v===null?"null":v.nodeType?"node":{}.toString.call(v).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function c(){return r(!1,!1,arguments)}function a(){return r(!0,!1,arguments)}function u(){return r(!1,!0,arguments)}function e(){return r(!0,!0,arguments)}function l(v){switch(m(v)){case"array":return r(!1,!0,[[],v]);case"object":return r(!1,!0,[{},v]);default:return v}}function i(v){switch(m(v)){case"array":return Array.prototype.slice.call(v);case"object":return c({},v)}return v}function r(v,R,_){var A,S=_[0];return d(_,function(O,F){F>0&&d(O,function(I,T){var C=f(m(I),["array","object"])!==-1;return I===A||v&&S[T]===A?!0:(C&&R&&(I=i(I)),m(S[T])===m(I)&&C?r(v,R,[S[T],I]):S[T]=I,void 0)})}),S}function t(v,R){function _(){this.constructor=v}for(var A in R)({}).hasOwnProperty.call(R,A)&&(v[A]=R[A]);return _.prototype=R.prototype,v.prototype=new _,v.parent=R.prototype,v}function d(v,R){var _,A,S,O;if(v){try{_=v.length}catch{_=O}if(_===O||typeof _!="number"){for(A in v)if(v.hasOwnProperty(A)&&R(v[A],A)===!1)return}else for(S=0;_>S;S++)if(R(v[S],S)===!1)return}}function h(v){var R;if(!v||m(v)!=="object")return!0;for(R in v)return!1;return!0}function n(v,R){function _(O){m(v[O])==="function"&&v[O](function(F){++O<S&&!F?_(O):R(F)})}var A=0,S=v.length;m(R)!=="function"&&(R=function(){}),v&&v.length||R(),_(A)}function o(v,R){var _=0,A=v.length,S=new Array(A);d(v,function(O,F){O(function(I){if(I)return R(I);var T=[].slice.call(arguments);T.shift(),S[F]=T,_++,_===A&&(S.unshift(null),R.apply(this,S))})})}function f(v,R){if(R){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(R,v);for(var _=0,A=R.length;A>_;_++)if(R[_]===v)return _}return-1}function s(v,R){var _=[];m(v)!=="array"&&(v=[v]),m(R)!=="array"&&(R=[R]);for(var A in v)f(v[A],R)===-1&&_.push(v[A]);return _.length?_:!1}function p(v,R){var _=[];return d(v,function(A){f(A,R)!==-1&&_.push(A)}),_.length?_:null}function g(v){var R,_=[];for(R=0;R<v.length;R++)_[R]=v[R];return _}function w(v){return v&&(String.prototype.trim?String.prototype.trim.call(v):v.toString().replace(/^\s*/,"").replace(/\s*$/,""))}function b(v){if(typeof v!="string")return v;var R,_={t:1099511627776,g:1073741824,m:1048576,k:1024};return v=/^([0-9\.]+)([tmgk]?)$/.exec(v.toLowerCase().replace(/[^0-9\.tmkg]/g,"")),R=v[2],v=+v[1],_.hasOwnProperty(R)&&(v*=_[R]),Math.floor(v)}function y(v){var R=[].slice.call(arguments,1);return v.replace(/%([a-z])/g,function(_,A){var S=R.shift();switch(A){case"s":return S+"";case"d":return parseInt(S,10);case"f":return parseFloat(S);case"c":return"";default:return S}})}function x(v,R){var _=this;setTimeout(function(){v.call(_)},R||1)}var E=function(){var v=0;return function(R){var _,A=new Date().getTime().toString(32);for(_=0;5>_;_++)A+=Math.floor(65535*Math.random()).toString(32);return(R||"o_")+A+(v++).toString(32)}}();return{guid:E,typeOf:m,extend:c,extendIf:a,extendImmutable:u,extendImmutableIf:e,clone:l,inherit:t,each:d,isEmptyObj:h,inSeries:n,inParallel:o,inArray:f,arrayDiff:s,arrayIntersect:p,toArray:g,trim:w,sprintf:y,parseSizeStr:b,delay:x}}),P("moxie/core/utils/Encode",[],function(){var m=function(e){return unescape(encodeURIComponent(e))},c=function(e){return decodeURIComponent(escape(e))},a=function(e,l){if(typeof window.atob=="function")return l?c(window.atob(e)):window.atob(e);var i,r,t,d,h,n,o,f,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,g=0,w="",b=[];if(!e)return e;e+="";do d=s.indexOf(e.charAt(p++)),h=s.indexOf(e.charAt(p++)),n=s.indexOf(e.charAt(p++)),o=s.indexOf(e.charAt(p++)),f=d<<18|h<<12|n<<6|o,i=255&f>>16,r=255&f>>8,t=255&f,b[g++]=n==64?String.fromCharCode(i):o==64?String.fromCharCode(i,r):String.fromCharCode(i,r,t);while(p<e.length);return w=b.join(""),l?c(w):w},u=function(e,l){if(l&&(e=m(e)),typeof window.btoa=="function")return window.btoa(e);var i,r,t,d,h,n,o,f,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p=0,g=0,w="",b=[];if(!e)return e;do i=e.charCodeAt(p++),r=e.charCodeAt(p++),t=e.charCodeAt(p++),f=i<<16|r<<8|t,d=63&f>>18,h=63&f>>12,n=63&f>>6,o=63&f,b[g++]=s.charAt(d)+s.charAt(h)+s.charAt(n)+s.charAt(o);while(p<e.length);w=b.join("");var y=e.length%3;return(y?w.slice(0,y-3):w)+"===".slice(y||3)};return{utf8_encode:m,utf8_decode:c,atob:a,btoa:u}}),P("moxie/core/utils/Env",["moxie/core/utils/Basic"],function(m){function c(i,r,t){var d=0,h=0,n=0,o={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},f=function(p){return p=(""+p).replace(/[_\-+]/g,"."),p=p.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),p.length?p.split("."):[-8]},s=function(p){return p?isNaN(p)?o[p]||-7:parseInt(p,10):0};for(i=f(i),r=f(r),h=Math.max(i.length,r.length),d=0;h>d;d++)if(i[d]!=r[d]){if(i[d]=s(i[d]),r[d]=s(r[d]),i[d]<r[d]){n=-1;break}if(i[d]>r[d]){n=1;break}}if(!t)return n;switch(t){case">":case"gt":return n>0;case">=":case"ge":return n>=0;case"<=":case"le":return 0>=n;case"==":case"=":case"eq":return n===0;case"<>":case"!=":case"ne":return n!==0;case"":case"<":case"lt":return 0>n;default:return null}}var a=function(i){var r="",t="?",d="function",h="undefined",n="object",o="name",f="version",s={has:function(y,x){return x.toLowerCase().indexOf(y.toLowerCase())!==-1},lowerize:function(y){return y.toLowerCase()}},p={rgx:function(){for(var y,x,E,v,R,_,A,S=0,O=arguments;S<O.length;S+=2){var F=O[S],I=O[S+1];if(typeof y===h){y={};for(v in I)R=I[v],typeof R===n?y[R[0]]=i:y[R]=i}for(x=E=0;x<F.length;x++)if(_=F[x].exec(this.getUA())){for(v=0;v<I.length;v++)A=_[++E],R=I[v],typeof R===n&&R.length>0?R.length==2?y[R[0]]=typeof R[1]==d?R[1].call(this,A):R[1]:R.length==3?y[R[0]]=typeof R[1]!==d||R[1].exec&&R[1].test?A?A.replace(R[1],R[2]):i:A?R[1].call(this,A,R[2]):i:R.length==4&&(y[R[0]]=A?R[3].call(this,A.replace(R[1],R[2])):i):y[R]=A||i;break}if(_)break}return y},str:function(y,x){for(var E in x)if(typeof x[E]===n&&x[E].length>0){for(var v=0;v<x[E].length;v++)if(s.has(x[E][v],y))return E===t?i:E}else if(s.has(x[E],y))return E===t?i:E;return y}},g={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},w={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[o,f],[/\s(opr)\/([\w\.]+)/i],[[o,"Opera"],f],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[o,f],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[o,"IE"],f],[/(edge)\/((\d+)?[\w\.]+)/i],[o,f],[/(yabrowser)\/([\w\.]+)/i],[[o,"Yandex"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[o,/_/g," "],f],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[o,f],[/(dolfin)\/([\w\.]+)/i],[[o,"Dolphin"],f],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[o,"Chrome"],f],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[f,[o,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[f,[o,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[f,[o,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[f,[o,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[f,o],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[o,[f,p.str,g.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[o,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[o,"Netscape"],f],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[o,f]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[o,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[o,f],[/rv\:([\w\.]+).*(gecko)/i],[f,o]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[o,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[o,[f,p.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[o,"Windows"],[f,p.str,g.os.windows.version]],[/\((bb)(10);/i],[[o,"BlackBerry"],f],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[o,f],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[o,"Symbian"],f],[/\((series40);/i],[o],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[o,"Firefox OS"],f],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[o,f],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[o,"Chromium OS"],f],[/(sunos)\s?([\w\.]+\d)*/i],[[o,"Solaris"],f],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[o,f],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[o,"iOS"],[f,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[o,"Mac OS"],[f,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[o,f]]},b=function(y){var x=y||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:r);this.getBrowser=function(){return p.rgx.apply(this,w.browser)},this.getEngine=function(){return p.rgx.apply(this,w.engine)},this.getOS=function(){return p.rgx.apply(this,w.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return x},this.setUA=function(E){return x=E,this},this.setUA(x)};return b}(),u=function(){var i={access_global_ns:function(){return!!window.moxie},define_property:function(){return!1}(),create_canvas:function(){var r=document.createElement("canvas"),t=!(!r.getContext||!r.getContext("2d"));return i.create_canvas=t,t},return_response_type:function(r){try{if(m.inArray(r,["","text","document"])!==-1)return!0;if(window.XMLHttpRequest){var t=new XMLHttpRequest;if(t.open("get","/"),"responseType"in t)return t.responseType=r,t.responseType===r}}catch{}return!1},use_blob_uri:function(){var r=window.URL;return i.use_blob_uri=r&&"createObjectURL"in r&&"revokeObjectURL"in r&&(l.browser!=="IE"||l.verComp(l.version,"11.0.46",">=")),i.use_blob_uri},use_data_uri:function(){var r=new Image;return r.onload=function(){i.use_data_uri=r.width===1&&r.height===1},setTimeout(function(){r.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return i.use_data_uri&&(l.browser!=="IE"||l.version>=9)},use_data_uri_of:function(r){return i.use_data_uri&&33e3>r||i.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;var r=document.createElement("input");return r.setAttribute("type","file"),i.use_fileinput=!r.disabled},use_webgl:function(){var r,t=document.createElement("canvas"),d=null;try{d=t.getContext("webgl")||t.getContext("experimental-webgl")}catch{}return d||(d=null),r=!!d,i.use_webgl=r,t=J,r}};return function(r){var t=[].slice.call(arguments);return t.shift(),m.typeOf(i[r])==="function"?i[r].apply(this,t):!!i[r]}}(),e=new a().getResult(),l={can:u,uaParser:a,browser:e.browser.name,version:e.browser.version,os:e.os.name,osVersion:e.os.version,verComp:c,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return l.OS=l.os,l}),P("moxie/core/Exceptions",["moxie/core/utils/Basic"],function(m){function c(a,u){var e;for(e in a)if(a[e]===u)return e;return null}return{RuntimeError:function(){function a(e,l){this.code=e,this.name=c(u,e),this.message=this.name+(l||": RuntimeError "+this.code)}var u={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};return m.extend(a,u),a.prototype=Error.prototype,a}(),OperationNotAllowedException:function(){function a(u){this.code=u,this.name="OperationNotAllowedException"}return m.extend(a,{NOT_ALLOWED_ERR:1}),a.prototype=Error.prototype,a}(),ImageError:function(){function a(e){this.code=e,this.name=c(u,e),this.message=this.name+": ImageError "+this.code}var u={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};return m.extend(a,u),a.prototype=Error.prototype,a}(),FileException:function(){function a(e){this.code=e,this.name=c(u,e),this.message=this.name+": FileException "+this.code}var u={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return m.extend(a,u),a.prototype=Error.prototype,a}(),DOMException:function(){function a(e){this.code=e,this.name=c(u,e),this.message=this.name+": DOMException "+this.code}var u={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return m.extend(a,u),a.prototype=Error.prototype,a}(),EventException:function(){function a(u){this.code=u,this.name="EventException"}return m.extend(a,{UNSPECIFIED_EVENT_TYPE_ERR:0}),a.prototype=Error.prototype,a}()}}),P("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(m){var c=function(t){return typeof t!="string"?t:document.getElementById(t)},a=function(t,d){if(!t.className)return!1;var h=new RegExp("(^|\\s+)"+d+"(\\s+|$)");return h.test(t.className)},u=function(t,d){a(t,d)||(t.className=t.className?t.className.replace(/\s+$/,"")+" "+d:d)},e=function(t,d){if(t.className){var h=new RegExp("(^|\\s+)"+d+"(\\s+|$)");t.className=t.className.replace(h,function(n,o,f){return o===" "&&f===" "?" ":""})}},l=function(t,d){return t.currentStyle?t.currentStyle[d]:window.getComputedStyle?window.getComputedStyle(t,null)[d]:void 0},i=function(t,d){function h(w){var b,y,x=0,E=0;return w&&(y=w.getBoundingClientRect(),b=g.compatMode==="CSS1Compat"?g.documentElement:g.body,x=y.left+b.scrollLeft,E=y.top+b.scrollTop),{x,y:E}}var n,o,f,s=0,p=0,g=document;if(t=t,d=d||g.body,t&&t.getBoundingClientRect&&m.browser==="IE"&&(!g.documentMode||g.documentMode<8))return o=h(t),f=h(d),{x:o.x-f.x,y:o.y-f.y};for(n=t;n&&n!=d&&n.nodeType;)s+=n.offsetLeft||0,p+=n.offsetTop||0,n=n.offsetParent;for(n=t.parentNode;n&&n!=d&&n.nodeType;)s-=n.scrollLeft||0,p-=n.scrollTop||0,n=n.parentNode;return{x:s,y:p}},r=function(t){return{w:t.offsetWidth||t.clientWidth,h:t.offsetHeight||t.clientHeight}};return{get:c,hasClass:a,addClass:u,removeClass:e,getStyle:l,getPos:i,getSize:r}}),P("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(m,c,a){function u(){this.uid=a.guid()}var e={};return a.extend(u.prototype,{init:function(){this.uid||(this.uid=a.guid("uid_"))},addEventListener:function(l,i,r,t){var d,h=this;return this.hasOwnProperty("uid")||(this.uid=a.guid("uid_")),l=a.trim(l),/\s/.test(l)?(a.each(l.split(/\s+/),function(n){h.addEventListener(n,i,r,t)}),void 0):(l=l.toLowerCase(),r=parseInt(r,10)||0,d=e[this.uid]&&e[this.uid][l]||[],d.push({fn:i,priority:r,scope:t||this}),e[this.uid]||(e[this.uid]={}),e[this.uid][l]=d,void 0)},hasEventListener:function(l){var i;return l?(l=l.toLowerCase(),i=e[this.uid]&&e[this.uid][l]):i=e[this.uid],i||!1},removeEventListener:function(l,i){var r,t,d=this;if(l=l.toLowerCase(),/\s/.test(l))return a.each(l.split(/\s+/),function(h){d.removeEventListener(h,i)}),void 0;if(r=e[this.uid]&&e[this.uid][l]){if(i){for(t=r.length-1;t>=0;t--)if(r[t].fn===i){r.splice(t,1);break}}else r=[];r.length||(delete e[this.uid][l],a.isEmptyObj(e[this.uid])&&delete e[this.uid])}},removeAllEventListeners:function(){e[this.uid]&&delete e[this.uid]},dispatchEvent:function(l){var i,r,t,d,h,n={},o=!0;if(a.typeOf(l)!=="string"){if(d=l,a.typeOf(d.type)!=="string")throw new c.EventException(c.EventException.UNSPECIFIED_EVENT_TYPE_ERR);l=d.type,d.total!==h&&d.loaded!==h&&(n.total=d.total,n.loaded=d.loaded),n.async=d.async||!1}if(l.indexOf("::")!==-1?function(s){i=s[0],l=s[1]}(l.split("::")):i=this.uid,l=l.toLowerCase(),r=e[i]&&e[i][l]){r.sort(function(s,p){return p.priority-s.priority}),t=[].slice.call(arguments),t.shift(),n.type=l,t.unshift(n);var f=[];a.each(r,function(s){t[0].target=s.scope,n.async?f.push(function(p){setTimeout(function(){p(s.fn.apply(s.scope,t)===!1)},1)}):f.push(function(p){p(s.fn.apply(s.scope,t)===!1)})}),f.length&&a.inSeries(f,function(s){o=!s})}return o},bindOnce:function(l,i,r,t){var d=this;d.bind.call(this,l,function h(){return d.unbind(l,h),i.apply(this,arguments)},r,t)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(l){var i=this;this.bind(l.join(" "),function(r){var t="on"+r.type.toLowerCase();a.typeOf(this[t])==="function"&&this[t].apply(this,arguments)}),a.each(l,function(r){r="on"+r.toLowerCase(r),a.typeOf(i[r])==="undefined"&&(i[r]=null)})}}),u.instance=new u,u}),P("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(m,c,a,u){function e(r,t,d,h,n){var o,f=this,s=c.guid(t+"_"),p=n||"browser";r=r||{},i[s]=this,d=c.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},d),r.preferred_caps&&(p=e.getMode(h,r.preferred_caps,p)),o=function(){var g={};return{exec:function(w,b,y,x){return o[b]&&(g[w]||(g[w]={context:this,instance:new o[b]}),g[w].instance[y])?g[w].instance[y].apply(this,x):void 0},removeInstance:function(w){delete g[w]},removeAllInstances:function(){var w=this;c.each(g,function(b,y){c.typeOf(b.instance.destroy)==="function"&&b.instance.destroy.call(b.context),w.removeInstance(y)})}}}(),c.extend(this,{initialized:!1,uid:s,type:t,mode:e.getMode(h,r.required_caps,p),shimid:s+"_container",clients:0,options:r,can:function(g,w){var b=arguments[2]||d;if(c.typeOf(g)==="string"&&c.typeOf(w)==="undefined"&&(g=e.parseCaps(g)),c.typeOf(g)==="object"){for(var y in g)if(!this.can(y,g[y],b))return!1;return!0}return c.typeOf(b[g])==="function"?b[g].call(this,w):w===b[g]},getShimContainer:function(){var g,w=a.get(this.shimid);return w||(g=a.get(this.options.container)||document.body,w=document.createElement("div"),w.id=this.shimid,w.className="moxie-shim moxie-shim-"+this.type,c.extend(w.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),g.appendChild(w),g=null),w},getShim:function(){return o},shimExec:function(g,w){var b=[].slice.call(arguments,2);return f.getShim().exec.call(this,this.uid,g,w,b)},exec:function(g,w){var b=[].slice.call(arguments,2);return f[g]&&f[g][w]?f[g][w].apply(this,b):f.shimExec.apply(this,arguments)},destroy:function(){if(f){var g=a.get(this.shimid);g&&g.parentNode.removeChild(g),o&&o.removeAllInstances(),this.unbindAll(),delete i[this.uid],this.uid=null,s=f=o=g=null}}}),this.mode&&r.required_caps&&!this.can(r.required_caps)&&(this.mode=!1)}var l={},i={};return e.order="html5,flash,silverlight,html4",e.getRuntime=function(r){return i[r]?i[r]:!1},e.addConstructor=function(r,t){t.prototype=u.instance,l[r]=t},e.getConstructor=function(r){return l[r]||null},e.getInfo=function(r){var t=e.getRuntime(r);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},e.parseCaps=function(r){var t={};return c.typeOf(r)!=="string"?r||{}:(c.each(r.split(","),function(d){t[d]=!0}),t)},e.can=function(r,t){var d,h,n=e.getConstructor(r);return n?(d=new n({required_caps:t}),h=d.mode,d.destroy(),!!h):!1},e.thatCan=function(r,t){var d=(t||e.order).split(/\s*,\s*/);for(var h in d)if(e.can(d[h],r))return d[h];return null},e.getMode=function(r,t,d){var h=null;if(c.typeOf(d)==="undefined"&&(d="browser"),t&&!c.isEmptyObj(r)){if(c.each(t,function(n,o){if(r.hasOwnProperty(o)){var f=r[o](n);if(typeof f=="string"&&(f=[f]),h){if(!(h=c.arrayIntersect(h,f)))return h=!1}else h=f}}),h)return c.inArray(d,h)!==-1?d:h[0];if(h===!1)return!1}return d},e.getGlobalEventTarget=function(){if(/^moxie\./.test(m.global_event_dispatcher)&&!m.can("access_global_ns")){var r=c.guid("moxie_event_target_");window[r]=function(t,d){u.instance.dispatchEvent(t,d)},m.global_event_dispatcher=r}return m.global_event_dispatcher},e.capTrue=function(){return!0},e.capFalse=function(){return!1},e.capTest=function(r){return function(){return!!r}},e}),P("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(m,c,a,u){return function(){var e;a.extend(this,{connectRuntime:function(l){function i(d){var h,n;return d.length?(h=d.shift().toLowerCase(),(n=u.getConstructor(h))?(e=new n(l),e.bind("Init",function(){e.initialized=!0,setTimeout(function(){e.clients++,t.ruid=e.uid,t.trigger("RuntimeInit",e)},1)}),e.bind("Error",function(){e.destroy(),i(d)}),e.bind("Exception",function(o,f){var s=f.name+"(#"+f.code+")"+(f.message?", from: "+f.message:"");t.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.EXCEPTION_ERR,s))}),e.mode?(e.init(),void 0):(e.trigger("Error"),void 0)):(i(d),void 0)):(t.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)),e=null,void 0)}var r,t=this;if(a.typeOf(l)==="string"?r=l:a.typeOf(l.ruid)==="string"&&(r=l.ruid),r){if(e=u.getRuntime(r))return t.ruid=r,e.clients++,e;throw new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)}i((l.runtime_order||u.order).split(/\s*,\s*/))},disconnectRuntime:function(){e&&--e.clients<=0&&e.destroy(),e=null},getRuntime:function(){return e&&e.uid?e:e=null},exec:function(){return e?e.exec.apply(this,arguments):null},can:function(l){return e?e.can(l):!1}})}}),P("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(m,c,a){function u(l,i){function r(t,d,h){var n,o=e[this.uid];return m.typeOf(o)==="string"&&o.length?(n=new u(null,{type:h,size:d-t}),n.detach(o.substr(t,n.size)),n):null}a.call(this),l&&this.connectRuntime(l),i?m.typeOf(i)==="string"&&(i={data:i}):i={},m.extend(this,{uid:i.uid||m.guid("uid_"),ruid:l,size:i.size||0,type:i.type||"",slice:function(t,d,h){return this.isDetached()?r.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),t,d,h)},getSource:function(){return e[this.uid]?e[this.uid]:null},detach:function(t){if(this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),t=t||"",t.substr(0,5)=="data:"){var d=t.indexOf(";base64,");this.type=t.substring(5,d),t=c.atob(t.substring(d+8))}this.size=t.length,e[this.uid]=t},isDetached:function(){return!this.ruid&&m.typeOf(e[this.uid])==="string"},destroy:function(){this.detach(),delete e[this.uid]}}),i.data?this.detach(i.data):e[this.uid]=i}var e={};return u}),P("moxie/core/I18n",["moxie/core/utils/Basic"],function(m){var c={};return{addI18n:function(a){return m.extend(c,a)},translate:function(a){return c[a]||a},_:function(a){return this.translate(a)},sprintf:function(a){var u=[].slice.call(arguments,1);return a.replace(/%[a-z]/g,function(){var e=u.shift();return m.typeOf(e)!=="undefined"?e:""})}}}),P("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(m,c){var a="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",u={},e={},l=function(n){var o,f,s,p=n.split(/,/);for(o=0;o<p.length;o+=2){for(s=p[o+1].split(/ /),f=0;f<s.length;f++)u[s[f]]=p[o];e[p[o]]=s}},i=function(n,o){var f,s,p,g,w=[];for(s=0;s<n.length;s++)for(f=n[s].extensions.toLowerCase().split(/\s*,\s*/),p=0;p<f.length;p++){if(f[p]==="*")return[];if(g=w[f[p]],o&&/^\w+$/.test(f[p]))w.push("."+f[p]);else if(g&&m.inArray(g,w)===-1)w.push(g);else if(!g)return[]}return w},r=function(n){var o=[];return m.each(n,function(f){if(f=f.toLowerCase(),f==="*")return o=[],!1;var s=f.match(/^(\w+)\/(\*|\w+)$/);s&&(s[2]==="*"?m.each(e,function(p,g){new RegExp("^"+s[1]+"/").test(g)&&[].push.apply(o,e[g])}):e[f]&&[].push.apply(o,e[f]))}),o},t=function(n){var o=[],f=[];return m.typeOf(n)==="string"&&(n=m.trim(n).split(/\s*,\s*/)),f=r(n),o.push({title:c.translate("Files"),extensions:f.length?f.join(","):"*"}),o},d=function(n){var o=n&&n.match(/\.([^.]+)$/);return o?o[1].toLowerCase():""},h=function(n){return u[d(n)]||""};return l(a),{mimes:u,extensions:e,addMimeType:l,extList2mimes:i,mimes2exts:r,mimes2extList:t,getFileExtension:d,getFileMime:h}}),P("moxie/file/FileInput",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Mime","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/I18n","moxie/runtime/Runtime","moxie/runtime/RuntimeClient"],function(m,c,a,u,e,l,i,r,t){function d(n){var o,f,s;if(m.inArray(m.typeOf(n),["string","node"])!==-1&&(n={browse_button:n}),f=u.get(n.browse_button),!f)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR);s={accept:[{title:i.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:f.parentNode||document.body},n=m.extend({},s,n),typeof n.required_caps=="string"&&(n.required_caps=r.parseCaps(n.required_caps)),typeof n.accept=="string"&&(n.accept=a.mimes2extList(n.accept)),o=u.get(n.container),o||(o=document.body),u.getStyle(o,"position")==="static"&&(o.style.position="relative"),o=f=null,t.call(this),m.extend(this,{uid:m.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){var p=this;p.bind("RuntimeInit",function(g,w){p.ruid=w.uid,p.shimid=w.shimid,p.bind("Ready",function(){p.trigger("Refresh")},999),p.bind("Refresh",function(){var b,y,x,E,v;x=u.get(n.browse_button),E=u.get(w.shimid),x&&(b=u.getPos(x,u.get(n.container)),y=u.getSize(x),v=parseInt(u.getStyle(x,"z-index"),10)||0,E&&m.extend(E.style,{top:b.y+"px",left:b.x+"px",width:y.w+"px",height:y.h+"px",zIndex:v+1})),E=x=null}),w.exec.call(p,"FileInput","init",n)}),p.connectRuntime(m.extend({},n,{required_caps:{select_file:!0}}))},getOption:function(p){return n[p]},setOption:function(p,g){if(n.hasOwnProperty(p)){var w=n[p];switch(p){case"accept":typeof g=="string"&&(g=a.mimes2extList(g));break;case"container":case"required_caps":throw new e.FileException(e.FileException.NO_MODIFICATION_ALLOWED_ERR)}n[p]=g,this.exec("FileInput","setOption",p,g),this.trigger("OptionChanged",p,g,w)}},disable:function(p){var g=this.getRuntime();g&&this.exec("FileInput","disable",m.typeOf(p)==="undefined"?!0:p)},refresh:function(){this.trigger("Refresh")},destroy:function(){var p=this.getRuntime();p&&(p.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),m.typeOf(this.files)==="array"&&m.each(this.files,function(g){g.destroy()}),this.files=null,this.unbindAll()}}),this.handleEventProps(h)}var h=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return d.prototype=l.instance,d}),P("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(m,c,a){function u(e,l){l||(l={}),a.apply(this,arguments),this.type||(this.type=c.getFileMime(l.name));var i;if(l.name)i=l.name.replace(/\\/g,"/"),i=i.substr(i.lastIndexOf("/")+1);else if(this.type){var r=this.type.split("/")[0];i=m.guid((r!==""?r:"file")+"_"),c.extensions[this.type]&&(i+="."+c.extensions[this.type][0])}m.extend(this,{name:i||m.guid("file_"),relativePath:"",lastModifiedDate:l.lastModifiedDate||new Date().toLocaleString()})}return u.prototype=a.prototype,u}),P("moxie/file/FileDrop",["moxie/core/I18n","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/core/utils/Env","moxie/file/File","moxie/runtime/RuntimeClient","moxie/core/EventTarget","moxie/core/utils/Mime"],function(m,c,a,u,e,l,i,r,t){function d(n){var o,f=this;typeof n=="string"&&(n={drop_zone:n}),o={accept:[{title:m.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n=typeof n=="object"?u.extend({},o,n):o,n.container=c.get(n.drop_zone)||document.body,c.getStyle(n.container,"position")==="static"&&(n.container.style.position="relative"),typeof n.accept=="string"&&(n.accept=t.mimes2extList(n.accept)),i.call(f),u.extend(f,{uid:u.guid("uid_"),ruid:null,files:null,init:function(){f.bind("RuntimeInit",function(s,p){f.ruid=p.uid,p.exec.call(f,"FileDrop","init",n),f.dispatchEvent("ready")}),f.connectRuntime(n)},destroy:function(){var s=this.getRuntime();s&&(s.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null,this.unbindAll()}}),this.handleEventProps(h)}var h=["ready","dragenter","dragleave","drop","error"];return d.prototype=r.instance,d}),P("moxie/file/FileReader",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/Exceptions","moxie/core/EventTarget","moxie/file/Blob","moxie/runtime/RuntimeClient"],function(m,c,a,u,e,l){function i(){function t(d,h){if(this.trigger("loadstart"),this.readyState===i.LOADING)return this.trigger("error",new a.DOMException(a.DOMException.INVALID_STATE_ERR)),this.trigger("loadend"),void 0;if(!(h instanceof e))return this.trigger("error",new a.DOMException(a.DOMException.NOT_FOUND_ERR)),this.trigger("loadend"),void 0;if(this.result=null,this.readyState=i.LOADING,h.isDetached()){var n=h.getSource();switch(d){case"readAsText":case"readAsBinaryString":this.result=n;break;case"readAsDataURL":this.result="data:"+h.type+";base64,"+c.btoa(n)}this.readyState=i.DONE,this.trigger("load"),this.trigger("loadend")}else this.connectRuntime(h.ruid),this.exec("FileReader","read",d,h)}l.call(this),m.extend(this,{uid:m.guid("uid_"),readyState:i.EMPTY,result:null,error:null,readAsBinaryString:function(d){t.call(this,"readAsBinaryString",d)},readAsDataURL:function(d){t.call(this,"readAsDataURL",d)},readAsText:function(d){t.call(this,"readAsText",d)},abort:function(){this.result=null,m.inArray(this.readyState,[i.EMPTY,i.DONE])===-1&&(this.readyState===i.LOADING&&(this.readyState=i.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),this.exec("FileReader","destroy"),this.disconnectRuntime(),this.unbindAll()}}),this.handleEventProps(r),this.bind("Error",function(d,h){this.readyState=i.DONE,this.error=h},999),this.bind("Load",function(){this.readyState=i.DONE},999)}var r=["loadstart","progress","load","abort","error","loadend"];return i.EMPTY=0,i.LOADING=1,i.DONE=2,i.prototype=u.instance,i}),P("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(m){var c=function(e,l){var i,r=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],t=r.length,d={http:80,https:443},h={},n=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,o=n.exec(e||""),f=/^\/\/\w/.test(e);switch(m.typeOf(l)){case"undefined":l=c(document.location.href,!1);break;case"string":l=c(l,!1)}for(;t--;)o[t]&&(h[r[t]]=o[t]);if(i=!f&&!h.scheme,(f||i)&&(h.scheme=l.scheme),i){h.host=l.host,h.port=l.port;var s="";/^[^\/]/.test(h.path)&&(s=l.path,s=/\/[^\/]*\.[^\/]*$/.test(s)?s.replace(/\/[^\/]+$/,"/"):s.replace(/\/?$/,"/")),h.path=s+(h.path||"")}return h.port||(h.port=d[h.scheme]||80),h.port=parseInt(h.port,10),h.path||(h.path="/"),delete h.source,h},a=function(e){var l={http:80,https:443},i=typeof e=="object"?e:c(e);return i.scheme+"://"+i.host+(i.port!==l[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},u=function(e){function l(i){return[i.scheme,i.host,i.port].join("/")}return typeof e=="string"&&(e=c(e)),l(c())===l(e)};return{parseUrl:c,resolveUrl:a,hasSameOrigin:u}}),P("moxie/runtime/RuntimeTarget",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(m,c,a){function u(){this.uid=m.guid("uid_"),c.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return u.prototype=a.instance,u}),P("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(m,c,a){return function(){function u(e,l){if(!l.isDetached()){var i=this.connectRuntime(l.ruid).exec.call(this,"FileReaderSync","read",e,l);return this.disconnectRuntime(),i}var r=l.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+l.type+";base64,"+a.btoa(r);case"readAsText":for(var t="",d=0,h=r.length;h>d;d++)t+=String.fromCharCode(r[d]);return t}}c.call(this),m.extend(this,{uid:m.guid("uid_"),readAsBinaryString:function(e){return u.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return u.call(this,"readAsDataURL",e)},readAsText:function(e){return u.call(this,"readAsText",e)}})}}),P("moxie/xhr/FormData",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(m,c,a){function u(){var e,l=[];c.extend(this,{append:function(i,r){var t=this,d=c.typeOf(r);r instanceof a?e={name:i,value:r}:d==="array"?(i+="[]",c.each(r,function(h){t.append(i,h)})):d==="object"?c.each(r,function(h,n){t.append(i+"["+n+"]",h)}):d==="null"||d==="undefined"||d==="number"&&isNaN(r)?t.append(i,"false"):l.push({name:i,value:r.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(i){c.each(l,function(r){i(r.value,r.name)}),e&&i(e.value,e.name)},destroy:function(){e=null,l=[]}})}return u}),P("moxie/xhr/XMLHttpRequest",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/EventTarget","moxie/core/utils/Encode","moxie/core/utils/Url","moxie/runtime/Runtime","moxie/runtime/RuntimeTarget","moxie/file/Blob","moxie/file/FileReaderSync","moxie/xhr/FormData","moxie/core/utils/Env","moxie/core/utils/Mime"],function(m,c,a,u,e,l,i,r,t,d,h,n){function o(){this.uid=m.guid("uid_")}function f(){function g(D,M){return S.hasOwnProperty(D)?arguments.length===1?h.can("define_property")?S[D]:A[D]:(h.can("define_property")?S[D]=M:A[D]=M,void 0):void 0}function w(D){function M(){R&&(R.destroy(),R=null),X.dispatchEvent("loadend"),X=null}function G(V){R.bind("LoadStart",function(k){g("readyState",f.LOADING),X.dispatchEvent("readystatechange"),X.dispatchEvent(k),H&&X.upload.dispatchEvent(k)}),R.bind("Progress",function(k){g("readyState")!==f.LOADING&&(g("readyState",f.LOADING),X.dispatchEvent("readystatechange")),X.dispatchEvent(k)}),R.bind("UploadProgress",function(k){H&&X.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:k.total,loaded:k.loaded})}),R.bind("Load",function(k){g("readyState",f.DONE),g("status",Number(V.exec.call(R,"XMLHttpRequest","getStatus")||0)),g("statusText",s[g("status")]||""),g("response",V.exec.call(R,"XMLHttpRequest","getResponse",g("responseType"))),~m.inArray(g("responseType"),["text",""])?g("responseText",g("response")):g("responseType")==="document"&&g("responseXML",g("response")),j=V.exec.call(R,"XMLHttpRequest","getAllResponseHeaders"),X.dispatchEvent("readystatechange"),g("status")>0?(H&&X.upload.dispatchEvent(k),X.dispatchEvent(k)):(B=!0,X.dispatchEvent("error")),M()}),R.bind("Abort",function(k){X.dispatchEvent(k),M()}),R.bind("Error",function(k){B=!0,g("readyState",f.DONE),X.dispatchEvent("readystatechange"),q=!0,X.dispatchEvent(k),M()}),V.exec.call(R,"XMLHttpRequest","send",{url:y,method:x,async:O,user:E,password:v,headers:F,mimeType:T,encoding:I,responseType:X.responseType,withCredentials:X.withCredentials,options:U},D)}var X=this;new Date().getTime(),R=new i,typeof U.required_caps=="string"&&(U.required_caps=l.parseCaps(U.required_caps)),U.required_caps=m.extend({},U.required_caps,{return_response_type:X.responseType}),D instanceof d&&(U.required_caps.send_multipart=!0),m.isEmptyObj(F)||(U.required_caps.send_custom_headers=!0),L||(U.required_caps.do_cors=!0),U.ruid?G(R.connectRuntime(U)):(R.bind("RuntimeInit",function(V,k){G(k)}),R.bind("RuntimeError",function(V,k){X.dispatchEvent("RuntimeError",k)}),R.connectRuntime(U))}function b(){g("responseText",""),g("responseXML",null),g("response",null),g("status",0),g("statusText","")}var y,x,E,v,R,_,A=this,S={timeout:0,readyState:f.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},O=!0,F={},I=null,T=null,C=!1,N=!1,H=!1,q=!1,B=!1,L=!1,U={},j="";m.extend(this,S,{uid:m.guid("uid_"),upload:new o,open:function(D,M,G,X,V){var k;if(!D||!M)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(D)||u.utf8_encode(D)!==D)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(~m.inArray(D.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(x=D.toUpperCase()),~m.inArray(x,["CONNECT","TRACE","TRACK"]))throw new c.DOMException(c.DOMException.SECURITY_ERR);if(M=u.utf8_encode(M),k=e.parseUrl(M),L=e.hasSameOrigin(k),y=e.resolveUrl(M),(X||V)&&!L)throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);if(E=X||k.user,v=V||k.pass,O=G||!0,O===!1&&(g("timeout")||g("withCredentials")||g("responseType")!==""))throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);C=!O,N=!1,F={},b.call(this),g("readyState",f.OPENED),this.dispatchEvent("readystatechange")},setRequestHeader:function(D,M){var G=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(g("readyState")!==f.OPENED||N)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(D)||u.utf8_encode(D)!==D)throw new c.DOMException(c.DOMException.SYNTAX_ERR);return D=m.trim(D).toLowerCase(),~m.inArray(D,G)||/^(proxy\-|sec\-)/.test(D)?!1:(F[D]?F[D]+=", "+M:F[D]=M,!0)},hasRequestHeader:function(D){return D&&F[D.toLowerCase()]||!1},getAllResponseHeaders:function(){return j||""},getResponseHeader:function(D){return D=D.toLowerCase(),B||~m.inArray(D,["set-cookie","set-cookie2"])?null:j&&j!==""&&(_||(_={},m.each(j.split(/\r\n/),function(M){var G=M.split(/:\s+/);G.length===2&&(G[0]=m.trim(G[0]),_[G[0].toLowerCase()]={header:G[0],value:m.trim(G[1])})})),_.hasOwnProperty(D))?_[D].header+": "+_[D].value:null},overrideMimeType:function(D){var M;if(~m.inArray(g("readyState"),[f.LOADING,f.DONE]))throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(D=m.trim(D.toLowerCase()),/;/.test(D)&&(M=D.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(D=M[1],M[2]&&M[2]),!n.mimes[D])throw new c.DOMException(c.DOMException.SYNTAX_ERR)},send:function(D,M){if(U=m.typeOf(M)==="string"?{ruid:M}:M||{},this.readyState!==f.OPENED||N)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(D instanceof r)U.ruid=D.ruid,T=D.type||"application/octet-stream";else if(D instanceof d){if(D.hasBlob()){var G=D.getBlob();U.ruid=G.ruid,T=G.type||"application/octet-stream"}}else typeof D=="string"&&(I="UTF-8",T="text/plain;charset=UTF-8",D=u.utf8_encode(D));this.withCredentials||(this.withCredentials=U.required_caps&&U.required_caps.send_browser_cookies&&!L),H=!C&&this.upload.hasEventListener(),B=!1,q=!D,C||(N=!0),w.call(this,D)},abort:function(){if(B=!0,C=!1,~m.inArray(g("readyState"),[f.UNSENT,f.OPENED,f.DONE]))g("readyState",f.UNSENT);else{if(g("readyState",f.DONE),N=!1,!R)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);R.getRuntime().exec.call(R,"XMLHttpRequest","abort",q),q=!0}},destroy:function(){R&&(m.typeOf(R.destroy)==="function"&&R.destroy(),R=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}}),this.handleEventProps(p.concat(["readystatechange"])),this.upload.handleEventProps(p)}var s={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};o.prototype=a.instance;var p=["loadstart","progress","abort","error","load","timeout","loadend"];return f.UNSENT=0,f.OPENED=1,f.HEADERS_RECEIVED=2,f.LOADING=3,f.DONE=4,f.prototype=a.instance,f}),P("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(m,c,a,u){function e(){function l(){n=o=0,h=this.result=null}function i(s,p){var g=this;d=p,g.bind("TransportingProgress",function(w){o=w.loaded,n>o&&m.inArray(g.state,[e.IDLE,e.DONE])===-1&&r.call(g)},999),g.bind("TransportingComplete",function(){o=n,g.state=e.DONE,h=null,g.result=d.exec.call(g,"Transporter","getAsBlob",s||"")},999),g.state=e.BUSY,g.trigger("TransportingStarted"),r.call(g)}function r(){var s,p=this,g=n-o;f>g&&(f=g),s=c.btoa(h.substr(o,f)),d.exec.call(p,"Transporter","receive",s,n)}var t,d,h,n,o,f;a.call(this),m.extend(this,{uid:m.guid("uid_"),state:e.IDLE,result:null,transport:function(s,p,g){var w=this;if(g=m.extend({chunk_size:204798},g),(t=g.chunk_size%3)&&(g.chunk_size+=3-t),f=g.chunk_size,l.call(this),h=s,n=s.length,m.typeOf(g)==="string"||g.ruid)i.call(w,p,this.connectRuntime(g));else{var b=function(y,x){w.unbind("RuntimeInit",b),i.call(w,p,x)};this.bind("RuntimeInit",b),this.connectRuntime(g)}},abort:function(){var s=this;s.state=e.IDLE,d&&(d.exec.call(s,"Transporter","clear"),s.trigger("TransportingAborted")),l.call(s)},destroy:function(){this.unbindAll(),d=null,this.disconnectRuntime(),l.call(this)}})}return e.IDLE=0,e.BUSY=1,e.DONE=2,e.prototype=u.instance,e}),P("moxie/image/Image",["moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/file/FileReaderSync","moxie/xhr/XMLHttpRequest","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/runtime/Transporter","moxie/core/utils/Env","moxie/core/EventTarget","moxie/file/Blob","moxie/file/File","moxie/core/utils/Encode"],function(m,c,a,u,e,l,i,r,t,d,h,n,o){function f(){function p(x){try{return x||(x=this.exec("Image","getInfo")),this.size=x.size,this.width=x.width,this.height=x.height,this.type=x.type,this.meta=x.meta,this.name===""&&(this.name=x.name),!0}catch(E){return this.trigger("error",E.code),!1}}function g(x){var E=m.typeOf(x);try{if(x instanceof f){if(!x.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);w.apply(this,arguments)}else if(x instanceof h){if(!~m.inArray(x.type,["image/jpeg","image/png"]))throw new a.ImageError(a.ImageError.WRONG_FORMAT);b.apply(this,arguments)}else if(m.inArray(E,["blob","file"])!==-1)g.call(this,new n(null,x),arguments[1]);else if(E==="string")x.substr(0,5)==="data:"?g.call(this,new h(null,{data:x}),arguments[1]):y.apply(this,arguments);else{if(E!=="node"||x.nodeName.toLowerCase()!=="img")throw new a.DOMException(a.DOMException.TYPE_MISMATCH_ERR);g.call(this,x.src,arguments[1])}}catch(v){this.trigger("error",v.code)}}function w(x,E){var v=this.connectRuntime(x.ruid);this.ruid=v.uid,v.exec.call(this,"Image","loadFromImage",x,m.typeOf(E)==="undefined"?!0:E)}function b(x,E){function v(_){R.ruid=_.uid,_.exec.call(R,"Image","loadFromBlob",x)}var R=this;R.name=x.name||"",x.isDetached()?(this.bind("RuntimeInit",function(_,A){v(A)}),E&&typeof E.required_caps=="string"&&(E.required_caps=l.parseCaps(E.required_caps)),this.connectRuntime(m.extend({required_caps:{access_image_binary:!0,resize_image:!0}},E))):v(this.connectRuntime(x.ruid))}function y(x,E){var v,R=this;v=new e,v.open("get",x),v.responseType="blob",v.onprogress=function(_){R.trigger(_)},v.onload=function(){b.call(R,v.response,!0)},v.onerror=function(_){R.trigger(_)},v.onloadend=function(){v.destroy()},v.bind("RuntimeError",function(_,A){R.trigger("RuntimeError",A)}),v.send(null,E)}i.call(this),m.extend(this,{uid:m.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){g.apply(this,arguments)},resize:function(x){var E,v,R=this,_={x:0,y:0,width:R.width,height:R.height},A=m.extendIf({width:R.width,height:R.height,type:R.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},x);try{if(!R.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);if(R.width>f.MAX_RESIZE_WIDTH||R.height>f.MAX_RESIZE_HEIGHT)throw new a.ImageError(a.ImageError.MAX_RESOLUTION_ERR);if(E=R.meta&&R.meta.tiff&&R.meta.tiff.Orientation||1,m.inArray(E,[5,6,7,8])!==-1){var S=A.width;A.width=A.height,A.height=S}if(A.crop){switch(v=Math.max(A.width/R.width,A.height/R.height),x.fit?(_.width=Math.min(Math.ceil(A.width/v),R.width),_.height=Math.min(Math.ceil(A.height/v),R.height),v=A.width/_.width):(_.width=Math.min(A.width,R.width),_.height=Math.min(A.height,R.height),v=1),typeof A.crop=="boolean"&&(A.crop="cc"),A.crop.toLowerCase().replace(/_/,"-")){case"rb":case"right-bottom":_.x=R.width-_.width,_.y=R.height-_.height;break;case"cb":case"center-bottom":_.x=Math.floor((R.width-_.width)/2),_.y=R.height-_.height;break;case"lb":case"left-bottom":_.x=0,_.y=R.height-_.height;break;case"lt":case"left-top":_.x=0,_.y=0;break;case"ct":case"center-top":_.x=Math.floor((R.width-_.width)/2),_.y=0;break;case"rt":case"right-top":_.x=R.width-_.width,_.y=0;break;case"rc":case"right-center":case"right-middle":_.x=R.width-_.width,_.y=Math.floor((R.height-_.height)/2);break;case"lc":case"left-center":case"left-middle":_.x=0,_.y=Math.floor((R.height-_.height)/2);break;case"cc":case"center-center":case"center-middle":default:_.x=Math.floor((R.width-_.width)/2),_.y=Math.floor((R.height-_.height)/2)}_.x=Math.max(_.x,0),_.y=Math.max(_.y,0)}else v=Math.min(A.width/R.width,A.height/R.height),v>1&&!A.fit&&(v=1);this.exec("Image","resize",_,v,A)}catch(O){R.trigger("error",O.code)}},downsize:function(x){var E,v={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"};E=typeof x=="object"?m.extend(v,x):m.extend(v,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]}),this.resize(E)},crop:function(x,E,v){this.downsize(x,E,!0,v)},getAsCanvas:function(){if(!t.can("create_canvas"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function(x,E){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsBlob",x||"image/jpeg",E||90)},getAsDataURL:function(x,E){if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",x||"image/jpeg",E||90)},getAsBinaryString:function(x,E){var v=this.getAsDataURL(x,E);return o.atob(v.substring(v.indexOf("base64,")+7))},embed:function(x,E){function v(O,F){var I=this;if(t.can("create_canvas")){var T=I.getAsCanvas();if(T)return x.appendChild(T),T=null,I.destroy(),_.trigger("embedded"),void 0}var C=I.getAsDataURL(O,F);if(!C)throw new a.ImageError(a.ImageError.WRONG_FORMAT);if(t.can("use_data_uri_of",C.length))x.innerHTML='<img src="'+C+'" width="'+I.width+'" height="'+I.height+'" alt="" />',I.destroy(),_.trigger("embedded");else{var N=new r;N.bind("TransportingComplete",function(){R=_.connectRuntime(this.result.ruid),_.bind("Embedded",function(){m.extend(R.getShimContainer().style,{top:"0px",left:"0px",width:I.width+"px",height:I.height+"px"}),R=null},999),R.exec.call(_,"ImageView","display",this.result.uid,width,height),I.destroy()}),N.transport(o.atob(C.substring(C.indexOf("base64,")+7)),O,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:x})}}var R,_=this,A=m.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},E);try{if(!(x=c.get(x)))throw new a.DOMException(a.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new a.DOMException(a.DOMException.INVALID_STATE_ERR);this.width>f.MAX_RESIZE_WIDTH||this.height>f.MAX_RESIZE_HEIGHT;var S=new f;return S.bind("Resize",function(){v.call(this,A.type,A.quality)}),S.bind("Load",function(){this.downsize(A)}),this.meta.thumb&&this.meta.thumb.width>=A.width&&this.meta.thumb.height>=A.height?S.load(this.meta.thumb.data):S.clone(this,!1),S}catch(O){this.trigger("error",O.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy(),this.unbindAll()}}),this.handleEventProps(s),this.bind("Load Resize",function(){return p.call(this)},999)}var s=["progress","load","error","resize","embedded"];return f.MAX_RESIZE_WIDTH=8192,f.MAX_RESIZE_HEIGHT=8192,f.prototype=d.instance,f}),P("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(m,c,a,u){function e(r){var t=this,d=a.capTest,h=a.capTrue,n=m.extend({access_binary:d(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return t.can("access_binary")&&!!i.Image},display_media:d((u.can("create_canvas")||u.can("use_data_uri_over32kb"))&&z("moxie/image/Image")),do_cors:d(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:d(function(){var o=document.createElement("div");return("draggable"in o||"ondragstart"in o&&"ondrop"in o)&&(u.browser!=="IE"||u.verComp(u.version,9,">"))}()),filter_by_extension:d(function(){return!(u.browser==="Chrome"&&u.verComp(u.version,28,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<")||u.browser==="Safari"&&u.verComp(u.version,7,"<")||u.browser==="Firefox"&&u.verComp(u.version,37,"<"))}()),return_response_headers:h,return_response_type:function(o){return o==="json"&&window.JSON?!0:u.can("return_response_type",o)},return_status_code:h,report_upload_progress:d(window.XMLHttpRequest&&new XMLHttpRequest().upload),resize_image:function(){return t.can("access_binary")&&u.can("create_canvas")},select_file:function(){return u.can("use_fileinput")&&window.File},select_folder:function(){return t.can("select_file")&&(u.browser==="Chrome"&&u.verComp(u.version,21,">=")||u.browser==="Firefox"&&u.verComp(u.version,42,">="))},select_multiple:function(){return!(!t.can("select_file")||u.browser==="Safari"&&u.os==="Windows"||u.os==="iOS"&&u.verComp(u.osVersion,"7.0.0",">")&&u.verComp(u.osVersion,"8.0.0","<"))},send_binary_string:d(window.XMLHttpRequest&&(new XMLHttpRequest().sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:d(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&new XMLHttpRequest().upload&&window.FormData)||t.can("send_binary_string")},slice_blob:d(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return t.can("slice_blob")&&t.can("send_multipart")},summon_file_dialog:function(){return t.can("select_file")&&!(u.browser==="Firefox"&&u.verComp(u.version,4,"<")||u.browser==="Opera"&&u.verComp(u.version,12,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<"))},upload_filesize:h,use_http_method:h},arguments[2]);a.call(this,r,arguments[1]||l,n),m.extend(this,{init:function(){this.trigger("Init")},destroy:function(o){return function(){o.call(t),o=t=null}}(this.destroy)}),m.extend(this.getShim(),i)}var l="html5",i={};return a.addConstructor(l,e),i}),P("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(m,c){function a(){function u(e,l,i){var r;if(!window.File.prototype.slice)return(r=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?r.call(e,l,i):null;try{return e.slice(),e.slice(l,i)}catch{return e.slice(l,i-l)}}this.slice=function(){return new c(this.getRuntime().uid,u.apply(this,arguments))},this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}return m.Blob=a}),P("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(m){function c(){this.returnValue=!1}function a(){this.cancelBubble=!0}var u={},e="moxie_"+m.guid(),l=function(t,d,h,n){var o,f;d=d.toLowerCase(),t.addEventListener?(o=h,t.addEventListener(d,o,!1)):t.attachEvent&&(o=function(){var s=window.event;s.target||(s.target=s.srcElement),s.preventDefault=c,s.stopPropagation=a,h(s)},t.attachEvent("on"+d,o)),t[e]||(t[e]=m.guid()),u.hasOwnProperty(t[e])||(u[t[e]]={}),f=u[t[e]],f.hasOwnProperty(d)||(f[d]=[]),f[d].push({func:o,orig:h,key:n})},i=function(t,d,h){var n,o;if(d=d.toLowerCase(),t[e]&&u[t[e]]&&u[t[e]][d]){n=u[t[e]][d];for(var f=n.length-1;f>=0&&(n[f].orig!==h&&n[f].key!==h||(t.removeEventListener?t.removeEventListener(d,n[f].func,!1):t.detachEvent&&t.detachEvent("on"+d,n[f].func),n[f].orig=null,n[f].func=null,n.splice(f,1),h===o));f--);if(n.length||delete u[t[e]][d],m.isEmptyObj(u[t[e]])){delete u[t[e]];try{delete t[e]}catch{t[e]=o}}}},r=function(t,d){t&&t[e]&&m.each(u[t[e]],function(h,n){i(t,n,d)})};return{addEvent:l,removeEvent:i,removeAllEvents:r}}),P("moxie/runtime/html5/file/FileInput",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i){function r(){var t,d;a.extend(this,{init:function(h){var n,o,f,s,p,g,w=this,b=w.getRuntime();t=h,f=l.extList2mimes(t.accept,b.can("filter_by_extension")),o=b.getShimContainer(),o.innerHTML='<input id="'+b.uid+'" type="file" style="font-size:999px;opacity:0;"'+(t.multiple&&b.can("select_multiple")?"multiple":"")+(t.directory&&b.can("select_folder")?"webkitdirectory directory":"")+(f?' accept="'+f.join(",")+'"':"")+" />",n=u.get(b.uid),a.extend(n.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),s=u.get(t.browse_button),d=u.getStyle(s,"z-index")||"auto",b.can("summon_file_dialog")&&(u.getStyle(s,"position")==="static"&&(s.style.position="relative"),e.addEvent(s,"click",function(y){var x=u.get(b.uid);x&&!x.disabled&&x.click(),y.preventDefault()},w.uid),w.bind("Refresh",function(){p=parseInt(d,10)||1,u.get(t.browse_button).style.zIndex=p,this.getRuntime().getShimContainer().style.zIndex=p-1})),g=b.can("summon_file_dialog")?s:o,e.addEvent(g,"mouseover",function(){w.trigger("mouseenter")},w.uid),e.addEvent(g,"mouseout",function(){w.trigger("mouseleave")},w.uid),e.addEvent(g,"mousedown",function(){w.trigger("mousedown")},w.uid),e.addEvent(u.get(t.container),"mouseup",function(){w.trigger("mouseup")},w.uid),(b.can("summon_file_dialog")?n:s).setAttribute("tabindex",-1),n.onchange=function y(){if(w.files=[],a.each(this.files,function(E){var v="";return t.directory&&E.name=="."?!0:(E.webkitRelativePath&&(v="/"+E.webkitRelativePath.replace(/^\//,"")),E=new c(b.uid,E),E.relativePath=v,w.files.push(E),void 0)}),i.browser!=="IE"&&i.browser!=="IEMobile")this.value="";else{var x=this.cloneNode(!0);this.parentNode.replaceChild(x,this),x.onchange=y}w.files.length&&w.trigger("change")},w.trigger({type:"ready",async:!0}),o=null},setOption:function(h,n){var o=this.getRuntime(),f=u.get(o.uid);switch(h){case"accept":if(n){var s=n.mimes||l.extList2mimes(n,o.can("filter_by_extension"));f.setAttribute("accept",s.join(","))}else f.removeAttribute("accept");break;case"directory":n&&o.can("select_folder")?(f.setAttribute("directory",""),f.setAttribute("webkitdirectory","")):(f.removeAttribute("directory"),f.removeAttribute("webkitdirectory"));break;case"multiple":n&&o.can("select_multiple")?f.setAttribute("multiple",""):f.removeAttribute("multiple")}},disable:function(h){var n,o=this.getRuntime();(n=u.get(o.uid))&&(n.disabled=!!h)},destroy:function(){var h=this.getRuntime(),n=h.getShim(),o=h.getShimContainer(),f=t&&u.get(t.container),s=t&&u.get(t.browse_button);f&&e.removeAllEvents(f,this.uid),s&&(e.removeAllEvents(s,this.uid),s.style.zIndex=d),o&&(e.removeAllEvents(o,this.uid),o.innerHTML=""),n.removeInstance(this.uid),t=o=f=s=n=null}})}return m.FileInput=r}),P("moxie/runtime/html5/file/FileDrop",["moxie/runtime/html5/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime"],function(m,c,a,u,e,l){function i(){function r(y){if(!y.dataTransfer||!y.dataTransfer.types)return!1;var x=a.toArray(y.dataTransfer.types||[]);return a.inArray("Files",x)!==-1||a.inArray("public.file-url",x)!==-1||a.inArray("application/x-moz-file",x)!==-1}function t(y,x){if(h(y)){var E=new c(g,y);E.relativePath=x||"",w.push(E)}}function d(y){for(var x=[],E=0;E<y.length;E++)[].push.apply(x,y[E].extensions.split(/\s*,\s*/));return a.inArray("*",x)===-1?x:[]}function h(y){if(!b.length)return!0;var x=l.getFileExtension(y.name);return!x||a.inArray(x,b)!==-1}function n(y,x){var E=[];a.each(y,function(v){var R=v.webkitGetAsEntry();R&&(R.isFile?t(v.getAsFile(),R.fullPath):E.push(R))}),E.length?o(E,x):x()}function o(y,x){var E=[];a.each(y,function(v){E.push(function(R){f(v,R)})}),a.inSeries(E,function(){x()})}function f(y,x){y.isFile?y.file(function(E){t(E,y.fullPath),x()},function(){x()}):y.isDirectory?s(y,x):x()}function s(y,x){function E(_){R.readEntries(function(A){A.length?([].push.apply(v,A),E(_)):_()},_)}var v=[],R=y.createReader();E(function(){o(v,x)})}var p,g,w=[],b=[];a.extend(this,{init:function(y){var x,E=this;p=y,g=E.ruid,b=d(p.accept),x=p.container,e.addEvent(x,"dragover",function(v){r(v)&&(v.preventDefault(),v.dataTransfer.dropEffect="copy")},E.uid),e.addEvent(x,"drop",function(v){r(v)&&(v.preventDefault(),w=[],v.dataTransfer.items&&v.dataTransfer.items[0].webkitGetAsEntry?n(v.dataTransfer.items,function(){E.files=w,E.trigger("drop")}):(a.each(v.dataTransfer.files,function(R){t(R)}),E.files=w,E.trigger("drop")))},E.uid),e.addEvent(x,"dragenter",function(){E.trigger("dragenter")},E.uid),e.addEvent(x,"dragleave",function(){E.trigger("dragleave")},E.uid)},destroy:function(){e.removeAllEvents(p&&u.get(p.container),this.uid),g=w=b=p=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return m.FileDrop=i}),P("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(m,c,a){function u(){function e(r){return c.atob(r.substring(r.indexOf("base64,")+7))}var l,i=!1;a.extend(this,{read:function(r,t){var d=this;d.result="",l=new window.FileReader,l.addEventListener("progress",function(h){d.trigger(h)}),l.addEventListener("load",function(h){d.result=i?e(l.result):l.result,d.trigger(h)}),l.addEventListener("error",function(h){d.trigger(h,l.error)}),l.addEventListener("loadend",function(h){l=null,d.trigger(h)}),a.typeOf(l[r])==="function"?(i=!1,l[r](t.getSource())):r==="readAsBinaryString"&&(i=!0,l.readAsDataURL(t.getSource()))},abort:function(){l&&l.abort()},destroy:function(){l=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return m.FileReader=u}),P("moxie/runtime/html5/xhr/XMLHttpRequest",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/core/utils/Url","moxie/file/File","moxie/file/Blob","moxie/xhr/FormData","moxie/core/Exceptions","moxie/core/utils/Env"],function(m,c,a,u,e,l,i,r,t){function d(){function h(w,b){var y,x,E=this;y=b.getBlob().getSource(),x=new window.FileReader,x.onload=function(){b.append(b.getBlobName(),new l(null,{type:y.type,data:x.result})),g.send.call(E,w,b)},x.readAsBinaryString(y)}function n(){return!window.XMLHttpRequest||t.browser==="IE"&&t.verComp(t.version,8,"<")?function(){for(var w=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<w.length;b++)try{return new ActiveXObject(w[b])}catch{}}():new window.XMLHttpRequest}function o(w){var b=w.responseXML,y=w.responseText;return t.browser==="IE"&&y&&b&&!b.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(w.getResponseHeader("Content-Type"))&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.validateOnParse=!1,b.loadXML(y)),b&&(t.browser==="IE"&&b.parseError!==0||!b.documentElement||b.documentElement.tagName==="parsererror")?null:b}function f(w){var b="----moxieboundary"+new Date().getTime(),y="--",x=`\r
`,E="",v=this.getRuntime();if(!v.can("send_binary_string"))throw new r.RuntimeError(r.RuntimeError.NOT_SUPPORTED_ERR);return s.setRequestHeader("Content-Type","multipart/form-data; boundary="+b),w.each(function(R,_){E+=R instanceof l?y+b+x+'Content-Disposition: form-data; name="'+_+'"; filename="'+unescape(encodeURIComponent(R.name||"blob"))+'"'+x+"Content-Type: "+(R.type||"application/octet-stream")+x+x+R.getSource()+x:y+b+x+'Content-Disposition: form-data; name="'+_+'"'+x+x+unescape(encodeURIComponent(R))+x}),E+=y+b+y+x}var s,p,g=this;c.extend(this,{send:function(w,b){var y=this,x=t.browser==="Mozilla"&&t.verComp(t.version,4,">=")&&t.verComp(t.version,7,"<"),E=t.browser==="Android Browser",v=!1;if(p=w.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),s=n(),s.open(w.method,w.url,w.async,w.user,w.password),b instanceof l)b.isDetached()&&(v=!0),b=b.getSource();else if(b instanceof i){if(b.hasBlob()){if(b.getBlob().isDetached())b=f.call(y,b),v=!0;else if((x||E)&&c.typeOf(b.getBlob().getSource())==="blob"&&window.FileReader)return h.call(y,w,b),void 0}if(b instanceof i){var R=new window.FormData;b.each(function(_,A){_ instanceof l?R.append(A,_.getSource()):R.append(A,_)}),b=R}}s.upload?(w.withCredentials&&(s.withCredentials=!0),s.addEventListener("load",function(_){y.trigger(_)}),s.addEventListener("error",function(_){y.trigger(_)}),s.addEventListener("progress",function(_){y.trigger(_)}),s.upload.addEventListener("progress",function(_){y.trigger({type:"UploadProgress",loaded:_.loaded,total:_.total})})):s.onreadystatechange=function(){switch(s.readyState){case 1:break;case 2:break;case 3:var _,A;try{u.hasSameOrigin(w.url)&&(_=s.getResponseHeader("Content-Length")||0),s.responseText&&(A=s.responseText.length)}catch{_=A=0}y.trigger({type:"progress",lengthComputable:!!_,total:parseInt(_,10),loaded:A});break;case 4:s.onreadystatechange=function(){};try{if(s.status>=200&&s.status<400){y.trigger("load");break}}catch{}y.trigger("error")}},c.isEmptyObj(w.headers)||c.each(w.headers,function(_,A){s.setRequestHeader(A,_)}),w.responseType!==""&&"responseType"in s&&(s.responseType=w.responseType!=="json"||t.can("return_response_type","json")?w.responseType:"text"),v?s.sendAsBinary?s.sendAsBinary(b):function(){for(var _=new Uint8Array(b.length),A=0;A<b.length;A++)_[A]=255&b.charCodeAt(A);s.send(_.buffer)}():s.send(b),y.trigger("loadstart")},getStatus:function(){try{if(s)return s.status}catch{}return 0},getResponse:function(w){var b=this.getRuntime();try{switch(w){case"blob":var y=new e(b.uid,s.response),x=s.getResponseHeader("Content-Disposition");if(x){var E=x.match(/filename=([\'\"'])([^\1]+)\1/);E&&(p=E[2])}return y.name=p,y.type||(y.type=a.getFileMime(p)),y;case"json":return t.can("return_response_type","json")?s.response:s.status===200&&window.JSON?JSON.parse(s.responseText):null;case"document":return o(s);default:return s.responseText!==""?s.responseText:null}}catch{return null}},getAllResponseHeaders:function(){try{return s.getAllResponseHeaders()}catch{}return""},abort:function(){s&&s.abort()},destroy:function(){g=p=null,this.getRuntime().getShim().removeInstance(this.uid)}})}return m.XMLHttpRequest=d}),P("moxie/runtime/html5/utils/BinaryReader",["moxie/core/utils/Basic"],function(m){function c(e){e instanceof ArrayBuffer?a.apply(this,arguments):u.apply(this,arguments)}function a(e){var l=new DataView(e);m.extend(this,{readByteAt:function(i){return l.getUint8(i)},writeByteAt:function(i,r){l.setUint8(i,r)},SEGMENT:function(i,r,t){switch(arguments.length){case 2:return e.slice(i,i+r);case 1:return e.slice(i);case 3:if(t===null&&(t=new ArrayBuffer),t instanceof ArrayBuffer){var d=new Uint8Array(this.length()-r+t.byteLength);i>0&&d.set(new Uint8Array(e.slice(0,i)),0),d.set(new Uint8Array(t),i),d.set(new Uint8Array(e.slice(i+r)),i+t.byteLength),this.clear(),e=d.buffer,l=new DataView(e);break}default:return e}},length:function(){return e?e.byteLength:0},clear:function(){l=e=null}})}function u(e){function l(i,r,t){t=arguments.length===3?t:e.length-r-1,e=e.substr(0,r)+i+e.substr(t+r)}m.extend(this,{readByteAt:function(i){return e.charCodeAt(i)},writeByteAt:function(i,r){l(String.fromCharCode(r),i,1)},SEGMENT:function(i,r,t){switch(arguments.length){case 1:return e.substr(i);case 2:return e.substr(i,r);case 3:l(t!==null?t:"",i,r);break;default:return e}},length:function(){return e?e.length:0},clear:function(){e=null}})}return m.extend(c.prototype,{littleEndian:!1,read:function(e,l){var i,r,t;if(e+l>this.length())throw new Error("You are trying to read outside the source boundaries.");for(r=this.littleEndian?0:-8*(l-1),t=0,i=0;l>t;t++)i|=this.readByteAt(e+t)<<Math.abs(r+8*t);return i},write:function(e,l,i){var r,t;if(e>this.length())throw new Error("You are trying to write outside the source boundaries.");for(r=this.littleEndian?0:-8*(i-1),t=0;i>t;t++)this.writeByteAt(e+t,255&l>>Math.abs(r+8*t))},BYTE:function(e){return this.read(e,1)},SHORT:function(e){return this.read(e,2)},LONG:function(e){return this.read(e,4)},SLONG:function(e){var l=this.read(e,4);return l>2147483647?l-4294967296:l},CHAR:function(e){return String.fromCharCode(this.read(e,1))},STRING:function(e,l){return this.asArray("CHAR",e,l).join("")},asArray:function(e,l,i){for(var r=[],t=0;i>t;t++)r[t]=this[e](l+t);return r}}),c}),P("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(m,c){return function a(u){var e,l,i,r=[],t=0;if(e=new m(u),e.SHORT(0)!==65496)throw e.clear(),new c.ImageError(c.ImageError.WRONG_FORMAT);for(l=2;l<=e.length();)if(i=e.SHORT(l),i>=65488&&65495>=i)l+=2;else{if(i===65498||i===65497)break;t=e.SHORT(l+2)+2,i>=65505&&65519>=i&&r.push({hex:i,name:"APP"+(15&i),start:l,length:t,segment:e.SEGMENT(l,t)}),l+=t}return e.clear(),{headers:r,restore:function(d){var h,n,o;for(o=new m(d),l=o.SHORT(2)==65504?4+o.SHORT(4):2,n=0,h=r.length;h>n;n++)o.SEGMENT(l,0,r[n].segment),l+=r[n].length;return d=o.SEGMENT(),o.clear(),d},strip:function(d){var h,n,o,f;for(o=new a(d),n=o.headers,o.purge(),h=new m(d),f=n.length;f--;)h.SEGMENT(n[f].start,n[f].length,"");return d=h.SEGMENT(),h.clear(),d},get:function(d){for(var h=[],n=0,o=r.length;o>n;n++)r[n].name===d.toUpperCase()&&h.push(r[n].segment);return h},set:function(d,h){var n,o,f,s=[];for(typeof h=="string"?s.push(h):s=h,n=o=0,f=r.length;f>n&&(r[n].name===d.toUpperCase()&&(r[n].segment=s[o],r[n].length=s[o].length,o++),!(o>=s.length));n++);},purge:function(){this.headers=r=[]}}}}),P("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(m,c,a){function u(e){function l(s,p){var g,w,b,y,x,E,v,R,_=this,A=[],S={},O={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},F={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,SRATIONAL:8};for(g=_.SHORT(s),w=0;g>w;w++)if(A=[],v=s+2+12*w,b=p[_.SHORT(v)],b!==J){if(y=O[_.SHORT(v+=2)],x=_.LONG(v+=2),E=F[y],!E)throw new a.ImageError(a.ImageError.INVALID_META_ERR);if(v+=4,E*x>4&&(v=_.LONG(v)+h.tiffHeader),v+E*x>=this.length())throw new a.ImageError(a.ImageError.INVALID_META_ERR);y!=="ASCII"?(A=_.asArray(y,v,x),R=x==1?A[0]:A,S[b]=d.hasOwnProperty(b)&&typeof R!="object"?d[b][R]:R):S[b]=m.trim(_.STRING(v,x).replace(/\0$/,""))}return S}function i(s,p,g){var w,b,y,x=0;if(typeof p=="string"){var E=t[s.toLowerCase()];for(var v in E)if(E[v]===p){p=v;break}}w=h[s.toLowerCase()+"IFD"],b=this.SHORT(w);for(var R=0;b>R;R++)if(y=w+12*R+2,this.SHORT(y)==p){x=y+8;break}if(!x)return!1;try{this.write(x,g,4)}catch{return!1}return!0}var r,t,d,h,n,o;if(c.call(this,e),t={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}},d={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},h={tiffHeader:10},n=h.tiffHeader,r={clear:this.clear},m.extend(this,{read:function(){try{return u.prototype.read.apply(this,arguments)}catch{throw new a.ImageError(a.ImageError.INVALID_META_ERR)}},write:function(){try{return u.prototype.write.apply(this,arguments)}catch{throw new a.ImageError(a.ImageError.INVALID_META_ERR)}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(s){return this.LONG(s)/this.LONG(s+4)},SRATIONAL:function(s){return this.SLONG(s)/this.SLONG(s+4)},ASCII:function(s){return this.CHAR(s)},TIFF:function(){return o||null},EXIF:function(){var s=null;if(h.exifIFD){try{s=l.call(this,h.exifIFD,t.exif)}catch{return null}if(s.ExifVersion&&m.typeOf(s.ExifVersion)==="array"){for(var p=0,g="";p<s.ExifVersion.length;p++)g+=String.fromCharCode(s.ExifVersion[p]);s.ExifVersion=g}}return s},GPS:function(){var s=null;if(h.gpsIFD){try{s=l.call(this,h.gpsIFD,t.gps)}catch{return null}s.GPSVersionID&&m.typeOf(s.GPSVersionID)==="array"&&(s.GPSVersionID=s.GPSVersionID.join("."))}return s},thumb:function(){if(h.IFD1)try{var s=l.call(this,h.IFD1,t.thumb);if("JPEGInterchangeFormat"in s)return this.SEGMENT(h.tiffHeader+s.JPEGInterchangeFormat,s.JPEGInterchangeFormatLength)}catch{}return null},setExif:function(s,p){return s!=="PixelXDimension"&&s!=="PixelYDimension"?!1:i.call(this,"exif",s,p)},clear:function(){r.clear(),e=t=d=o=h=r=null}}),this.SHORT(0)!==65505||this.STRING(4,5).toUpperCase()!=="EXIF\0")throw new a.ImageError(a.ImageError.INVALID_META_ERR);if(this.littleEndian=this.SHORT(n)==18761,this.SHORT(n+=2)!==42)throw new a.ImageError(a.ImageError.INVALID_META_ERR);h.IFD0=h.tiffHeader+this.LONG(n+=2),o=l.call(this,h.IFD0,t.tiff),"ExifIFDPointer"in o&&(h.exifIFD=h.tiffHeader+o.ExifIFDPointer,delete o.ExifIFDPointer),"GPSInfoIFDPointer"in o&&(h.gpsIFD=h.tiffHeader+o.GPSInfoIFDPointer,delete o.GPSInfoIFDPointer),m.isEmptyObj(o)&&(o=null);var f=this.LONG(h.IFD0+12*this.SHORT(h.IFD0)+2);f&&(h.IFD1=h.tiffHeader+f)}return u.prototype=c.prototype,u}),P("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(m,c,a,u,e){function l(i){function r(s){var p,g,w=0;for(s||(s=h);w<=s.length();){if(p=s.SHORT(w+=2),p>=65472&&65475>=p)return w+=5,{height:s.SHORT(w),width:s.SHORT(w+=2)};g=s.SHORT(w+=2),w+=g-2}return null}function t(){var s,p,g=o.thumb();return g&&(s=new u(g),p=r(s),s.clear(),p)?(p.data=g,p):null}function d(){o&&n&&h&&(o.clear(),n.purge(),h.clear(),f=n=o=h=null)}var h,n,o,f;if(h=new u(i),h.SHORT(0)!==65496)throw new c.ImageError(c.ImageError.WRONG_FORMAT);n=new a(i);try{o=new e(n.get("app1")[0])}catch{}f=r.call(this),m.extend(this,{type:"image/jpeg",size:h.length(),width:f&&f.width||0,height:f&&f.height||0,setExif:function(s,p){return o?(m.typeOf(s)==="object"?m.each(s,function(g,w){o.setExif(w,g)}):o.setExif(s,p),n.set("app1",o.SEGMENT()),void 0):!1},writeHeaders:function(){return arguments.length?n.restore(arguments[0]):n.restore(i)},stripHeaders:function(s){return n.strip(s)},purge:function(){d.call(this)}}),o&&(this.meta={tiff:o.TIFF(),exif:o.EXIF(),gps:o.GPS(),thumb:t()})}return l}),P("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(m,c,a){function u(e){function l(){var h,n;return h=r.call(this,8),h.type=="IHDR"?(n=h.start,{width:t.LONG(n),height:t.LONG(n+=4)}):null}function i(){t&&(t.clear(),e=d=t=null)}function r(h){var n,o,f,s;return n=t.LONG(h),o=t.STRING(h+=4,4),f=h+=4,s=t.LONG(h+n),{length:n,type:o,start:f,CRC:s}}var t,d;t=new a(e),function(){var h=0,n=0,o=[35152,20039,3338,6666];for(n=0;n<o.length;n++,h+=2)if(o[n]!=t.SHORT(h))throw new m.ImageError(m.ImageError.WRONG_FORMAT)}(),d=l.call(this),c.extend(this,{type:"image/png",size:t.length(),width:d.width,height:d.height,purge:function(){i.call(this)}}),i.call(this)}return u}),P("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(m,c,a,u){return function(e){var l,i=[a,u];l=function(){for(var r=0;r<i.length;r++)try{return new i[r](e)}catch{}throw new c.ImageError(c.ImageError.WRONG_FORMAT)}(),m.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(r){return r},stripHeaders:function(r){return r},purge:function(){e=null}}),m.extend(this,l),this.purge=function(){l.purge(),l=null}}}),P("moxie/runtime/html5/image/ResizerCanvas",[],function(){function m(a,u,e){var l=a.width>a.height?"width":"height",i=Math.round(a[l]*u),r=!1;e!=="nearest"&&(.5>u||u>2)&&(u=.5>u?.5:2,r=!0);var t=c(a,u);return r?m(t,i/t[l],e):t}function c(a,u){var e=a.width,l=a.height,i=Math.round(e*u),r=Math.round(l*u),t=document.createElement("canvas");return t.width=i,t.height=r,t.getContext("2d").drawImage(a,0,0,e,l,0,0,i,r),a=null,t}return{scale:m}}),P("moxie/runtime/html5/image/Image",["moxie/runtime/html5/Runtime","moxie/core/utils/Basic","moxie/core/Exceptions","moxie/core/utils/Encode","moxie/file/Blob","moxie/file/File","moxie/runtime/html5/image/ImageInfo","moxie/runtime/html5/image/ResizerCanvas","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i,r,t){function d(){function h(){if(!x&&!b)throw new a.ImageError(a.DOMException.INVALID_STATE_ERR);return x||b}function n(){var S=h();return S.nodeName.toLowerCase()=="canvas"?S:(x=document.createElement("canvas"),x.width=S.width,x.height=S.height,x.getContext("2d").drawImage(S,0,0),x)}function o(S){return u.atob(S.substring(S.indexOf("base64,")+7))}function f(S,O){return"data:"+(O||"")+";base64,"+u.btoa(S)}function s(S){var O=this;b=new Image,b.onerror=function(){w.call(this),O.trigger("error",a.ImageError.WRONG_FORMAT)},b.onload=function(){O.trigger("load")},b.src=S.substr(0,5)=="data:"?S:f(S,v.type)}function p(S,O){var F,I=this;return window.FileReader?(F=new FileReader,F.onload=function(){O.call(I,this.result)},F.onerror=function(){I.trigger("error",a.ImageError.WRONG_FORMAT)},F.readAsDataURL(S),void 0):O.call(this,S.getAsDataURL())}function g(S,O){var F=Math.PI/180,I=document.createElement("canvas"),T=I.getContext("2d"),C=S.width,N=S.height;switch(c.inArray(O,[5,6,7,8])>-1?(I.width=N,I.height=C):(I.width=C,I.height=N),O){case 2:T.translate(C,0),T.scale(-1,1);break;case 3:T.translate(C,N),T.rotate(180*F);break;case 4:T.translate(0,N),T.scale(1,-1);break;case 5:T.rotate(90*F),T.scale(1,-1);break;case 6:T.rotate(90*F),T.translate(0,-N);break;case 7:T.rotate(90*F),T.translate(C,-N),T.scale(-1,1);break;case 8:T.rotate(-90*F),T.translate(-C,0)}return T.drawImage(S,0,0,C,N),I}function w(){y&&(y.purge(),y=null),E=b=x=v=null,_=!1}var b,y,x,E,v,R=this,_=!1,A=!0;c.extend(this,{loadFromBlob:function(S){var O=this.getRuntime(),F=arguments.length>1?arguments[1]:!0;if(!O.can("access_binary"))throw new a.RuntimeError(a.RuntimeError.NOT_SUPPORTED_ERR);return v=S,S.isDetached()?(E=S.getSource(),s.call(this,E),void 0):(p.call(this,S.getSource(),function(I){F&&(E=o(I)),s.call(this,I)}),void 0)},loadFromImage:function(S,O){this.meta=S.meta,v=new l(null,{name:S.name,size:S.size,type:S.type}),s.call(this,O?E=S.getAsBinaryString():S.getAsDataURL())},getInfo:function(){var S,O=this.getRuntime();return!y&&E&&O.can("access_image_binary")&&(y=new i(E)),S={width:h().width||0,height:h().height||0,type:v.type||t.getFileMime(v.name),size:E&&E.length||v.size||0,name:v.name||"",meta:null},A&&(S.meta=y&&y.meta||this.meta||{},!S.meta||!S.meta.thumb||S.meta.thumb.data instanceof e||(S.meta.thumb.data=new e(null,{type:"image/jpeg",data:S.meta.thumb.data}))),S},resize:function(S,O,F){var I=document.createElement("canvas");if(I.width=S.width,I.height=S.height,I.getContext("2d").drawImage(h(),S.x,S.y,S.width,S.height,0,0,I.width,I.height),x=r.scale(I,O),A=F.preserveHeaders,!A){var T=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;x=g(x,T)}this.width=x.width,this.height=x.height,_=!0,this.trigger("Resize")},getAsCanvas:function(){return x||(x=n()),x.id=this.uid+"_canvas",x},getAsBlob:function(S,O){return S!==this.type?(_=!0,new l(null,{name:v.name||"",type:S,data:R.getAsDataURL(S,O)})):new l(null,{name:v.name||"",type:S,data:R.getAsBinaryString(S,O)})},getAsDataURL:function(S){var O=arguments[1]||90;if(!_)return b.src;if(n(),S!=="image/jpeg")return x.toDataURL("image/png");try{return x.toDataURL("image/jpeg",O/100)}catch{return x.toDataURL("image/jpeg")}},getAsBinaryString:function(S,O){if(!_)return E||(E=o(R.getAsDataURL(S,O))),E;if(S!=="image/jpeg")E=o(R.getAsDataURL(S,O));else{var F;O||(O=90),n();try{F=x.toDataURL("image/jpeg",O/100)}catch{F=x.toDataURL("image/jpeg")}E=o(F),y&&(E=y.stripHeaders(E),A&&(y.meta&&y.meta.exif&&y.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),E=y.writeHeaders(E)),y.purge(),y=null)}return _=!1,E},destroy:function(){R=null,w.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return m.Image=d}),P("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(m,c,a,u,e){function l(){var n;try{n=navigator.plugins["Shockwave Flash"],n=n.description}catch{try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch{n="0.0"}}return n=n.match(/\d+/g),parseFloat(n[0]+"."+n[1])}function i(n){var o=a.get(n);o&&o.nodeName=="OBJECT"&&(c.browser==="IE"?(o.style.display="none",function f(){o.readyState==4?r(n):setTimeout(f,10)}()):o.parentNode.removeChild(o))}function r(n){var o=a.get(n);if(o){for(var f in o)typeof o[f]=="function"&&(o[f]=null);o.parentNode.removeChild(o)}}function t(n){var o,f=this;n=m.extend({swf_url:c.swf_url},n),e.call(this,n,d,{access_binary:function(s){return s&&f.mode==="browser"},access_image_binary:function(s){return s&&f.mode==="browser"},display_media:e.capTest(z("moxie/image/Image")),do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:function(){return f.mode==="client"},resize_image:e.capTrue,return_response_headers:!1,return_response_type:function(s){return s==="json"&&window.JSON?!0:!m.arrayDiff(s,["","text","document"])||f.mode==="browser"},return_status_code:function(s){return f.mode==="browser"||!m.arrayDiff(s,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:function(s){return s&&f.mode==="browser"},send_browser_cookies:function(s){return s&&f.mode==="browser"},send_custom_headers:function(s){return s&&f.mode==="browser"},send_multipart:e.capTrue,slice_blob:function(s){return s&&f.mode==="browser"},stream_upload:function(s){return s&&f.mode==="browser"},summon_file_dialog:!1,upload_filesize:function(s){return m.parseSizeStr(s)<=2097152||f.mode==="client"},use_http_method:function(s){return!m.arrayDiff(s,["GET","POST"])}},{access_binary:function(s){return s?"browser":"client"},access_image_binary:function(s){return s?"browser":"client"},report_upload_progress:function(s){return s?"browser":"client"},return_response_type:function(s){return m.arrayDiff(s,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(s){return m.arrayDiff(s,[200,404])?"browser":["client","browser"]},send_binary_string:function(s){return s?"browser":"client"},send_browser_cookies:function(s){return s?"browser":"client"},send_custom_headers:function(s){return s?"browser":"client"},slice_blob:function(s){return s?"browser":"client"},stream_upload:function(s){return s?"client":"browser"},upload_filesize:function(s){return m.parseSizeStr(s)>=2097152?"client":"browser"}},"client"),l()<11.3&&(this.mode=!1),m.extend(this,{getShim:function(){return a.get(this.uid)},shimExec:function(s,p){var g=[].slice.call(arguments,2);return f.getShim().exec(this.uid,s,p,g)},init:function(){var s,p,g;g=this.getShimContainer(),m.extend(g.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),s='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+n.swf_url+'" ',c.browser==="IE"&&(s+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),s+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+e.getGlobalEventTarget()+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',c.browser==="IE"?(p=document.createElement("div"),g.appendChild(p),p.outerHTML=s,p=g=null):g.innerHTML=s,o=setTimeout(function(){f&&!f.initialized&&f.trigger("Error",new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(s){return function(){i(f.uid),s.call(f),clearTimeout(o),n=o=s=f=null}}(this.destroy)},h)}var d="flash",h={};return e.addConstructor(d,t),h}),P("moxie/runtime/flash/file/Blob",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(m,c){var a={slice:function(u,e,l,i){var r=this.getRuntime();return 0>e?e=Math.max(u.size+e,0):e>0&&(e=Math.min(e,u.size)),0>l?l=Math.max(u.size+l,0):l>0&&(l=Math.min(l,u.size)),u=r.shimExec.call(this,"Blob","slice",e,l,i||""),u&&(u=new c(r.uid,u)),u}};return m.Blob=a}),P("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(m,c,a,u){var e={init:function(l){var i=this,r=this.getRuntime(),t=a.get(l.browse_button);t&&(t.setAttribute("tabindex",-1),t=null),this.bind("Change",function(){var d=r.shimExec.call(i,"FileInput","getFiles");i.files=[],u.each(d,function(h){i.files.push(new c(r.uid,h))})},999),this.getRuntime().shimExec.call(this,"FileInput","init",{accept:l.accept,multiple:l.multiple}),this.trigger("ready")}};return m.FileInput=e}),P("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(m,c){function a(e,l){switch(l){case"readAsText":return c.atob(e,"utf8");case"readAsBinaryString":return c.atob(e);case"readAsDataURL":return e}return null}var u={read:function(e,l){var i=this;return i.result="",e==="readAsDataURL"&&(i.result="data:"+(l.type||"")+";base64,"),i.bind("Progress",function(r,t){t&&(i.result+=a(t,e))},999),i.getRuntime().shimExec.call(this,"FileReader","readAsBase64",l.uid)}};return m.FileReader=u}),P("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(m,c){function a(e,l){switch(l){case"readAsText":return c.atob(e,"utf8");case"readAsBinaryString":return c.atob(e);case"readAsDataURL":return e}return null}var u={read:function(e,l){var i,r=this.getRuntime();return(i=r.shimExec.call(this,"FileReaderSync","readAsBase64",l.uid))?(e==="readAsDataURL"&&(i="data:"+(l.type||"")+";base64,"+i),a(i,e,l.type)):null}};return m.FileReaderSync=u}),P("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(m,c){var a={getAsBlob:function(u){var e=this.getRuntime(),l=e.shimExec.call(this,"Transporter","getAsBlob",u);return l?new c(e.uid,l):null}};return m.Transporter=a}),P("moxie/runtime/flash/xhr/XMLHttpRequest",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/file/File","moxie/file/FileReaderSync","moxie/runtime/flash/file/FileReaderSync","moxie/xhr/FormData","moxie/runtime/Transporter","moxie/runtime/flash/runtime/Transporter"],function(m,c,a,u,e,l,i,r){var t={send:function(d,h){function n(){d.transport=p.mode,p.shimExec.call(s,"XMLHttpRequest","send",d,h)}function o(b,y){p.shimExec.call(s,"XMLHttpRequest","appendBlob",b,y.uid),h=null,n()}function f(b,y){var x=new r;x.bind("TransportingComplete",function(){y(this.result)}),x.transport(b.getSource(),b.type,{ruid:p.uid})}var s=this,p=s.getRuntime();if(c.isEmptyObj(d.headers)||c.each(d.headers,function(b,y){p.shimExec.call(s,"XMLHttpRequest","setRequestHeader",y,b.toString())}),h instanceof i){var g;if(h.each(function(b,y){b instanceof a?g=y:p.shimExec.call(s,"XMLHttpRequest","append",y,b)}),h.hasBlob()){var w=h.getBlob();w.isDetached()?f(w,function(b){w.destroy(),o(g,b)}):o(g,w)}else h=null,n()}else h instanceof a?h.isDetached()?f(h,function(b){h.destroy(),h=b.uid,n()}):(h=h.uid,n()):n()},getResponse:function(d){var h,n,o=this.getRuntime();if(n=o.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(n=new u(o.uid,n),d==="blob")return n;try{if(h=new e,~c.inArray(d,["","text"]))return h.readAsText(n);if(d==="json"&&window.JSON)return JSON.parse(h.readAsText(n))}finally{n.destroy()}}return null},abort:function(){var d=this.getRuntime();d.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return m.XMLHttpRequest=t}),P("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(m,c,a,u,e){var l={loadFromBlob:function(i){function r(n){d.shimExec.call(t,"Image","loadFromBlob",n.uid),t=d=null}var t=this,d=t.getRuntime();if(i.isDetached()){var h=new a;h.bind("TransportingComplete",function(){r(h.result.getSource())}),h.transport(i.getSource(),i.type,{ruid:d.uid})}else r(i.getSource())},loadFromImage:function(i){var r=this.getRuntime();return r.shimExec.call(this,"Image","loadFromImage",i.uid)},getInfo:function(){var i=this.getRuntime(),r=i.shimExec.call(this,"Image","getInfo");return r.meta&&r.meta.thumb&&r.meta.thumb.data&&!(i.meta.thumb.data instanceof u)&&(r.meta.thumb.data=new u(i.uid,r.meta.thumb.data)),r},getAsBlob:function(i,r){var t=this.getRuntime(),d=t.shimExec.call(this,"Image","getAsBlob",i,r);return d?new u(t.uid,d):null},getAsDataURL:function(){var i,r=this.getRuntime(),t=r.Image.getAsBlob.apply(this,arguments);return t?(i=new e,i.readAsDataURL(t)):null}};return m.Image=l}),P("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(m,c,a,u,e){function l(d){var h,n,o,f,s,p=!1,g=null,w=0;try{try{g=new ActiveXObject("AgControl.AgControl"),g.IsVersionSupported(d)&&(p=!0),g=null}catch{var b=navigator.plugins["Silverlight Plug-In"];if(b){for(h=b.description,h==="1.0.30226.2"&&(h="2.0.30226.2"),n=h.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(o=d.split(".");o.length>4;)o.pop();do f=parseInt(o[w],10),s=parseInt(n[w],10),w++;while(w<o.length&&f===s);s>=f&&!isNaN(f)&&(p=!0)}}}catch{p=!1}return p}function i(d){var h,n=this;d=m.extend({xap_url:c.xap_url},d),e.call(this,d,r,{access_binary:e.capTrue,access_image_binary:e.capTrue,display_media:e.capTest(z("moxie/image/Image")),do_cors:e.capTrue,drag_and_drop:!1,report_upload_progress:e.capTrue,resize_image:e.capTrue,return_response_headers:function(o){return o&&n.mode==="client"},return_response_type:function(o){return o!=="json"?!0:!!window.JSON},return_status_code:function(o){return n.mode==="client"||!m.arrayDiff(o,[200,404])},select_file:e.capTrue,select_multiple:e.capTrue,send_binary_string:e.capTrue,send_browser_cookies:function(o){return o&&n.mode==="browser"},send_custom_headers:function(o){return o&&n.mode==="client"},send_multipart:e.capTrue,slice_blob:e.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:e.capTrue,use_http_method:function(o){return n.mode==="client"||!m.arrayDiff(o,["GET","POST"])}},{return_response_headers:function(o){return o?"client":"browser"},return_status_code:function(o){return m.arrayDiff(o,[200,404])?"client":["client","browser"]},send_browser_cookies:function(o){return o?"browser":"client"},send_custom_headers:function(o){return o?"client":"browser"},use_http_method:function(o){return m.arrayDiff(o,["GET","POST"])?"client":["client","browser"]}}),l("2.0.31005.0")&&c.browser!=="Opera"||(this.mode=!1),m.extend(this,{getShim:function(){return a.get(this.uid).content.Moxie},shimExec:function(o,f){var s=[].slice.call(arguments,2);return n.getShim().exec(this.uid,o,f,s)},init:function(){var o;o=this.getShimContainer(),o.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+d.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+e.getGlobalEventTarget()+'"/></object>',h=setTimeout(function(){n&&!n.initialized&&n.trigger("Error",new u.RuntimeError(u.RuntimeError.NOT_INIT_ERR))},c.OS!=="Windows"?1e4:5e3)},destroy:function(o){return function(){o.call(n),clearTimeout(h),d=h=o=n=null}}(this.destroy)},t)}var r="silverlight",t={};return e.addConstructor(r,i),t}),P("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(m,c,a){return m.Blob=c.extend({},a)}),P("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(m,c,a,u){function e(i){for(var r="",t=0;t<i.length;t++)r+=(r!==""?"|":"")+i[t].title+" | *."+i[t].extensions.replace(/,/g,";*.");return r}var l={init:function(i){var r=this,t=this.getRuntime(),d=a.get(i.browse_button);d&&(d.setAttribute("tabindex",-1),d=null),this.bind("Change",function(){var h=t.shimExec.call(r,"FileInput","getFiles");r.files=[],u.each(h,function(n){r.files.push(new c(t.uid,n))})},999),t.shimExec.call(this,"FileInput","init",e(i.accept),i.multiple),this.trigger("ready")},setOption:function(i,r){i=="accept"&&(r=e(r)),this.getRuntime().shimExec.call(this,"FileInput","setOption",i,r)}};return m.FileInput=l}),P("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(m,c,a){var u={init:function(){var e,l=this,i=l.getRuntime();return e=i.getShimContainer(),a.addEvent(e,"dragover",function(r){r.preventDefault(),r.stopPropagation(),r.dataTransfer.dropEffect="copy"},l.uid),a.addEvent(e,"dragenter",function(r){r.preventDefault();var t=c.get(i.uid).dragEnter(r);t&&r.stopPropagation()},l.uid),a.addEvent(e,"drop",function(r){r.preventDefault();var t=c.get(i.uid).dragDrop(r);t&&r.stopPropagation()},l.uid),i.shimExec.call(this,"FileDrop","init")}};return m.FileDrop=u}),P("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(m,c,a){return m.FileReader=c.extend({},a)}),P("moxie/runtime/silverlight/file/FileReaderSync",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(m,c,a){return m.FileReaderSync=c.extend({},a)}),P("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(m,c,a){return m.Transporter=c.extend({},a)}),P("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(m,c,a){return m.XMLHttpRequest=c.extend({},a)}),P("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(m,c,a,u){return m.Image=c.extend({},u,{getInfo:function(){var e=this.getRuntime(),l=["tiff","exif","gps","thumb"],i={meta:{}},r=e.shimExec.call(this,"Image","getInfo");return r.meta&&(c.each(l,function(t){var d,h,n,o,f=r.meta[t];if(f&&f.keys)for(i.meta[t]={},h=0,n=f.keys.length;n>h;h++)d=f.keys[h],o=f[d],o&&(/^(\d|[1-9]\d+)$/.test(o)?o=parseInt(o,10):/^\d*\.\d+$/.test(o)&&(o=parseFloat(o)),i.meta[t][d]=o)}),i.meta&&i.meta.thumb&&i.meta.thumb.data&&!(e.meta.thumb.data instanceof a)&&(i.meta.thumb.data=new a(e.uid,i.meta.thumb.data))),i.width=parseInt(r.width,10),i.height=parseInt(r.height,10),i.size=parseInt(r.size,10),i.type=r.type,i.name=r.name,i},resize:function(e,l,i){this.getRuntime().shimExec.call(this,"Image","resize",e.x,e.y,e.width,e.height,l,i.preserveHeaders,i.resample)}})}),P("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(m,c,a,u){function e(r){var t=this,d=a.capTest,h=a.capTrue;a.call(this,r,l,{access_binary:d(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:d((u.can("create_canvas")||u.can("use_data_uri_over32kb"))&&z("moxie/image/Image")),do_cors:!1,drag_and_drop:!1,filter_by_extension:d(function(){return!(u.browser==="Chrome"&&u.verComp(u.version,28,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<")||u.browser==="Safari"&&u.verComp(u.version,7,"<")||u.browser==="Firefox"&&u.verComp(u.version,37,"<"))}()),resize_image:function(){return i.Image&&t.can("access_binary")&&u.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(n){return n==="json"&&window.JSON?!0:!!~m.inArray(n,["text","document",""])},return_status_code:function(n){return!m.arrayDiff(n,[200,404])},select_file:function(){return u.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return t.can("select_file")},summon_file_dialog:function(){return t.can("select_file")&&!(u.browser==="Firefox"&&u.verComp(u.version,4,"<")||u.browser==="Opera"&&u.verComp(u.version,12,"<")||u.browser==="IE"&&u.verComp(u.version,10,"<"))},upload_filesize:h,use_http_method:function(n){return!m.arrayDiff(n,["GET","POST"])}}),m.extend(this,{init:function(){this.trigger("Init")},destroy:function(n){return function(){n.call(t),n=t=null}}(this.destroy)}),m.extend(this.getShim(),i)}var l="html4",i={};return a.addConstructor(l,e),i}),P("moxie/runtime/html4/file/FileInput",["moxie/runtime/html4/Runtime","moxie/file/File","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Events","moxie/core/utils/Mime","moxie/core/utils/Env"],function(m,c,a,u,e,l,i){function r(){function t(){var f,s,p,g,w,b,y=this,x=y.getRuntime();b=a.guid("uid_"),f=x.getShimContainer(),d&&(p=u.get(d+"_form"),p&&(a.extend(p.style,{top:"100%"}),p.firstChild.setAttribute("tabindex",-1))),g=document.createElement("form"),g.setAttribute("id",b+"_form"),g.setAttribute("method","post"),g.setAttribute("enctype","multipart/form-data"),g.setAttribute("encoding","multipart/form-data"),a.extend(g.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),w=document.createElement("input"),w.setAttribute("id",b),w.setAttribute("type","file"),w.setAttribute("accept",o.join(",")),x.can("summon_file_dialog")&&w.setAttribute("tabindex",-1),a.extend(w.style,{fontSize:"999px",opacity:0}),g.appendChild(w),f.appendChild(g),a.extend(w.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),i.browser==="IE"&&i.verComp(i.version,10,"<")&&a.extend(w.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),w.onchange=function(){var E;this.value&&(E=this.files?this.files[0]:{name:this.value},E=new c(x.uid,E),this.onchange=function(){},t.call(y),y.files=[E],w.setAttribute("id",E.uid),g.setAttribute("id",E.uid+"_form"),y.trigger("change"),w=g=null)},x.can("summon_file_dialog")&&(s=u.get(h.browse_button),e.removeEvent(s,"click",y.uid),e.addEvent(s,"click",function(E){w&&!w.disabled&&w.click(),E.preventDefault()},y.uid)),d=b,f=p=s=null}var d,h,n,o=[];a.extend(this,{init:function(f){var s,p=this,g=p.getRuntime();h=f,o=l.extList2mimes(f.accept,g.can("filter_by_extension")),s=g.getShimContainer(),function(){var w,b,y;w=u.get(f.browse_button),n=u.getStyle(w,"z-index")||"auto",g.can("summon_file_dialog")?(u.getStyle(w,"position")==="static"&&(w.style.position="relative"),p.bind("Refresh",function(){b=parseInt(n,10)||1,u.get(h.browse_button).style.zIndex=b,this.getRuntime().getShimContainer().style.zIndex=b-1})):w.setAttribute("tabindex",-1),y=g.can("summon_file_dialog")?w:s,e.addEvent(y,"mouseover",function(){p.trigger("mouseenter")},p.uid),e.addEvent(y,"mouseout",function(){p.trigger("mouseleave")},p.uid),e.addEvent(y,"mousedown",function(){p.trigger("mousedown")},p.uid),e.addEvent(u.get(f.container),"mouseup",function(){p.trigger("mouseup")},p.uid),w=null}(),t.call(this),s=null,p.trigger({type:"ready",async:!0})},setOption:function(f,s){var p,g=this.getRuntime();f=="accept"&&(o=s.mimes||l.extList2mimes(s,g.can("filter_by_extension"))),p=u.get(d),p&&p.setAttribute("accept",o.join(","))},disable:function(f){var s;(s=u.get(d))&&(s.disabled=!!f)},destroy:function(){var f=this.getRuntime(),s=f.getShim(),p=f.getShimContainer(),g=h&&u.get(h.container),w=h&&u.get(h.browse_button);g&&e.removeAllEvents(g,this.uid),w&&(e.removeAllEvents(w,this.uid),w.style.zIndex=n),p&&(e.removeAllEvents(p,this.uid),p.innerHTML=""),s.removeInstance(this.uid),d=o=h=p=g=w=s=null}})}return m.FileInput=r}),P("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(m,c){return m.FileReader=c}),P("moxie/runtime/html4/xhr/XMLHttpRequest",["moxie/runtime/html4/Runtime","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/utils/Url","moxie/core/Exceptions","moxie/core/utils/Events","moxie/file/Blob","moxie/xhr/FormData"],function(m,c,a,u,e,l,i,r){function t(){function d(f){var s,p,g,w,b=this,y=!1;if(o){if(s=o.id.replace(/_iframe$/,""),p=a.get(s+"_form")){for(g=p.getElementsByTagName("input"),w=g.length;w--;)switch(g[w].getAttribute("type")){case"hidden":g[w].parentNode.removeChild(g[w]);break;case"file":y=!0}g=[],y||p.parentNode.removeChild(p),p=null}setTimeout(function(){l.removeEvent(o,"load",b.uid),o.parentNode&&o.parentNode.removeChild(o);var x=b.getRuntime().getShimContainer();x.children.length||x.parentNode.removeChild(x),x=o=null,f()},1)}}var h,n,o;c.extend(this,{send:function(f,s){function p(){var v=E.getShimContainer()||document.body,R=document.createElement("div");R.innerHTML='<iframe id="'+g+'_iframe" name="'+g+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',o=R.firstChild,v.appendChild(o),l.addEvent(o,"load",function(){var _;try{_=o.contentWindow.document||o.contentDocument||window.frames[o.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(_.title)?h=_.title.replace(/^(\d+).*$/,"$1"):(h=200,n=c.trim(_.body.innerHTML),x.trigger({type:"progress",loaded:n.length,total:n.length}),y&&x.trigger({type:"uploadprogress",loaded:y.size||1025,total:y.size||1025}))}catch{if(!u.hasSameOrigin(f.url))return d.call(x,function(){x.trigger("error")}),void 0;h=404}d.call(x,function(){x.trigger("load")})},x.uid)}var g,w,b,y,x=this,E=x.getRuntime();if(h=n=null,s instanceof r&&s.hasBlob()){if(y=s.getBlob(),g=y.uid,b=a.get(g),w=a.get(g+"_form"),!w)throw new e.DOMException(e.DOMException.NOT_FOUND_ERR)}else g=c.guid("uid_"),w=document.createElement("form"),w.setAttribute("id",g+"_form"),w.setAttribute("method",f.method),w.setAttribute("enctype","multipart/form-data"),w.setAttribute("encoding","multipart/form-data"),E.getShimContainer().appendChild(w);w.setAttribute("target",g+"_iframe"),s instanceof r&&s.each(function(v,R){if(v instanceof i)b&&b.setAttribute("name",R);else{var _=document.createElement("input");c.extend(_,{type:"hidden",name:R,value:v}),b?w.insertBefore(_,b):w.appendChild(_)}}),w.setAttribute("action",f.url),p(),w.submit(),x.trigger("loadstart")},getStatus:function(){return h},getResponse:function(f){if(f==="json"&&c.typeOf(n)==="string"&&window.JSON)try{return JSON.parse(n.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch{return null}return n},abort:function(){var f=this;o&&o.contentWindow&&(o.contentWindow.stop?o.contentWindow.stop():o.contentWindow.document.execCommand?o.contentWindow.document.execCommand("Stop"):o.src="about:blank"),d.call(this,function(){f.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}return m.XMLHttpRequest=t}),P("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(m,c){return m.Image=c}),Q(["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Dom","moxie/core/EventTarget","moxie/runtime/Runtime","moxie/runtime/RuntimeClient","moxie/file/Blob","moxie/core/I18n","moxie/core/utils/Mime","moxie/file/FileInput","moxie/file/File","moxie/file/FileDrop","moxie/file/FileReader","moxie/core/utils/Url","moxie/runtime/RuntimeTarget","moxie/xhr/FormData","moxie/xhr/XMLHttpRequest","moxie/image/Image","moxie/core/utils/Events","moxie/runtime/html5/image/ResizerCanvas"])})(this)}),function($,J){var W=function(){var P={};return J.apply(P,arguments),P.plupload};K.exports?K.exports=W(ae()):$.plupload=W($.moxie)}(re||window,function($){(function(J,W,P){function z(a){function u(i,r,t){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};d[i]?l[d[i]]=r:t||(l[i]=r)}var e=a.required_features,l={};return typeof e=="string"?c.each(e.split(/\s*,\s*/),function(i){u(i,!0)}):typeof e=="object"?c.each(e,function(i,r){u(r,i)}):e===!0&&(a.chunk_size&&a.chunk_size>0&&(l.slice_blob=!0),c.isEmptyObj(a.resize)&&a.multipart!==!1||(l.send_binary_string=!0),a.http_method&&(l.use_http_method=a.http_method),c.each(a,function(i,r){u(r,!!i,!0)})),l}var Z=window.setTimeout,Q={},Y=W.core.utils,m=W.runtime.Runtime,c={VERSION:"2.3.6",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,moxie:W,mimeTypes:Y.Mime.mimes,ua:Y.Env,typeOf:Y.Basic.typeOf,extend:Y.Basic.extend,guid:Y.Basic.guid,getAll:function(a){var u,e=[];c.typeOf(a)!=="array"&&(a=[a]);for(var l=a.length;l--;)u=c.get(a[l]),u&&e.push(u);return e.length?e:null},get:Y.Dom.get,each:Y.Basic.each,getPos:Y.Dom.getPos,getSize:Y.Dom.getSize,xmlEncode:function(a){var u={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},e=/[<>&\"\']/g;return a&&(""+a).replace(e,function(l){return u[l]?"&"+u[l]+";":l})},toArray:Y.Basic.toArray,inArray:Y.Basic.inArray,inSeries:Y.Basic.inSeries,addI18n:W.core.I18n.addI18n,translate:W.core.I18n.translate,sprintf:Y.Basic.sprintf,isEmptyObj:Y.Basic.isEmptyObj,hasClass:Y.Dom.hasClass,addClass:Y.Dom.addClass,removeClass:Y.Dom.removeClass,getStyle:Y.Dom.getStyle,addEvent:Y.Events.addEvent,removeEvent:Y.Events.removeEvent,removeAllEvents:Y.Events.removeAllEvents,cleanName:function(a){var u,e;for(e=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],u=0;u<e.length;u+=2)a=a.replace(e[u],e[u+1]);return a=a.replace(/\s+/g,"_"),a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(a,u){var e="";return c.each(u,function(l,i){e+=(e?"&":"")+encodeURIComponent(i)+"="+encodeURIComponent(l)}),e&&(a+=(a.indexOf("?")>0?"&":"?")+e),a},formatSize:function(a){function u(l,i){return Math.round(l*Math.pow(10,i))/Math.pow(10,i)}if(a===P||/\D/.test(a))return c.translate("N/A");var e=Math.pow(1024,4);return a>e?u(a/e,1)+" "+c.translate("tb"):a>(e/=1024)?u(a/e,1)+" "+c.translate("gb"):a>(e/=1024)?u(a/e,1)+" "+c.translate("mb"):a>1024?Math.round(a/1024)+" "+c.translate("kb"):a+" "+c.translate("b")},parseSize:Y.Basic.parseSizeStr,predictRuntime:function(a,u){var e,l;return e=new c.Uploader(a),l=m.thatCan(e.getOption().required_features,u||a.runtimes),e.destroy(),l},addFileFilter:function(a,u){Q[a]=u}};c.addFileFilter("mime_types",function(a,u,e){a.length&&!a.regexp.test(u.name)?(this.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:u}),e(!1)):e(!0)}),c.addFileFilter("max_file_size",function(a,u,e){var l;a=c.parseSize(a),u.size!==l&&a&&u.size>a?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:u}),e(!1)):e(!0)}),c.addFileFilter("prevent_duplicates",function(a,u,e){if(a){for(var l=this.files.length;l--;)if(u.name===this.files[l].name&&u.size===this.files[l].size)return this.trigger("Error",{code:c.FILE_DUPLICATE_ERROR,message:c.translate("Duplicate file error."),file:u}),e(!1),void 0}e(!0)}),c.addFileFilter("prevent_empty",function(a,u,e){a&&!u.size&&u.size!==P?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:u}),e(!1)):e(!0)}),c.Uploader=function(a){function u(){var I,T,C=0;if(this.state==c.STARTED){for(T=0;T<_.length;T++)I||_[T].status!=c.QUEUED?C++:(I=_[T],this.trigger("BeforeUpload",I)&&(I.status=c.UPLOADING,this.trigger("UploadFile",I)));C==_.length&&(this.state!==c.STOPPED&&(this.state=c.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",_))}}function e(I){I.percent=I.size>0?Math.ceil(100*(I.loaded/I.size)):100,l()}function l(){var I,T,C,N=0;for(E.reset(),I=0;I<_.length;I++)T=_[I],T.size!==P?(E.size+=T.origSize,C=T.loaded*T.origSize/T.size,(!T.completeTimestamp||T.completeTimestamp>x)&&(N+=C),E.loaded+=C):E.size=P,T.status==c.DONE?E.uploaded++:T.status==c.FAILED?E.failed++:E.queued++;E.size===P?E.percent=_.length>0?Math.ceil(100*(E.uploaded/_.length)):0:(E.bytesPerSec=Math.ceil(N/((+new Date-x||1)/1e3)),E.percent=E.size>0?Math.ceil(100*(E.loaded/E.size)):0)}function i(){var I=S[0]||O[0];return I?I.getRuntime().uid:!1}function r(){this.bind("FilesAdded FilesRemoved",function(I){I.trigger("QueueChanged"),I.refresh()}),this.bind("CancelUpload",p),this.bind("BeforeUpload",n),this.bind("UploadFile",o),this.bind("UploadProgress",f),this.bind("StateChanged",s),this.bind("QueueChanged",l),this.bind("Error",w),this.bind("FileUploaded",g),this.bind("Destroy",b)}function t(I,T){var C=this,N=0,H=[],q={runtime_order:I.runtimes,required_caps:I.required_features,preferred_caps:A,swf_url:I.flash_swf_url,xap_url:I.silverlight_xap_url};c.each(I.runtimes.split(/\s*,\s*/),function(B){I[B]&&(q[B]=I[B])}),I.browse_button&&c.each(I.browse_button,function(B){H.push(function(L){var U=new W.file.FileInput(c.extend({},q,{accept:I.filters.mime_types,name:I.file_data_name,multiple:I.multi_selection,container:I.container,browse_button:B}));U.onready=function(){var j=m.getInfo(this.ruid);c.extend(C.features,{chunks:j.can("slice_blob"),multipart:j.can("send_multipart"),multi_selection:j.can("select_multiple")}),N++,S.push(this),L()},U.onchange=function(){C.addFile(this.files)},U.bind("mouseenter mouseleave mousedown mouseup",function(j){F||(I.browse_button_hover&&(j.type==="mouseenter"?c.addClass(B,I.browse_button_hover):j.type==="mouseleave"&&c.removeClass(B,I.browse_button_hover)),I.browse_button_active&&(j.type==="mousedown"?c.addClass(B,I.browse_button_active):j.type==="mouseup"&&c.removeClass(B,I.browse_button_active)))}),U.bind("mousedown",function(){C.trigger("Browse")}),U.bind("error runtimeerror",function(){U=null,L()}),U.init()})}),I.drop_element&&c.each(I.drop_element,function(B){H.push(function(L){var U=new W.file.FileDrop(c.extend({},q,{drop_zone:B}));U.onready=function(){var j=m.getInfo(this.ruid);c.extend(C.features,{chunks:j.can("slice_blob"),multipart:j.can("send_multipart"),dragdrop:j.can("drag_and_drop")}),N++,O.push(this),L()},U.ondrop=function(){C.addFile(this.files)},U.bind("error runtimeerror",function(){U=null,L()}),U.init()})}),c.inSeries(H,function(){typeof T=="function"&&T(N)})}function d(I,T,C,N){var H=new W.image.Image;try{H.onload=function(){T.width>this.width&&T.height>this.height&&T.quality===P&&T.preserve_headers&&!T.crop?(this.destroy(),N(I)):H.downsize(T.width,T.height,T.crop,T.preserve_headers)},H.onresize=function(){var q=this.getAsBlob(I.type,T.quality);this.destroy(),N(q)},H.bind("error runtimeerror",function(){this.destroy(),N(I)}),H.load(I,C)}catch{N(I)}}function h(I,T,C){function N(B,L,U){var j=y[B];switch(B){case"max_file_size":B==="max_file_size"&&(y.max_file_size=y.filters.max_file_size=L);break;case"chunk_size":(L=c.parseSize(L))&&(y[B]=L,y.send_file_name=!0);break;case"multipart":y[B]=L,L||(y.send_file_name=!0);break;case"http_method":y[B]=L.toUpperCase()==="PUT"?"PUT":"POST";break;case"unique_names":y[B]=L,L&&(y.send_file_name=!0);break;case"filters":c.typeOf(L)==="array"&&(L={mime_types:L}),U?c.extend(y.filters,L):y.filters=L,L.mime_types&&(c.typeOf(L.mime_types)==="string"&&(L.mime_types=W.core.utils.Mime.mimes2extList(L.mime_types)),L.mime_types.regexp=function(D){var M=[];return c.each(D,function(G){c.each(G.extensions.split(/,/),function(X){/^\s*\*\s*$/.test(X)?M.push("\\.*"):M.push("\\."+X.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+M.join("|")+")$","i")}(L.mime_types),y.filters.mime_types=L.mime_types);break;case"resize":y.resize=L?c.extend({preserve_headers:!0,crop:!1},L):!1;break;case"prevent_duplicates":y.prevent_duplicates=y.filters.prevent_duplicates=!!L;break;case"container":case"browse_button":case"drop_element":L=B==="container"?c.get(L):c.getAll(L);case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":y[B]=L,U||(q=!0);break;default:y[B]=L}U||H.trigger("OptionChanged",B,L,j)}var H=this,q=!1;typeof I=="object"?c.each(I,function(B,L){N(L,B,C)}):N(I,T,C),C?(y.required_features=z(c.extend({},y)),A=z(c.extend({},y,{required_features:!0}))):q&&(H.trigger("Destroy"),t.call(H,y,function(B){B?(H.runtime=m.getInfo(i()).type,H.trigger("Init",{runtime:H.runtime}),H.trigger("PostInit")):H.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}))}function n(I,T){if(I.settings.unique_names){var C=T.name.match(/\.([^.]+)$/),N="part";C&&(N=C[1]),T.target_name=T.id+"."+N}}function o(I,T){function C(){U-- >0?Z(N,1e3):(T.loaded=D,I.trigger("Error",{code:c.HTTP_ERROR,message:c.translate("HTTP Error."),file:T,response:v.responseText,status:v.status,responseHeaders:v.getAllResponseHeaders()}))}function N(){var G,X,V={};T.status===c.UPLOADING&&I.state!==c.STOPPED&&(I.settings.send_file_name&&(V.name=T.target_name||T.name),L&&j.chunks&&q.size>L?(X=Math.min(L,q.size-D),G=q.slice(D,D+X)):(X=q.size,G=q),L&&j.chunks&&(I.settings.send_chunk_number?(V.chunk=Math.ceil(D/L),V.chunks=Math.ceil(q.size/L)):(V.offset=D,V.total=q.size)),I.trigger("BeforeChunkUpload",T,V,G,D)&&H(V,G,X))}function H(G,X,V){var k;v=new W.xhr.XMLHttpRequest,v.upload&&(v.upload.onprogress=function(ee){T.loaded=Math.min(T.size,D+ee.loaded),I.trigger("UploadProgress",T)}),v.onload=function(){return v.status<200||v.status>=400?(C(),void 0):(U=I.settings.max_retries,V<q.size?(X.destroy(),D+=V,T.loaded=Math.min(D,q.size),I.trigger("ChunkUploaded",T,{offset:T.loaded,total:q.size,response:v.responseText,status:v.status,responseHeaders:v.getAllResponseHeaders()}),c.ua.browser==="Android Browser"&&I.trigger("UploadProgress",T)):T.loaded=T.size,X=k=null,!D||D>=q.size?(T.size!=T.origSize&&(q.destroy(),q=null),I.trigger("UploadProgress",T),T.status=c.DONE,T.completeTimestamp=+new Date,I.trigger("FileUploaded",T,{response:v.responseText,status:v.status,responseHeaders:v.getAllResponseHeaders()})):Z(N,1),void 0)},v.onerror=function(){C()},v.onloadend=function(){this.destroy()},I.settings.multipart&&j.multipart?(v.open(I.settings.http_method,B,!0),c.each(I.settings.headers,function(ee,te){v.setRequestHeader(te,ee)}),k=new W.xhr.FormData,c.each(c.extend(G,I.settings.multipart_params),function(ee,te){k.append(te,ee)}),k.append(I.settings.file_data_name,X),v.send(k,M)):(B=c.buildUrl(I.settings.url,c.extend(G,I.settings.multipart_params)),v.open(I.settings.http_method,B,!0),c.each(I.settings.headers,function(ee,te){v.setRequestHeader(te,ee)}),v.hasRequestHeader("Content-Type")||v.setRequestHeader("Content-Type","application/octet-stream"),v.send(X,M))}var q,B=I.settings.url,L=I.settings.chunk_size,U=I.settings.max_retries,j=I.features,D=0,M={runtime_order:I.settings.runtimes,required_caps:I.settings.required_features,preferred_caps:A,swf_url:I.settings.flash_swf_url,xap_url:I.settings.silverlight_xap_url};T.loaded&&(D=T.loaded=L?L*Math.floor(T.loaded/L):0),q=T.getSource(),c.isEmptyObj(I.settings.resize)||c.inArray(q.type,["image/jpeg","image/png"])===-1?N():d(q,I.settings.resize,M,function(G){q=G,T.size=G.size,N()})}function f(I,T){e(T)}function s(I){if(I.state==c.STARTED)x=+new Date;else if(I.state==c.STOPPED)for(var T=I.files.length-1;T>=0;T--)I.files[T].status==c.UPLOADING&&(I.files[T].status=c.QUEUED,l())}function p(){v&&v.abort()}function g(I){l(),Z(function(){u.call(I)},1)}function w(I,T){T.code===c.INIT_ERROR?I.destroy():T.code===c.HTTP_ERROR&&(T.file.status=c.FAILED,T.file.completeTimestamp=+new Date,e(T.file),I.state==c.STARTED&&(I.trigger("CancelUpload"),Z(function(){u.call(I)},1)))}function b(I){I.stop(),c.each(_,function(T){T.destroy()}),_=[],S.length&&(c.each(S,function(T){T.destroy()}),S=[]),O.length&&(c.each(O,function(T){T.destroy()}),O=[]),A={},F=!1,x=v=null,E.reset()}var y,x,E,v,R=c.guid(),_=[],A={},S=[],O=[],F=!1;y={chunk_size:0,file_data_name:"file",filters:{mime_types:[],max_file_size:0,prevent_duplicates:!1,prevent_empty:!0},flash_swf_url:"js/Moxie.swf",http_method:"POST",max_retries:0,multipart:!0,multi_selection:!0,resize:!1,runtimes:m.order,send_file_name:!0,send_chunk_number:!0,silverlight_xap_url:"js/Moxie.xap"},h.call(this,a,null,!0),E=new c.QueueProgress,c.extend(this,{id:R,uid:R,state:c.STOPPED,features:{},runtime:null,files:_,settings:y,total:E,init:function(){var I,T,C=this;return I=C.getOption("preinit"),typeof I=="function"?I(C):c.each(I,function(N,H){C.bind(H,N)}),r.call(C),c.each(["container","browse_button","drop_element"],function(N){return C.getOption(N)===null?(T={code:c.INIT_ERROR,message:c.sprintf(c.translate("%s specified, but cannot be found."),N)},!1):void 0}),T?C.trigger("Error",T):y.browse_button||y.drop_element?(t.call(C,y,function(N){var H=C.getOption("init");typeof H=="function"?H(C):c.each(H,function(q,B){C.bind(B,q)}),N?(C.runtime=m.getInfo(i()).type,C.trigger("Init",{runtime:C.runtime}),C.trigger("PostInit")):C.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}),void 0):C.trigger("Error",{code:c.INIT_ERROR,message:c.translate("You must specify either browse_button or drop_element.")})},setOption:function(I,T){h.call(this,I,T,!this.runtime)},getOption:function(I){return I?y[I]:y},refresh:function(){S.length&&c.each(S,function(I){I.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),u.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=c.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){F=arguments[0]!==P?arguments[0]:!0,S.length&&c.each(S,function(I){I.disable(F)}),this.trigger("DisableBrowse",F)},getFile:function(I){var T;for(T=_.length-1;T>=0;T--)if(_[T].id===I)return _[T]},addFile:function(I,T){function C(U,j){var D=[];c.each(q.settings.filters,function(M,G){Q[G]&&D.push(function(X){Q[G].call(q,M,U,function(V){X(!V)})})}),c.inSeries(D,j)}function N(U){var j=c.typeOf(U);if(U instanceof W.file.File){if(!U.ruid&&!U.isDetached()){if(!H)return!1;U.ruid=H,U.connectRuntime(H)}N(new c.File(U))}else U instanceof W.file.Blob?(N(U.getSource()),U.destroy()):U instanceof c.File?(T&&(U.name=T),B.push(function(D){C(U,function(M){M||(_.push(U),L.push(U),q.trigger("FileFiltered",U)),Z(D,1)})})):c.inArray(j,["file","blob"])!==-1?N(new W.file.File(null,U)):j==="node"&&c.typeOf(U.files)==="filelist"?c.each(U.files,N):j==="array"&&(T=null,c.each(U,N))}var H,q=this,B=[],L=[];H=i(),N(I),B.length&&c.inSeries(B,function(){L.length&&q.trigger("FilesAdded",L)})},removeFile:function(I){for(var T=typeof I=="string"?I:I.id,C=_.length-1;C>=0;C--)if(_[C].id===T)return this.splice(C,1)[0]},splice:function(I,T){var C=_.splice(I===P?0:I,T===P?_.length:T),N=!1;return this.state==c.STARTED&&(c.each(C,function(H){return H.status===c.UPLOADING?(N=!0,!1):void 0}),N&&this.stop()),this.trigger("FilesRemoved",C),c.each(C,function(H){H.destroy()}),N&&this.start(),C},dispatchEvent:function(I){var T,C;if(I=I.toLowerCase(),T=this.hasEventListener(I)){T.sort(function(H,q){return q.priority-H.priority}),C=[].slice.call(arguments),C.shift(),C.unshift(this);for(var N=0;N<T.length;N++)if(T[N].fn.apply(T[N].scope,C)===!1)return!1}return!0},bind:function(I,T,C,N){c.Uploader.prototype.bind.call(this,I,T,N,C)},destroy:function(){this.trigger("Destroy"),y=E=null,this.unbindAll()}})},c.Uploader.prototype=W.core.EventTarget.instance,c.File=function(){function a(e){c.extend(this,{id:c.guid(),name:e.name||e.fileName,type:e.type||"",relativePath:e.relativePath||"",size:e.fileSize||e.size,origSize:e.fileSize||e.size,loaded:0,percent:0,status:c.QUEUED,lastModifiedDate:e.lastModifiedDate||new Date().toLocaleString(),completeTimestamp:0,getNative:function(){var l=this.getSource().getSource();return c.inArray(c.typeOf(l),["blob","file"])!==-1?l:null},getSource:function(){return u[this.id]?u[this.id]:null},destroy:function(){var l=this.getSource();l&&(l.destroy(),delete u[this.id])}}),u[this.id]=e}var u={};return a}(),c.QueueProgress=function(){var a=this;a.size=0,a.loaded=0,a.uploaded=0,a.failed=0,a.queued=0,a.percent=0,a.bytesPerSec=0,a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},J.plupload=c})(this,$)})})(oe);var ue=oe.exports;const ce=se(ue);export{ce as p};
