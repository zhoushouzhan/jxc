import{a as c,r as R,p as T,z as C,E,y as L,L as h,o as O,b as x,d as n,e as u,f as y,h as m,i as e,n as I,F as p,q as N,v,j as g,l as B,g as D}from"./index-ddd32adc.js";import M from"./form-2fb73b81.js";import U from"./ruleChild-2a6c95b6.js";import V from"./ruleItem-bc2a7fc0.js";const $={class:"flex items-center"},z=["innerHTML"],F=e("div",{class:"text-gray-400"},null,-1),H=e("div",{class:"flex-1"},null,-1),J=e("div",{class:"flex border-b bg-gray-100 leading-8 font-bold"},[e("div",{class:"text-center md:w-20 border-r w-8"},"ID"),e("div",{class:"md:w-48 pl-2 flex-1 md:flex-initial"},"菜单名称"),e("div",{class:"md:w-32 pl-2 hidden md:block"},"类型"),e("div",{class:"md:w-32 pl-2 hidden md:block text-center"},"图标"),e("div",{class:"md:w-32 pl-2 hidden md:block text-center"},"排序"),e("div",{class:"md:w-32 pl-2 hidden md:block text-center"},"状态"),e("div",{class:"w-40 text-center px-1"},"操作")],-1),Q={__name:"index",setup(j){const i=c(""),f=c("增加菜单"),o=c(!1),d=c(0),s=R({path:[]}),b=async()=>{d.value=0,o.value=!0},k=t=>{d.value=t,f.value="编辑菜单",o.value=!0},r=async()=>{const t=await D("rule/index");i.value=t.data};return T("setcom",{item:{},openedRules:s,edit:t=>{k(t)},destory:t=>{C({text:"确认删除吗？"}).then(async()=>{const l=await E("rule/delete",{id:t});l.code==1&&(L({type:"alter-success",text:l.msg}),r(),h.commit("User/SET_ROUTE",i.value))}).catch(l=>{})},update:async()=>{await r(),h.commit("User/SET_ROUTE",i.value)},clickSubMenu:t=>{s.path.includes(t)?(s.path.splice(s.path.indexOf(t),1),s.path=s.path.filter(l=>l.indexOf(t+"/")!==0)):s.path.push(t),sessionStorage.setItem("openRules",JSON.stringify(s.path))}}),O(async()=>{sessionStorage.getItem("openRules")&&(s.path=JSON.parse(sessionStorage.getItem("openRules"))),r()}),(t,l)=>{const w=x("yplayout"),S=x("ypdialog");return n(),u(p,null,[y(w,null,{header:m(a=>[e("div",$,[e("i",{class:I(["ri-2x text-gray-500 ml-2",a.meta.icon||"ri-information-line"])},null,2),e("div",{class:"text-xl px-2",innerHTML:a.meta.title},null,8,z),F]),H,e("button",{class:"btn btn-lan",type:"button",onClick:b}," 增加菜单 ")]),list:m(()=>[e("div",null,[J,(n(!0),u(p,null,N(i.value,(a,_)=>(n(),u(p,null,[a.children&&a.children.length>0?(n(),v(g(U),{item:a,key:_,basePath:a.id,leave:0},null,8,["item","basePath"])):(n(),v(g(V),{item:a,key:_+1,leave:0},null,8,["item"]))],64))),256))])]),_:1}),o.value?(n(),v(S,{key:0,width:"800",title:f.value,mask:1,onClose:l[0]||(l[0]=a=>o.value=!1)},{default:m(()=>[y(M,{id:d.value},null,8,["id"])]),_:1},8,["title"])):B("",!0)],64)}}};export{Q as default};
