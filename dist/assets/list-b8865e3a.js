import{u as J,a as _,r as k,w as K,o as Q,b as $,c as W,d as o,v as X,h as L,i as e,n as m,k as D,e as l,t as u,l as b,m as P,f,F as Y,q as Z,g as T,y as B,z as tt,E as et,A as st}from"./index-ddd32adc.js";const nt=e("i",{class:"ri-2x ri-database-2-line text-gray-500 ml-2"},null,-1),at=["innerHTML"],ot={class:"flex items-center justify-between"},lt={class:"space-x-2"},dt={class:"flex space-x-2"},rt={class:"table-auto w-full text-sm"},ct={class:"bg-gray-100"},it={class:"px-2 py-2 border w-10 font-thin"},ut=e("th",{class:"px-2 py-2 border w-10 text-center"},"ID",-1),pt=e("th",{class:"px-2 py-2 border w-44 text-center max-lg:hidden"},"单号",-1),mt=e("th",{class:"px-2 py-2 border text-left"},"操作员",-1),bt=e("th",{class:"px-2 py-2 border w-32"},"库存",-1),gt=e("th",{class:"px-2 py-2 border w-32"},"状态",-1),xt=e("th",{class:"px-2 py-2 border w-44 max-lg:hidden"},"录入时间",-1),_t=e("th",{class:"px-2 py-2 border text-center"},"操作",-1),ht={class:"border px-2"},yt={class:"border px-2 text-center"},vt={class:"border px-2 max-lg:hidden"},kt={class:"border px-2 space-x-2 text-sm"},ft={class:"border px-2 text-center"},Ct={class:"border px-2 text-center"},wt={key:0,class:"bg-red-400 text-white px-2 py-[2px] rounded"},Vt={key:1,class:"bg-green-700 text-white px-2 py-[2px] rounded"},$t={class:"border px-2 max-lg:hidden"},Dt={class:"border px-2 py-2 text-center"},Pt=["onClick"],jt=["onClick"],zt=["onClick"],Lt=["onClick"],Tt={class:"border p-2"},Bt={class:"border p-2",colspan:"8"},Nt={key:0,class:"mt-3"},Mt={__name:"list",props:{page:{default:0}},emits:["jumpCom"],setup(N,{emit:E}){const I=N,d=E,M=J().meta,r=_(1),c=_(null),R=_(!1),C=_(0),w=_(0),a=k({totalRecords:0,pageCount:0,currentPage:I.page}),U=t=>{a.currentPage=t,v()},h=k([]),i=k([]),g=k([]);K(g,(t,s)=>{i.length=0,t.length>0?h.forEach(p=>{i.push(p.id)}):i.length=0});const y=(t,s)=>{r.value=t,c.value=s,v()},A=t=>{t.type==1&&d("jumpCom",{to:"in",id:t.id,page:a.currentPage}),t.type==3&&d("jumpCom",{to:"move",id:t.id,page:a.currentPage})},F=t=>{t.type==1&&d("jumpCom",{to:"view",id:t.id,page:a.currentPage}),t.type==3&&d("jumpCom",{to:"moveview",id:t.id,page:a.currentPage})},H=t=>{t.type==1&&d("jumpCom",{to:"checkorder",id:t.id,page:a.currentPage}),t.type==3&&d("jumpCom",{to:"checkmove",id:t.id,page:a.currentPage})},v=async()=>{let t=await T("kucundan/index",{page:a.currentPage,type:r.value,enabled:c.value});if(t.code==1){a.currentPage=t.data.current_page,a.pageCount=t.data.last_page,a.totalRecords=t.data.total,h.length=0;for(let s in t.data.data)h[s]=t.data.data[s]}},j=t=>{if(t==0&&(t=i.length?i:0),!t){B({type:"alter-error",text:"请选择项目"});return}tt({text:"确认删除吗？"}).then(async()=>{const s=await et("kucundan/delete",{ids:t});s.code&&(B({type:"alter-success",text:s.msg}),v())}).catch(s=>{})},z=t=>{const s=M.mod.name;return st(s).indexOf(t)>=0},q=async()=>{const t=await T("kucundan/globalstatus");t.code==1&&(C.value=t.data.incount,w.value=t.data.movecount)};return Q(async()=>{await v(),await q(),R.value=!0}),(t,s)=>{const p=$("ypcheckbox"),O=$("yppage"),S=$("yplayout"),V=W("tooltip");return o(),X(S,null,{header:L(n=>[nt,e("div",{class:"text-xl px-3",innerHTML:n.meta.title},null,8,at)]),list:L(()=>[e("div",ot,[e("div",lt,[e("button",{class:m(["btn",{"btn-zi":r.value==1&&!c.value}]),onClick:s[0]||(s[0]=n=>y(1))},"入库单",2),e("button",{class:m(["btn",{"btn-zi":r.value==1&&c.value==1}]),onClick:s[1]||(s[1]=n=>y(1,1))},[D("入库核验单"),C.value?(o(),l("span",{key:0,class:m(["text-hong-300 px-2 font-bold",{"text-white":r.value==1&&c.value==1}])},"("+u(C.value)+")",3)):b("",!0)],2),e("button",{class:m(["btn",{"btn-zi":r.value==3&&!c.value}]),onClick:s[2]||(s[2]=n=>y(3))},"调拔单",2),e("button",{class:m(["btn",{"btn-zi":r.value==3&&c.value==1}]),onClick:s[3]||(s[3]=n=>y(3,1))},[D("调拔核验单"),w.value?(o(),l("span",{key:0,class:m(["text-hong-300 px-2 font-bold",{"text-white":r.value==3&&c.value==1}])},"("+u(w.value)+")",3)):b("",!0)],2)]),e("div",dt,[e("div",null,[e("button",{class:"btn btn-lan",onClick:s[4]||(s[4]=n=>d("jumpCom",{to:"in"}))},"增加入库单")]),e("div",null,[e("button",{class:"btn btn-hong",onClick:s[5]||(s[5]=n=>d("jumpCom",{to:"move"}))},"增加调拔单")])])]),e("table",rt,[e("thead",ct,[e("tr",null,[e("th",it,[P(f(p,{value:"all",modelValue:g,"onUpdate:modelValue":s[6]||(s[6]=n=>g=n)},null,8,["modelValue"]),[[V,"全选",void 0,{top:!0}]])]),ut,pt,mt,bt,gt,xt,_t])]),e("tbody",null,[(o(!0),l(Y,null,Z(h,(n,G)=>(o(),l("tr",{class:"hover:bg-gray-100",key:G},[e("td",ht,[f(p,{value:n.id,modelValue:i,"onUpdate:modelValue":s[7]||(s[7]=x=>i=x)},null,8,["value","modelValue"])]),e("td",yt,u(n.id),1),e("td",vt,u(n.sn),1),e("td",kt,u(n.admin.truename||n.admin.username),1),e("td",ft,u(n.goodsCount),1),e("td",Ct,[n.enabled==0?(o(),l("span",wt,"核验中")):(o(),l("span",Vt,"己入库"))]),e("td",$t,u(n.create_time),1),e("td",Dt,[n.enabled==0?(o(),l("button",{key:0,class:"btn btn-lan mr-2",onClick:x=>A(n)},"编辑",8,Pt)):(o(),l("button",{key:1,class:"btn mr-2",onClick:x=>F(n)},"查看",8,jt)),z("enabled")&&n.enabled==0?(o(),l("button",{key:2,class:"btn btn-zi mr-2",onClick:x=>H(n)},"核验",8,zt)):b("",!0),n.enabled==0?(o(),l("button",{key:3,class:"btn btn-hong",onClick:x=>j(n.id)},"删除",8,Lt)):b("",!0)])]))),128))]),e("tfoot",null,[e("tr",null,[e("td",Tt,[P(f(p,{value:"all",modelValue:g,"onUpdate:modelValue":s[8]||(s[8]=n=>g=n)},null,8,["modelValue"]),[[V,"全选",void 0,{right:!0}]])]),e("td",Bt,[z("delete")?P((o(),l("button",{key:0,class:"btn btn-hong",onClick:s[9]||(s[9]=n=>j(0))},[D("批量删除")])),[[V,"批量删除",void 0,{bottom:!0}]]):b("",!0)])])])]),a.pageCount>1?(o(),l("div",Nt,[f(O,{onTopage:U,pageData:a},null,8,["pageData"])])):b("",!0)]),_:1})}}};export{Mt as default};
