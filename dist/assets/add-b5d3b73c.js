import{r as C,a as L,o as A,b as k,d as l,e as i,i as t,t as b,k as f,v as B,l as w,w as E,c as G,n as H,f as V,h as J,m as $,R as K,F as v,q as I,L as Q}from"./index-ffc5c309.js";const W={class:"flex my-2 items-center"},X={class:"flex items-center"},Y=t("i",{class:"ri-information-line ri-2x text-gray-500"},null,-1),Z={class:"text-xl px-2"},tt=t("div",{class:"flex-1"},null,-1),et=t("i",{class:"ri-arrow-go-back-line ri-lg pr-1"},null,-1),ot={class:"w-5/6"},M={__name:"edit",props:{mod:{type:Object},item:{type:Object}},emits:["jumpCom"],setup(a,{emit:g}){const d=a,u=g,m=C({}),s=L(0);return A(async()=>{m.id=d.item.data.id,d.mod.modcolumn.forEach(r=>{r.formitem!="none"&&(m[r.name]=d.item.data[r.name])}),s.value=1}),(r,_)=>{const c=k("ypform");return l(),i("div",null,[t("div",W,[t("div",X,[Y,t("div",Z,"编辑"+b(a.mod.alias),1)]),tt,t("button",{class:"yp-button yp-button-gray rounded",type:"button",onClick:_[0]||(_[0]=j=>u("jumpCom",{to:P}))},[et,f(" 返回 ")])]),t("div",ot,[s.value==1?(l(),B(c,{key:0,formData:m,group:a.mod.colgroup,mod:a.mod},null,8,["formData","group","mod"])):w("",!0)])])}}},zt=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"})),st={class:"flex items-center"},nt={class:"flex items-center"},lt={class:"text-xl px-2"},dt=t("div",{class:"flex-1"},null,-1),it={class:"flex space-x-2 mt-2"},at=t("button",{class:"yp-button yp-button-red yp-button-sm rounded-sm",id:"ypimport"},"导入",-1),rt={class:"flex-1"},ct={class:"absolute text-xs -top-1.5 -right-1.5 px-1 min-w-4 h-4 rounded-full bg-red-600 flex items-center justify-center"},ut={class:"flex"},mt=t("i",{class:"ri-search-line ri-lg"},null,-1),pt=[mt],yt={class:"table-auto w-full text-sm mt-3"},bt={class:"text-left"},_t=t("th",{class:"px-2 py-2 border w-10 font-thin"},null,-1),ht=t("th",{class:"px-2 py-2 border"},"ID",-1),ft={key:0,class:"px-2 py-2 border"},gt=t("th",{class:"px-2 py-2 border w-32 text-center"},"操作",-1),xt={class:"border px-2"},vt={class:"border px-2"},kt={key:0,class:"px-2 py-2 border"},$t={class:"border px-2 text-right"},Ct=["onClick"],wt=["onClick"],jt=["onClick"],Dt=["onClick"],Ot=t("td",{class:"border p-2"},null,-1),Vt=["colspan"],It={key:0,class:"space-x-2"},Lt={key:1,class:"space-x-2"},At={class:"mt-3"},Pt={__name:"list",props:{mod:{type:Object}},emits:["jumpCom"],setup(a,{emit:g}){const{proxy:d}=Q(),u=a,m=g,s=C({isremove:!1,removenum:0,list:[],curpage:0,totalPage:0,total:0,limit:0,topage:e=>{s.curpage=e,p()}});E(()=>s.isremove,(e,o)=>{p()});const r=L("");E(r,(e,o)=>{e==""&&p()});const _=()=>{r.value&&(s.curpage=0,p())},c=C([]),j=()=>{m("jumpCom",{to:N})},z=e=>{m("jumpCom",{to:M,item:e})},R=(e=0)=>{if(e==0&&(e=c),!e){d.$Alter({type:"alter-error",text:"请选择项目"});return}d.$http.get("/listInfo/delete",{modid:u.mod.id,ids:e}).then(o=>{o.code?(d.$Alter({type:"alter-success",text:o.msg}),c.length=0,p()):d.$Alter({type:"alter-error",text:o.msg})})},S=e=>{if(e==0&&(e=c),!e){d.$Alter({type:"alter-error",text:"请选择项目"});return}d.$http.get("/listInfo/restore",{modid:u.mod.id,ids:e}).then(o=>{o.code&&(d.$Alter({type:"alter-success",text:o.msg}),p())})},T=e=>{if(e==0&&(e=c),!e){d.$Alter({type:"alter-error",text:"请选择项目"});return}d.$Confirms({text:"确认删除吗？"}).then(()=>{d.$http.get("/listInfo/delete",{modid:u.mod.id,ids:e}).then(o=>{o.code&&(d.$Alter({type:"alter-success",text:o.msg}),p())})}).catch(o=>{})},F=()=>{if(c.length==0){d.$Alter({type:"alter-error",text:"请选择项目"});return}d.$Confirms({text:"确定导出吗？"}).then(()=>{d.$http.download("/listInfo/export",{modid:u.mod.id,ids:c}).then(e=>{let o=new Blob([e.data]),D=e.headers["content-disposition"],O=new RegExp("filename=([^;]+\\.[^\\.;]+);*").exec(D),x=decodeURI(O[1]),n=document.createElement("a"),h=window.URL.createObjectURL(o);n.style.display="none",n.href=h,n.download=x,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(h)})}).catch(e=>{})},p=()=>{s.list.length=0,d.$http.get("/listInfo/getList",{modid:u.mod.id,isremove:s.isremove?1:0,page:s.curpage,keyword:r.value}).then(e=>{e.code==1&&(s.removenum=e.data.removeNum,s.curpage=e.data.list.current_page,s.totalPage=e.data.list.last_page,s.limit=e.data.list.per_page,e.data.list.data.map(o=>{s.list.push(o)}))})};return A(async()=>{p()}),(e,o)=>{const D=k("ypimport"),U=k("ypcheckbox"),O=k("yppage"),x=G("tooltip");return l(),i("div",null,[t("div",st,[t("div",nt,[t("i",{class:H(["ri-2x text-gray-500",a.mod.icon])},null,2),t("div",lt,b(a.mod.alias)+"管理",1)]),dt]),t("div",it,[t("div",null,[t("button",{class:"yp-button yp-button-sm rounded-sm",onClick:j},"增加")]),t("div",null,[V(D,{url:"/admin.php/upload",ref:"uploader",mod:a.mod},{default:J(()=>[at]),_:1},8,["mod"])]),t("div",null,[t("button",{class:"yp-button yp-button-orange yp-button-sm rounded-sm",onClick:F},"导出")]),t("div",rt,[t("button",{class:"yp-button yp-button-gray yp-button-sm rounded-sm relative",onClick:o[0]||(o[0]=n=>s.isremove=!s.isremove)},[f(b(s.isremove?"返回列表":"回收站")+" ",1),t("div",ct,b(s.removenum),1)])]),t("div",ut,[$(t("input",{type:"text",class:"yp-input h-8","onUpdate:modelValue":o[1]||(o[1]=n=>r.value=n),placeholder:"请输入关键词"},null,512),[[K,r.value]]),t("button",{class:"yp-button yp-button-gray text-nowrap rounded-sm h-8 ml-1",onClick:_},pt)])]),t("table",yt,[t("thead",null,[t("tr",bt,[_t,ht,(l(!0),i(v,null,I(a.mod.modcolumn,(n,h)=>(l(),i(v,{key:h},[n.colwidth?(l(),i("th",ft,b(n.alias),1)):w("",!0)],64))),128)),gt])]),t("tbody",null,[(l(!0),i(v,null,I(s.list,(n,h)=>(l(),i("tr",{class:"hover:bg-gray-100",key:h},[t("td",xt,[V(U,{value:n.id,modelValue:c,"onUpdate:modelValue":o[2]||(o[2]=y=>c=y)},null,8,["value","modelValue"])]),t("td",vt,b(n.id),1),(l(!0),i(v,null,I(a.mod.modcolumn,(y,q)=>(l(),i(v,{key:q},[y.colwidth?(l(),i("td",kt,b(n[y.name]),1)):w("",!0)],64))),128)),t("td",$t,[s.isremove?(l(),i("button",{key:0,class:"yp-button yp-button-sm yp-button-green rounded-sm mr-2",onClick:y=>S(n.id)},"还原",8,Ct)):(l(),i("button",{key:1,class:"yp-button yp-button-sm rounded-sm mr-2",onClick:y=>z(n)},"编辑",8,wt)),s.isremove?(l(),i("button",{key:2,class:"yp-button yp-button-red yp-button-sm rounded-sm",onClick:y=>T(n.id)},"删除",8,jt)):(l(),i("button",{key:3,class:"yp-button yp-button-orange yp-button-sm rounded-sm",onClick:y=>R(n.id)},"回收站",8,Dt))])]))),128))]),t("tfoot",null,[t("tr",null,[Ot,t("td",{class:"border p-2",colspan:a.mod.modcolumn.length-1},[s.isremove?(l(),i("div",It,[$((l(),i("button",{class:"yp-button yp-button-sm yp-button-green rounded-sm",onClick:o[3]||(o[3]=n=>S(0))},[f("还原")])),[[x,"批量还原",void 0,{bottom:!0}]]),$((l(),i("button",{class:"yp-button yp-button-red yp-button-sm rounded-sm",onClick:o[4]||(o[4]=n=>T(0))},[f("删除")])),[[x,"批量删除",void 0,{bottom:!0}]])])):(l(),i("div",Lt,[$((l(),i("button",{class:"yp-button yp-button-sm yp-button-orange rounded-sm",onClick:o[5]||(o[5]=n=>R(0))},[f("回收站")])),[[x,"批量移入回收站",void 0,{bottom:!0}]])]))],8,Vt)])])]),t("div",At,[V(O,{onTopage:s.topage,curpage:s.curpage,totalPage:s.totalPage},null,8,["onTopage","curpage","totalPage"])])])}}},P=Pt,Ft=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"})),Rt={class:"flex my-2 items-center"},St={class:"flex items-center"},Tt=t("i",{class:"ri-information-line ri-2x text-gray-500"},null,-1),Ut={class:"text-xl px-2"},Et=t("div",{class:"flex-1"},null,-1),Bt=t("i",{class:"ri-arrow-go-back-line ri-lg pr-1"},null,-1),Mt={class:"w-5/6"},N={__name:"add",props:{mod:{type:Object}},emits:["jumpCom"],setup(a,{emit:g}){const d=a,u=g,m=C({}),s=L(0);return A(async()=>{d.mod.modcolumn.forEach(r=>{r.formitem!="none"&&(m[r.name]="")}),s.value=1}),(r,_)=>{const c=k("ypform");return l(),i("div",null,[t("div",Rt,[t("div",St,[Tt,t("div",Ut,"增加"+b(a.mod.alias),1)]),Et,t("button",{class:"yp-button yp-button-gray rounded",type:"button",onClick:_[0]||(_[0]=j=>u("jumpCom",{to:P}))},[Bt,f(" 返回 ")])]),t("div",Mt,[s.value==1?(l(),B(c,{key:0,formData:m,group:a.mod.colgroup,mod:a.mod},null,8,["formData","group","mod"])):w("",!0)])])}}},qt=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{qt as a,zt as e,Ft as l};
