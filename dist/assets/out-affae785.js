import{a as u,r as L,o as A,b as g,c as G,d as a,e as n,v as D,h as b,i as e,F as y,q as U,t as d,l as p,f as _,M as I,m as J,k as j,g as x,y as f,E as O}from"./index-ddd32adc.js";import P from"./index-f6c21a2b.js";import"./list-c0660b5b.js";import"./add-bc9bc560.js";const Q=e("i",{class:"ri-2x text-gray-500 ml-2 ri-money-cny-circle-fill"},null,-1),R=e("div",{class:"text-xl px-3"},"销售单",-1),W=e("div",{class:"flex-1 flex flex-row-reverse space-x-reverse space-x-2"},null,-1),X={class:"bg-white text-sm"},Y={key:0},ee=e("div",{class:"text-lg text-center"}," 选择出库仓库 ",-1),te={class:"flex items-center justify-center space-x-5 py-5"},le=["onClick"],oe={key:1,class:"space-y-3"},se={class:"flex items-center"},ae=e("div",null," 会员： ",-1),ne={key:0,class:"flex space-x-2 items-center"},ie={class:"px-2 py-1 bg-lan-300 text-white rounded-full text-xs"},de={class:"yp-table"},ce=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"序号"),e("th",null,"图片"),e("th",{class:"w-40"},"图片"),e("th",null,"条码"),e("th",null,"零售价"),e("th",null,"数量"),e("th",null,"库存"),e("th",null,"备注"),e("th",{class:"text-center"},"操作")])],-1),re={class:"text-center"},ue={class:"w-40"},pe=["src"],_e={class:"text-center"},me=["onClick"],he=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 h-5 fill-gray-600 hover:fill-red-500"},[e("path",{fill:"none",d:"M0 0h24v24H0z"}),e("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"})],-1),ve=[he],ge={class:"flex justify-center py-2 space-x-2 mt-3"},be=e("i",{class:"ri-save-line ri-lg pr-1"},null,-1),ye=e("i",{class:"ri-arrow-go-back-fill ri-lg pr-1"},null,-1),Ce={__name:"out",props:{id:{default:0},t:{default:0},page:{default:null}},emits:["jumpCom"],setup(M,{emit:$}){const w=M,B=$,F=u("选择会员"),m=u(!1),c=u(null),r=u(""),k=L([]),C=u(!1),o=L({godown_id:0,enabled:1,type:2,member_id:null,bill:[]}),V=()=>{B("jumpCom",{to:"list"})},N=async()=>{if(r.value=="")return;const t=await x("goods/details",{code:r.value,godown_id:o.godown_id});if(t.code==1){if(t.data.stock==0){f({type:"alter-error",text:"库存不足"});return}let s={goods_id:t.data.id,title:t.data.title,godown_id:o.godown_id,category_id:t.data.category_id,thumbFile:t.data.thumbFile,storeprice:t.data.storeprice.toString().replace(/,/g,""),labelprice:t.data.labelprice.toString().replace(/,/g,""),stock:t.data.stock,intro:"",status:0,sellprice:t.data.labelprice.toString().replace(/,/g,""),numbers:1,code:t.data.code};o.bill.unshift(s),r.value=""}},S=t=>{o.splice(t,1)},E=async()=>{const t=await x("godown/index");if(t.code==1)for(let s in t.data.data)k.push(t.data.data[s])},K=async()=>{if(!o.member_id){f({type:"alter-error",text:"请选择会员"});return}const t=await O("kucundan/save",o);t.code==1&&(o.bill.splice(0),c.value=null,f({type:"alter-success",text:t.msg}))},T=async t=>{const s=await x("kucundan/read",{id:t});s.code==1&&(o.id=t,o.godown_id=s.data.godown_id,o.type=s.data.type,o.bill=s.data.bill)},Z=t=>{c.value=t,o.member_id=t.id,m.value=!1};return A(async()=>{w.id?await T(w.id):await E(),C.value=!0}),(t,s)=>{const h=g("ypinput"),q=g("yplayout"),z=g("ypdialog"),H=G("viewer");return a(),n(y,null,[C.value?(a(),D(q,{key:0},{header:b(()=>[Q,R,W,e("button",{class:"btn btn-chen",onClick:V},"返回")]),list:b(()=>[e("div",X,[o.godown_id==0?(a(),n("div",Y,[ee,e("div",te,[(a(!0),n(y,null,U(k,(l,v)=>(a(),n("div",{class:"px-3 py-1.5 cursor-pointer bg-red-500 hover:bg-red-600 text-white rounded",onClick:i=>o.godown_id=l.id},d(l.title),9,le))),256))])])):p("",!0),o.godown_id?(a(),n("div",oe,[e("div",se,[ae,e("div",null,[c.value?(a(),n("div",ne,[e("div",ie,d(c.value.truename)+d(c.value.mobile),1),e("div",null,[e("i",{class:"ri-close-circle-line ri-lg hover:text-hong-300",onClick:s[0]||(s[0]=l=>c.value=null)})])])):(a(),n("button",{key:1,type:"button",class:"btn btn-lan btn-small",onClick:s[1]||(s[1]=l=>m.value=!0)},"选择会员"))])]),e("div",null,[_(h,{modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=l=>r.value=l),placeholder:"录入条码",onKeyup:I(N,["enter"]),maxlength:"15"},null,8,["modelValue"]),e("table",de,[ce,e("tbody",null,[(a(!0),n(y,null,U(o.bill,(l,v)=>(a(),n("tr",null,[e("td",re,d(v+1),1),e("td",ue,[J(e("img",{src:l.thumbFile,class:"w-28 h-28 object-cover"},null,8,pe),[[H]])]),e("td",null,d(l.title),1),e("td",null,d(l.code),1),e("td",null,[_(h,{modelValue:l.sellprice,"onUpdate:modelValue":i=>l.sellprice=i,placeholder:"请输入零售价",min:l.storeprice,max:l.labelprice},null,8,["modelValue","onUpdate:modelValue","min","max"])]),e("td",null,[_(h,{type:"number",modelValue:l.numbers,"onUpdate:modelValue":i=>l.numbers=i,placeholder:"请输入数量",max:l.stock,maxlength:"9"},null,8,["modelValue","onUpdate:modelValue","max"])]),e("td",_e,d(l.stock),1),e("td",null,[_(h,{modelValue:l.intro,"onUpdate:modelValue":i=>l.intro=i,placeholder:"请输入备注",maxlength:"30"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[e("div",{class:"flex items-center justify-center",onClick:i=>S(v)},ve,8,me)])]))),256))])])])])):p("",!0),e("div",ge,[o.bill.length?(a(),n("button",{key:0,class:"btn btn-hong",type:"button",onClick:K},[be,j(" 提交 ")])):p("",!0),e("button",{class:"btn",type:"button",onClick:V},[ye,j(" 返回 ")])])])]),_:1})):p("",!0),m.value?(a(),D(z,{key:1,title:F.value,mask:1,onClose:s[3]||(s[3]=l=>m.value=!1)},{default:b(()=>[_(P,{onChooseMember:Z})]),_:1},8,["title"])):p("",!0)],64)}}};export{Ce as default};
