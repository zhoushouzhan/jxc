import{L as r,o as d,d as u,e as c,a3 as m,y as n}from"./index-ddd32adc.js";import{p as f}from"./plupload.full.min-99e67f14.js";const y=["id"],b={__name:"ypimport",props:{url:{default:""},factory_id:{default:0}},setup(i){const o=i,e=new f.Uploader({multi_selection:!1,headers:{Authorization:r.state.User.token,"x-requested-with":"XMLHttpRequest"},multipart_params:{factory_id:o.factory_id}}),p=()=>{e.setOption("url","/"+o.url),e.setOption("browse_button","ypimport"+o.factory_id),e.setOption("filters",{mime_types:[{title:"Files",extensions:"xlsx"}],max_file_size:r.state.Sys.sysinfo.uploadsize+"mb",prevent_duplicates:!0}),e.init(),e.bind("FileUploaded",async(t,s,l)=>{let a=JSON.parse(l.response);a.code==0&&n({type:"alter-error",text:a.msg}),setTimeout(()=>{window.location.reload()},3e3)}),e.bind("FilesAdded",(t,s)=>{r.state.isLoading=!0,t.start()}),e.bind("Error",async(t,s)=>{await n({type:"alter-error",text:s.message})})};return d(()=>{p()}),(t,s)=>(u(),c("div",{id:"ypimport"+i.factory_id,class:"bg-pink-400 py-1.5 rounded px-2 text-white cursor-pointer hover:bg-pink-500"},[m(t.$slots,"default")],8,y))}};export{b as default};
