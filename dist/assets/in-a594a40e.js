import{a as w,r as m,w as I,g as u,o as K,b as f,d as n,v as Z,h as x,i as t,e as d,F as k,q as L,t as p,l as r,f as y,N as $,k as q,E as z,y as H}from"./index-0f467f6d.js";const J=t("i",{class:"ri-2x text-gray-500 ml-2 ri-indent-increase"},null,-1),O=t("div",{class:"text-xl px-3"},"入库单",-1),T=t("div",{class:"flex-1 flex flex-row-reverse space-x-reverse space-x-2"},null,-1),A={class:"bg-white text-sm"},G={key:0},P=t("div",{class:"text-lg text-center"}," 选择入库仓库 ",-1),Q={class:"flex items-center justify-center space-x-5 py-5"},R=["onClick"],W={key:1},X={key:2},Y={class:"yp-table"},tt=t("thead",null,[t("tr",null,[t("th",{class:"text-center"},"序号"),t("th",{class:"w-40"},"图片"),t("th",null,"名称/条码"),t("th",null,"数量"),t("th",null,"备注"),t("th",{class:"text-center"},"操作")])],-1),et={class:"text-center"},st={class:"w-40"},ot=["src"],at={class:"text-red-600 font-bold"},lt=["onClick"],nt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 h-5 fill-gray-600 hover:fill-red-500"},[t("path",{fill:"none",d:"M0 0h24v24H0z"}),t("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"})],-1),dt=[nt],it={class:"flex justify-center py-2 space-x-2 mt-3"},ct=t("i",{class:"ri-save-line ri-lg pr-1"},null,-1),ut={__name:"in",props:{id:{default:0},t:{default:0}},emits:["jumpCom"],setup(C,{emit:V}){const _=C,F=V,i=w(""),b=m([]),v=w(!1),o=m({godown_id:0,enabled:0,type:1,bill:[]}),j=m(JSON.parse(sessionStorage.getItem("ingodownList"))||[]),N=()=>{F("jumpCom",{to:"list"})};I(()=>o.godown_id,async e=>{await M(e)});const B=async()=>{if(i.value=="")return;const e=await u("goods/details",{code:i.value});if(e.code==1){let s={goods_id:e.data.id,title:e.data.title,godown_id:o.godown_id,category_id:e.data.category.id,thumbFile:e.data.thumbFile,storeprice:e.data.storeprice,intro:"",status:0,inprice:0,numbers:0,code:e.data.code};o.bill.unshift(s),i.value=""}},U=e=>{o.bill.splice(e,1)},D=async()=>{const e=await u("/godown/index");if(e.code==1)for(let s in e.data.data)b.push(e.data.data[s])},M=async e=>{if(_.id)return;const s=await u("goods/getall",{ids:j});if(s.code==1)for(let a=0;a<s.data.length;a++){let h={goods_id:s.data[a].id,title:s.data[a].title,godown_id:e,category_id:s.data[a].category.id,thumbFile:s.data[a].thumbFile,storeprice:s.data[a].storeprice,intro:"",status:0,inprice:0,numbers:1,code:s.data[a].code};o.bill.push(h)}},S=async()=>{const e=await z("kucundan/save",o);e.code==1&&(o.bill.splice(0),H({type:"alter-success",text:e.msg}),sessionStorage.removeItem("ingodownList"))},E=async e=>{const s=await u("kucundan/read",{id:e});s.code==1&&(o.id=e,o.godown_id=s.data.godown_id,o.type=s.data.type,o.bill=s.data.bill)};return K(async()=>{_.id?await E(_.id):await D(),v.value=!0}),(e,s)=>{const a=f("ypinput"),h=f("yplayout");return v.value?(n(),Z(h,{key:0},{header:x(()=>[J,O,T,t("button",{class:"yp-button yp-button-sm yp-button-orange rounded-sm",onClick:N},"返回")]),list:x(()=>[t("div",A,[o.godown_id==0?(n(),d("div",G,[P,t("div",Q,[(n(!0),d(k,null,L(b,(l,g)=>(n(),d("div",{class:"px-3 py-1.5 cursor-pointer bg-blue-500 hover:bg-blue-600 text-white rounded",onClick:c=>o.godown_id=l.id},p(l.title),9,R))),256))])])):r("",!0),o.godown_id?(n(),d("div",W,[y(a,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=l=>i.value=l),disabled:"",placeholder:"录入条码",onKeyup:$(B,["enter"])},null,8,["modelValue"])])):r("",!0),o.bill.length?(n(),d("div",X,[t("table",Y,[tt,t("tbody",null,[(n(!0),d(k,null,L(o.bill,(l,g)=>(n(),d("tr",null,[t("td",et,p(g+1),1),t("td",st,[t("img",{src:l.thumbFile,class:"object-cover"},null,8,ot)]),t("td",null,[t("div",null,p(l.title),1),t("div",at,p(l.code),1)]),t("td",null,[y(a,{modelValue:l.numbers,"onUpdate:modelValue":c=>l.numbers=c,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),t("td",null,[y(a,{modelValue:l.intro,"onUpdate:modelValue":c=>l.intro=c,placeholder:"请输入备注"},null,8,["modelValue","onUpdate:modelValue"])]),t("td",null,[t("div",{class:"flex items-center justify-center",onClick:c=>U(g)},dt,8,lt)])]))),256))])])])):r("",!0),t("div",it,[o.bill.length?(n(),d("button",{key:0,class:"yp-button rounded",type:"button",onClick:S},[ct,q(" 申请入库 ")])):r("",!0)])])]),_:1})):r("",!0)}}};export{ut as default};
